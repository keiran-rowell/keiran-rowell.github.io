<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="3.10.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" hreflang="en" /><updated>2026-01-14T08:49:33+11:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Keiran Rowell</title><subtitle>Personal website of Keiran Rowell - Computational chemist, educator, and scientific computing specialist sharing research, teaching materials, and insights on computational chemistry. Obsessive explorations into the oddities of chemistry, music, history, and scientific computing... on occasion.
</subtitle><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><entry><title type="html">Hartreeâ€“Fock in Rust, Julia, and Python</title><link href="http://localhost:4000/code/2026-12-12-HF-in-rust-julia-python/" rel="alternate" type="text/html" title="Hartreeâ€“Fock in Rust, Julia, and Python" /><published>2026-12-12T00:00:00+11:00</published><updated>2026-12-12T00:00:00+11:00</updated><id>http://localhost:4000/code/HF-in-rust-julia-python</id><content type="html" xml:base="http://localhost:4000/code/2026-12-12-HF-in-rust-julia-python/"><![CDATA[<blockquote>
  <p>ğŸ§ª <strong>Try it yourself</strong>: <a href="/interactive/2026-12-12-HF-interactive/">Interactive demos availableâ†’</a></p>

  <p>Run the H<sub>2</sub> Hartree-Fock calculations from this post directly in your browser.</p>
</blockquote>

<hr />

<p><a href="https://youtu.be/tas0O586t80?si=H2HnFcVoS4tNqKB0">Program in C</a> they said. Itâ€™s good for you they said. <a href="https://youtu.be/hE7l6Adoiiw?si=Ourgha7DTfRy_Cer">And it is!</a>
That is until you step outside the bounds of an array. Or dereference the wrong pointer to an array of pointers. Or, heaven forbid in this chatty age, want to do text processing.
C is <em>fast</em>, it allocates memory like machine code. But itâ€™s not the only game in town, and <a href="https://www.i-programmer.info/news/98-languages/15506-rust-fast-and-safe.html">not always the fastest</a>. 
C++ gives you a lot of powerful language features. But I donâ€™t write in it, I never took enterprise software engineering and I like to keep digital shotguns well away from my feet.</p>

<blockquote>
  <p>â€œC makes it easy to shoot yourself in the foot; C++ makes it harder, but when you do it blows your whole leg offâ€.</p>
</blockquote>

<p>â€” <a href="https://www.stroustrup.com/quotes.html">Bjarne Stroustrup</a>, developer of the C++ programming language</p>

<p>So letâ€™s reimplement the fundamental orbital energy optimiser, the basis for all <a href="/guide/2023-04-12-compchem-methods-basics/">electronic structure theory methods</a>: Hartreeâ€“Fock.  <span style="color:#A9A9A9">(With deep debt to <a href="https://quaccs.wordpress.com/">QUACCS</a>)</span></p>

<p>In with the new <span style="color:#A9A9A9">(apologies Formula Translation maintainence work)</span>; so for pedagogical/andragogical reasons, and to learn a couple of new languages, letâ€™s write the same algo in three languages:</p>

<ul>
  <li>ğŸ <code class="language-plaintext highlighter-rouge">Python</code>: Itâ€™s Python! Itâ€™s everywhere. Itâ€™s <em>readable</em>. Itâ€™s not so bad as you would think because core Numerical Python is implemented in highly optimised C anyway.</li>
  <li>ğŸ”´ğŸŸ¢ğŸŸ£ <code class="language-plaintext highlighter-rouge">Julia</code>: â€œ<a href="https://discourse.julialang.org/t/elevator-pitch/29457/8"><em>as flexible as Python, as numerical as Matlab, as fast as Fortran, and as deep as Lisp.</em></a>â€. Designed <em>for</em> scientific computing. Well, whatâ€™s not to like? Itâ€™s REPL prompt is super nice, itâ€™s package manager doesnâ€™t make me prematurely age like Python does in my day job. And Just-In-Time compilation is <em>incredibly smart</em>. <span style="color:#A9A9A9">(I secretly think this is why observables are indeterminate until measured, but today weâ€™re strictly <a href="https://hsm.stackexchange.com/questions/3615/who-was-the-first-to-say-shut-up-and-calculate">â€œShut up and calculateâ€</a>)</span></li>
  <li>ğŸ¦€ <code class="language-plaintext highlighter-rouge">Rust</code>: Itâ€™s all the rage, faster than C, and very nicely gives you a talking to when it can see mistakes in the future. However, itâ€™s designed for deep systems programming. Quite likely overkill, but might give performance advantages and can be hosted on a site with WebAssembly.</li>
</ul>

<p>With <a href="https://rust-lang.org/what/wasm/">WebAssembly</a> and <a href="https://plutojl.org/">Pluto notebooks</a> we can do quantum chemistry in our browser. Letâ€™s gooooâ€”</p>

<hr />

<p>The Hartreeâ€“Fock algorithm is the computational kernel for more accurate <a href="/guide/2023-04-12-compchem-methods-basics/">electronic structure wavefunction methods</a>, where electron behaviour is improved by addition of either â€˜dynamicâ€™ electron correlation (mutual repulsion during motion) and â€˜staticâ€™ correlation (fun stuff where a single arrangement of reference electron orbitals are insufficient). First we need to get a reasonable set of combined atomic orbitals for the resting state of a molecule. Iâ€™m using â€œpre-bakedâ€ basis-sets as really I want to focus on the algorithm (Roothaanâ€“Hall eigenvalue finding) and coding it up.</p>

<p>So, weâ€™re starting with a set of atomic orbitals (\(\chi_{n}\)) (here, the minimal viable ones, the basis-set). We combine them to get some set of molecular orbitals (\(\phi_{i} = \sum\limits_{n}C_{ni}\chi_{n}\)) (MOs).</p>

<p>If we take these electrons and capture their properties as spinâ€“\(\frac{1}{2}\) particlesâ€”kinetic energy, attraction to nuclei, electronâ€“electron repulsions, change of sign upon indistinguishable particle exchange (Fermi stats)â€” we get the Fock operator \(\hat{F}\) to work with. Really, the Fock operator is related to the overlap of orbital basis set vectors (\({S}\)), and we can use an algorithm to optimise the co-efficients (\({C}\)) of these orbitals to lower the orbital energies (\(\epsilon\))</p>

<p>So we have the Roothanâ€“Hall matrix optimisation problem of finding the co-efficients that lowers the molecular orbital energies, which is guaranteed to be the closest to ground-state reality for HF (the Variational Principle).</p>

\[\mathbf{FC} =  \mathbf{SC}\epsilon\]

<p>Right, enough notation. Letâ€™s set up an engine that finds the energy eigenvalues (\(\epsilon\)) given some input orbitals, and then uses and optimisation algorithm to feed the output co-efficients back in to iteratively refind until converge. Yielding a set of one-electron orbitals solved in â€œself-consistent fieldâ€ with respect to the other electrons. Time to code.</p>

<blockquote>
  <p>Code snippets will be as quotes. Blocks will be syntax highlighted. Some things will be interactive through web magic. Those are in a later <a href="">post</a></p>
</blockquote>

<p>Weâ€™re going to do a toy version of restricted Hartreeâ€“Fock for understanding purposes.</p>

<p>Basically saying <code class="language-plaintext highlighter-rouge">Hello World!</code> to H<sub>2</sub>.</p>

<hr />

<h1 id="basis-sets">Basis Sets</h1>

<hr />
<h2 id="python-">Python ğŸ</h2>

<p>Using <a href="https://github.com/bennybp">@bennyp</a> and <a href="https://github.com/susilehtola">@susilehtola</a>â€™s <a href="https://molssi-bse.github.io/basis_set_exchange/usage.html#"><code class="language-plaintext highlighter-rouge">basis_set_exchange</code></a> library provied for MolSSI (the Molecular Sciences Software Institute).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pip</span> <span class="n">install</span> <span class="n">basis_set_exchange</span>

<span class="kn">import</span> <span class="nn">basis_set_exchange</span>
<span class="n">sto3g_orca_fmt</span> <span class="o">=</span>  <span class="n">basis_set_exchange</span><span class="p">.</span><span class="n">get_basis</span><span class="p">(</span><span class="s">'STO-3G'</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">'ORCA'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sto3g_orca_fmt</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$DATA

HYDROGEN
S   3
1         0.3425250914E+01       0.1543289673E+00
2         0.6239137298E+00       0.5353281423E+00
3         0.1688554040E+00       0.4446345422E+00
</code></pre></div></div>
<p>Looking good!</p>

<hr />

<h2 id="julia-">Julia ğŸ”´ğŸŸ¢ğŸŸ£</h2>

<p>Using <a href="https://github.com/Leticia-maria">@Leticia-maria</a>â€™s <a href="https://github.com/HartreeFoca/BasisSets.jl">BasisSets.jl</a> Basis Set Exchange parser.</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">Pkg</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="x">(</span><span class="s">"BasisSets"</span><span class="x">)</span>
<span class="k">using</span> <span class="n">BasisSets</span>
</code></pre></div></div>

<p>Create a <code class="language-plaintext highlighter-rouge">H2.xyz</code> with 0.74 Ã… / 1.4 Bohr seperation on the Z-axis.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2

H 0.000000 0.000000 0.000000
H 0.000000 0.000000 1.400000
</code></pre></div></div>

<p>Check a minimal H<sub>2</sub> minimal basis set.</p>

<p><span style="color:#A9A9A9">The README omits the intermediate molecule() function you can find by running names(BasisSets)</span></p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h2_mol</span> <span class="o">=</span> <span class="n">molecule</span><span class="x">(</span><span class="s">"./H2.xyz"</span><span class="x">)</span>
<span class="n">h2_sto3g</span> <span class="o">=</span> <span class="n">parsebasis</span><span class="x">(</span><span class="n">h2_mol</span><span class="x">,</span> <span class="s">"STO-3g"</span><span class="x">)</span>
</code></pre></div></div>

<p>Inspect with <code class="language-plaintext highlighter-rouge">dump(h2_sto3g)</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Array{BasisSets.GaussianBasisSet}((2,))
  1: BasisSets.GaussianBasisSet
    R: Array{Float64}((1, 3)) [0.0 0.0 0.0]
    Î±: Array{Float64}((1, 3)) [3.42525091 0.62391373 0.1688554]
    d: Array{Float64}((1, 3)) [0.15432897 0.53532814 0.44463454]
    N: Array{Float64}((1, 3)) [1.794441832218435 0.5003264923314032 0.18773545851092535]
    size: Int64 3
    â„“: Int64 0
    m: Int64 0
    n: Int64 0
  2: BasisSets.GaussianBasisSet
    R: Array{Float64}((1, 3)) [0.0 0.0 1.4]
    Î±: Array{Float64}((1, 3)) [3.42525091 0.62391373 0.1688554]
    d: Array{Float64}((1, 3)) [0.15432897 0.53532814 0.44463454]
    N: Array{Float64}((1, 3)) [1.794441832218435 0.5003264923314032 0.18773545851092535]
    size: Int64 3
    â„“: Int64 0
    m: Int64 0
    n: Int64 0
</code></pre></div></div>
<p>With symbols, neat!</p>

<hr />

<h2 id="rust-">Rust ğŸ¦€</h2>

<p>Right, I wore my trousers rolled and scuttled through the conceptual waves of <a href="https://rustlings.rust-lang.org/">Rustlings</a>. Time to put skimming into practice and build something with the borrow checker reminding me of any memory allocation or variable error.</p>

<p>Yoinking <a href="https://github.com/iggedi-ig-ig">@iggedi-ig-ig</a>â€™s <a href="https://github.com/iggedi-ig-ig/fock-rs/tree/master/basis_set">basis set parser</a> since I want to leverage the <a href="https://www.basissetexchange.org/">Basis Set Exchange</a>.</p>

<p>Start project with <code class="language-plaintext highlighter-rouge">cargo new h2_hf_rust</code></p>

<p>Download the <code class="language-plaintext highlighter-rouge">STO-3G</code> basis set file and save it within the project.</p>

<p><code class="language-plaintext highlighter-rouge">wget -O sto-3g-h.json "https://www.basissetexchange.org/api/basis/sto-3g/format/json/?version=1&amp;elements=1"</code></p>

<p>Add the basis set package to the <code class="language-plaintext highlighter-rouge">Cargo.toml</code> dependency listing, and the json parsing library</p>
<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[dependencies]</span>
<span class="nn">basis_set</span> <span class="o">=</span> <span class="p">{</span> <span class="py">git</span> <span class="p">=</span> <span class="s">"https://github.com/iggedi-ig-ig/fock-rs"</span><span class="p">,</span> <span class="py">package</span> <span class="p">=</span> <span class="s">"basis_set"</span> <span class="p">}</span>
<span class="py">serde_json</span> <span class="p">=</span> <span class="s">"1.0"</span>
</code></pre></div></div>

<p>Test out BasisSet library function in <code class="language-plaintext highlighter-rouge">src/main.rs</code></p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">use</span> <span class="nn">basis_set</span><span class="p">::</span><span class="n">BasisSet</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">json</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="s">"sto-3g-h.json"</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
    <span class="k">let</span> <span class="n">basis</span><span class="p">:</span> <span class="n">BasisSet</span> <span class="o">=</span> <span class="nn">serde_json</span><span class="p">::</span><span class="nf">from_str</span><span class="p">(</span><span class="o">&amp;</span><span class="n">json</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>

    <span class="nd">println!</span><span class="p">(</span><span class="s">"Loaded basis set: {} ({})"</span><span class="p">,</span> <span class="n">basis</span><span class="py">.name</span><span class="p">,</span> <span class="n">basis</span><span class="py">.description</span><span class="p">);</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Full details:</span><span class="se">\n</span><span class="s">{:#?}"</span><span class="p">,</span> <span class="n">basis</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div>

<p>And now run the project with <code class="language-plaintext highlighter-rouge">cargo run</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Full basis set details:
BasisSet {
...
                    exponents: [
                        "0.3425250914E+01",
                        "0.6239137298E+00",
                        "0.1688554040E+00",
                    ],
                    coefficients: [
                        [
                            "0.1543289673E+00",
                            "0.5353281423E+00",
                            "0.4446345422E+00",
...
    family: SlaterType,
    description: "STO-3G Minimal Basis (3 functions/AO)",
    role: "orbital",
    name: "STO-3G",
}
</code></pre></div></div>
<p>We have hydrogenâ€™s STO-3G basis!</p>

<hr />

<h1 id="hartreefock">Hartreeâ€“Fock</h1>

<hr />

<h2 id="the-overlap-integral-s">The overlap integral (S)</h2>

<p>So the core of part the algorithm is computing the <strong>overlap matrix</strong> \(\mathbf{S}\) between two basis functions in space.</p>

\[S_{ij} = \langle \chi_i | \chi_j \rangle = \int \chi_i^*(\mathbf{r}) \chi_j(\mathbf{r}) \, d\mathbf{r}\]

<p>Weâ€™ll write a function that computes the overlap of two basis functions, working on the primitives with their exponents (Î±, Î²).</p>

<p>ğŸ
<code class="language-plaintext highlighter-rouge">def compute_S_primitive(alpha, beta, R_A, R_B)</code></p>

<p>ğŸ”´ğŸŸ¢ğŸŸ£
<code class="language-plaintext highlighter-rouge">function compute_S_primitive(Î±::Float64, Î²::Float64, R_A::Vector{Float64}, R_B::Vector{Float64})</code></p>

<p>ğŸ¦€
<code class="language-plaintext highlighter-rouge">let S = overlap_integral(&amp;basis1, &amp;basis2);</code></p>

<p>We have two hydrogen atoms with a minimal basis, so we should get a 2x2 matrix to inspect.</p>

\[\mathbf{S} = \begin{bmatrix}
\langle \chi_1 | \chi_1 \rangle &amp; \langle \chi_1 | \chi_2 \rangle \\
\langle \chi_2 | \chi_1 \rangle &amp; \langle \chi_2 | \chi_2 \rangle
\end{bmatrix}\]

<p>A basis function completely overlaps with itself, so we get one on the diagonals, and the overlap values (\(S_{ij}\)) on the off-diagonals depend on your basis set and molecular geometry.</p>

\[\mathbf{S} = \begin{bmatrix}
1 &amp; S_{12} \\
S_{21} &amp; 1
\end{bmatrix}\]

<p>The self-consistent field cycles will optimise the co-efficients for how your orbitals combine within this overlap.</p>

<p>With two s-orbital Gaussian <em>primitives</em> the overlap integral is:</p>

\[S = \left(\frac{\pi}{\alpha + \beta}\right)^{3/2} \exp\left(-\frac{\alpha\beta}{\alpha+\beta}|\mathbf{R}_A - \mathbf{R}_B|^2\right)\]

<p>ğŸ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">S_prim</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">/</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">((</span><span class="n">R_A</span> <span class="o">-</span> <span class="n">R_B</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></div>
<p>ğŸ”´ğŸŸ¢ğŸŸ£ <span style="color:#A9A9A9">(the <code class="language-plaintext highlighter-rouge">.</code> operator means apply to each <em>element</em> in an array independently)</span></p>
<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">S_prim</span> <span class="o">=</span> <span class="x">(</span><span class="nb">Ï€</span> <span class="o">/</span> <span class="x">(</span><span class="n">Î±</span> <span class="o">+</span> <span class="n">Î²</span><span class="x">))</span><span class="o">^</span><span class="x">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="x">)</span> <span class="o">*</span> <span class="n">exp</span><span class="x">(</span><span class="o">-</span><span class="x">(</span><span class="n">Î±</span> <span class="o">*</span> <span class="n">Î²</span> <span class="o">/</span> <span class="x">(</span><span class="n">Î±</span> <span class="o">+</span> <span class="n">Î²</span><span class="x">))</span> <span class="o">*</span> <span class="n">sum</span><span class="x">((</span><span class="n">R_A</span> <span class="o">.-</span> <span class="n">R_B</span><span class="x">)</span><span class="o">.^</span><span class="mi">2</span><span class="x">))</span>
</code></pre></div></div>
<p>ğŸ¦€</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">dist_sq</span><span class="p">:</span> <span class="nb">f64</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">3</span><span class="p">)</span> <span class="c1">//summing over X,Y,Z indices</span>
    <span class="nf">.map</span><span class="p">(|</span><span class="n">i</span><span class="p">|</span> <span class="p">(</span><span class="n">r_a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="nf">.powi</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="nf">.sum</span><span class="p">();</span>
<span class="k">let</span> <span class="n">S_prim</span> <span class="o">=</span> <span class="p">(</span><span class="nn">std</span><span class="p">::</span><span class="nn">f64</span><span class="p">::</span><span class="nn">consts</span><span class="p">::</span><span class="n">PI</span> <span class="o">/</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span><span class="p">))</span><span class="nf">.powf</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span> 
    <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">/</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">dist_sq</span><span class="p">)</span><span class="nf">.exp</span><span class="p">();</span>
</code></pre></div></div>

<p>The actual <code class="language-plaintext highlighter-rouge">overlap_integral</code> function when working with a real contracted basis set will involved summing the primitives in the basis set, weighted by contraction co-efficients and normalised.</p>

<hr />

<h2 id="operator-matrices-setup">Operator matrices setup</h2>

<h3 id="denisty-matrix-d">Denisty matrix (D)</h3>
<p>To kickstart our engine we need an intial electron density matrix (\(\mathbf{D}\)). For a toy system itâ€™s actually okay to start with zero density everywhere (or the identity matrix).</p>

<p>Though for any real molecular system choice of a good guess is important for convergence. For difficult to converge cases, feeding in the results of a simpler model chemistry will help start need a convergent minimum.</p>

<p>ğŸ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_basis</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">))</span>
</code></pre></div></div>
<p>ğŸ”´ğŸŸ¢ğŸŸ£</p>
<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">D</span> <span class="o">=</span> <span class="n">zeros</span><span class="x">(</span><span class="n">n_basis</span><span class="x">,</span> <span class="n">n_basis</span><span class="x">)</span>
</code></pre></div></div>
<p>ğŸ¦€</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">TODO</span><span class="p">:</span> <span class="n">UPDATE</span>
<span class="k">let</span> <span class="k">mut</span> <span class="n">d</span> <span class="o">=</span> <span class="nn">Array2</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">f64</span><span class="o">&gt;</span><span class="p">::</span><span class="nf">zeros</span><span class="p">((</span><span class="n">n_basis</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">));</span>
</code></pre></div></div>

<h3 id="fock-operator-f">Fock operator (F)</h3>

<p>For teaching purposes weâ€™re going to skip the electron-electron repulsion integrals (ERIs) that are the bulk of the computational cost and code complexity.
In this way our <em>toy</em> Fock matrix (\(\mathbf{F}\)) is just the core Hamiltonian (\(\mathbf{F}\)â€” the total energy of forces acting on our one-electron core). This is really just our electronsâ€™ kinetic energies (\(\mathbf{T}\)) and their attractive potential energy to the nuceli (\(\mathbf{V}^{\text{nuc}}\))</p>

\[\mathbf{F} = \mathbf{H}^{\text{core}} = \mathbf{T} + \mathbf{V}^{\text{nuc}}\]

<h3 id="kinetic-energy-operator-t">Kinetic energy operator (T)</h3>

<p>The electron kinetic energy is the momentum taken in all directions (\(\nabla\)):
\(\hat{T} = -\frac{1}{2}\nabla^2\)</p>

<p>When evaluating between two basis functions:
\(T_{\mu\nu} = \left\langle \chi_\mu \left| -\frac{1}{2}\nabla^2 \right| \chi_\nu \right\rangle\)</p>

<p>Taking the result from Szabo &amp; Ostlund <em>â€œModern Quantum Chemistryâ€</em> Appendix A as Iâ€™m not a physicist. Note the relationship to \(S\):</p>

\[T = \alpha\beta\left[\frac{3}{\alpha+\beta} - \frac{2(\alpha\beta)}{(\alpha+\beta)^2}|\mathbf{R}_A - \mathbf{R}_B|^2\right] S\]

<p>ğŸ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">reduced_exp</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">/</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">T_prim</span> <span class="o">=</span> <span class="n">reduced_exp</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">reduced_exp</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">((</span><span class="n">R_A</span> <span class="o">-</span> <span class="n">R_B</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">S_prim</span>
</code></pre></div></div>
<p>ğŸ”´ğŸŸ¢ğŸŸ£</p>
<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">reduced_exp</span> <span class="o">=</span> <span class="n">Î±</span> <span class="o">*</span> <span class="n">Î²</span> <span class="o">/</span> <span class="x">(</span><span class="n">Î±</span> <span class="o">+</span> <span class="n">Î²</span><span class="x">)</span>
<span class="n">T_prim</span> <span class="o">=</span> <span class="n">reduced_exp</span> <span class="o">*</span> <span class="x">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">reduced_exp</span> <span class="o">*</span> <span class="n">sum</span><span class="x">((</span><span class="n">R_A</span> <span class="o">.-</span> <span class="n">R_B</span><span class="x">)</span><span class="o">.^</span><span class="mi">2</span><span class="x">))</span> <span class="o">*</span> <span class="n">S_prim</span>
</code></pre></div></div>
<p>ğŸ¦€</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let reduced_exp = alpha * beta / (alpha + beta);
let T_prim = reduced_exp * (3.0 - 2.0 * reduced_exp * dist_sq) * S_prim;
</code></pre></div></div>

<h3 id="nuclear-attraction-potential-v">Nuclear attraction potential (V)</h3>
<p>We invoke the Born-Oppenheimer approximation that electron motion occurs on much faster timescale than nuclear re-arrangement (can also think of this in terms of different decoupled energy scales). So the nuclei are effectively <em>fixed</em> in place.</p>

\[\hat{V}^{\text{nuc}}_A = -\frac{Z_A}{|\mathbf{r} - \mathbf{R}_A|}\]

\[V^{\text{nuc}}_{\mu\nu} = -\left\langle \chi_\mu \left| \frac{1}{|\mathbf{r} - \mathbf{R}_1|} \right| \chi_\nu \right\rangle - \left\langle \chi_\mu \left| \frac{1}{|\mathbf{r} - \mathbf{R}_2|} \right| \chi_\nu \right\rangle\]

<p>The nuclear attraction integrals involve special functions that are beyond our scope here. Theyâ€™re implement in <code class="language-plaintext highlighter-rouge">integrals.[py/jl/rs]</code> since 1/R wasnâ€™t showing good behaviour even for a toy system. Iâ€™m just going to mention the function header for this guide, those curious can refer to the code generated from a reference.</p>

<p>ğŸ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">compute_V_nuc_primitive</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">R_A</span><span class="p">,</span> <span class="n">R_B</span><span class="p">,</span> <span class="n">R_nuc</span><span class="p">):</span>
</code></pre></div></div>
<p>ğŸ”´ğŸŸ¢ğŸŸ£</p>
<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="nf"> compute_V_nuc_primitive</span><span class="x">(</span><span class="n">Î±</span><span class="o">::</span><span class="kt">Float64</span><span class="x">,</span> <span class="n">Î²</span><span class="o">::</span><span class="kt">Float64</span><span class="x">,</span> <span class="n">R_A</span><span class="o">::</span><span class="kt">Vector</span><span class="x">{</span><span class="kt">Float64</span><span class="x">},</span> <span class="n">R_B</span><span class="o">::</span><span class="kt">Vector</span><span class="x">{</span><span class="kt">Float64</span><span class="x">},</span> <span class="n">R_nuc</span><span class="o">::</span><span class="kt">Vector</span><span class="x">{</span><span class="kt">Float64</span><span class="x">})</span> 
</code></pre></div></div>
<p>ğŸ¦€</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TBD
</code></pre></div></div>

<h3 id="electron-repulsion-integrals-eris">Electron Repulsion Integrals (ERIs)</h3>

<p>The most demanding part of the Hartreeâ€“Fock calculation, both computational and mathematically. Iâ€™ve farmed them out to <code class="language-plaintext highlighter-rouge">integrals.py</code> to not break the logic flow of SCF. This is where Iâ€™ve put the overlap and kinetic energy integrals as well.</p>

<p>The electron-electron repulsion matrix (\(\mathbf{G}\)) captures both the Coloumbic repulsions between negative charges (\(\mathbf{J}\)) and the quantum effect of change of wavefunction sign upon exchange of two particles (\(\mathbf{K}\))</p>

\[\mathbf{G}[\mathbf{D}] = \mathbf{J}[\mathbf{D}] - \mathbf{K}[\mathbf{D}]\]

<p>Refer to <code class="language-plaintext highlighter-rouge">integrals.[py/jl/rs]</code>, which Iâ€™ve just generated from a reference, if you want more details.</p>

<p>ğŸ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">G</span> <span class="o">=</span> <span class="n">build_G_matrix</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">ERIs</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">T</span> <span class="o">+</span> <span class="n">V_nuc</span> <span class="o">+</span> <span class="n">G</span>
</code></pre></div></div>
<p>ğŸ”´ğŸŸ¢ğŸŸ£</p>
<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">G</span> <span class="o">=</span> <span class="n">build_G_matrix</span><span class="x">(</span><span class="n">D</span><span class="x">,</span> <span class="n">ERIs</span><span class="x">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">T</span> <span class="o">+</span> <span class="n">V_nuc</span> <span class="o">+</span> <span class="n">G</span>
</code></pre></div></div>
<h2 id="the-self-consistent-field-scf-loop">The self-consistent field (SCF) loop</h2>

<p>Recall this is an iterative eigenvalue finding problem
\(\mathbf{FC} = \epsilon\mathbf{SC}\)</p>

<p>To that that we need to do some orthogonalisation
\(\mathbf{X} = \mathbf{S}^{-\frac{1}{2}}\)</p>

<p>Use the transpose of the orthogonalisation matrix (\(\mathbf{X}^{T}\)) to transform the Fock operator into the new basis
\(\mathbf{F}' = \mathbf{X}^{T}\mathbf{F}\mathbf{X}\)</p>

<p>Solve for the eignevalues of the co-efficient matrix
\(\mathbf{F}'\mathbf{C}' = \mathbf{C}'\epsilon\)</p>

<p>Update the new co-efficient matrix into original basis
\(\mathbf{C} = \mathbf{X}\mathbf{C}'\)</p>

<p>ğŸ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s_eigvals</span><span class="p">,</span> <span class="n">s_eigvecs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">s_eigvecs</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s_eigvals</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span> <span class="o">@</span> <span class="n">s_eigvecs</span><span class="p">.</span><span class="n">T</span>

<span class="n">F_prime</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">F</span> <span class="o">@</span> <span class="n">X</span>

<span class="n">epsilon</span><span class="p">,</span> <span class="n">C_prime</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">F_prime</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">C_prime</span>
</code></pre></div></div>
<p>ğŸ”´ğŸŸ¢ğŸŸ£</p>
<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">LinearAlgebra</span>

<span class="n">s_eigvals</span><span class="x">,</span> <span class="n">s_eigvecs</span> <span class="o">=</span> <span class="n">eigen</span><span class="x">(</span><span class="kt">Symmetric</span><span class="x">(</span><span class="n">S</span><span class="x">))</span>
<span class="n">clean_eigvals</span> <span class="o">=</span> <span class="n">max</span><span class="o">.</span><span class="x">(</span><span class="n">s_eigvals</span><span class="x">,</span> <span class="mf">1e-15</span><span class="x">)</span> <span class="c"># avoid inverting numerical noise</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">s_eigvecs</span> <span class="o">*</span> <span class="kt">Diagonal</span><span class="x">(</span><span class="n">clean_eigvals</span> <span class="o">.^</span> <span class="x">(</span><span class="o">-</span><span class="mf">0.5</span><span class="x">))</span> <span class="o">*</span> <span class="n">s_eigvecs</span><span class="err">'</span>

<span class="n">Fâ€²</span> <span class="o">=</span> <span class="n">X</span><span class="err">'</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">X</span>
<span class="n">Ïµ</span><span class="x">,</span> <span class="n">Câ€²</span> <span class="o">=</span> <span class="n">eigen</span><span class="x">(</span><span class="kt">Symmetric</span><span class="x">(</span><span class="n">Fâ€²</span><span class="x">))</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">Câ€²</span>
</code></pre></div></div>
<p>ğŸ¦€</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">use</span> <span class="nn">ndarray_linalg</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>

<span class="k">let</span> <span class="p">(</span><span class="n">s_eigvals</span><span class="p">,</span> <span class="n">s_eigvecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="nf">.eigh</span><span class="p">(</span><span class="nn">UPLO</span><span class="p">::</span><span class="n">Lower</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="k">let</span> <span class="n">s_inv_sqrt</span> <span class="o">=</span> <span class="n">s_eigvecs</span><span class="nf">.dot</span><span class="p">(</span><span class="o">&amp;</span><span class="nn">Array2</span><span class="p">::</span><span class="nf">from_diag</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s_eigvals</span><span class="nf">.mapv</span><span class="p">(|</span><span class="n">x</span><span class="p">|</span> <span class="n">x</span><span class="nf">.powf</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))))</span><span class="nf">.dot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s_eigvecs</span><span class="nf">.t</span><span class="p">());</span>

<span class="k">let</span> <span class="n">f_prime</span> <span class="o">=</span> <span class="n">s_inv_sqrt</span><span class="nf">.t</span><span class="p">()</span><span class="nf">.dot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">f</span><span class="p">)</span><span class="nf">.dot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s_inv_sqrt</span><span class="p">);</span>

<span class="k">let</span> <span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">c_prime</span><span class="p">)</span> <span class="o">=</span> <span class="n">f_prime</span><span class="nf">.eigh</span><span class="p">(</span><span class="nn">UPLO</span><span class="p">::</span><span class="n">Lower</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="k">let</span> <span class="n">c</span> <span class="o">=</span> <span class="n">s_inv_sqrt</span><span class="nf">.dot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">c_prime</span><span class="p">);</span>
</code></pre></div></div>

<p>Time to update the density matrix using these new co-efficients. This is H<sub>2</sub> in restricted Hartreeâ€“Fock so only one occupied orbital to deal with.</p>

\[D_{\mu\nu} = 2\sum_{i}^{\text{occ}} C_{\mu i} C_{\nu i}\]

<p>ğŸ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">num_occ</span> <span class="o">=</span> <span class="n">num_electrons</span> <span class="o">//</span> <span class="mi">2</span> 
<span class="n">D_new</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num_occ</span><span class="p">]</span> <span class="o">@</span> <span class="n">C</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num_occ</span><span class="p">].</span><span class="n">T</span>
</code></pre></div></div>
<p>ğŸ”´ğŸŸ¢ğŸŸ£</p>
<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">num_occ</span> <span class="o">=</span> <span class="n">num_electrons</span> <span class="o">Ã·</span> <span class="mi">2</span> 
<span class="n">D_new</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="mi">1</span><span class="o">:</span><span class="n">num_occ</span><span class="x">]</span> <span class="o">*</span> <span class="n">C</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="mi">1</span><span class="o">:</span><span class="n">num_occ</span><span class="x">]</span><span class="err">'</span>
</code></pre></div></div>
<p>ğŸ¦€</p>
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">n_occ</span> <span class="o">=</span> <span class="n">n_electrons</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> 
<span class="k">let</span> <span class="n">c_occ</span> <span class="o">=</span> <span class="n">c</span><span class="nf">.slice</span><span class="p">(</span><span class="nd">s!</span><span class="p">[</span><span class="o">..</span><span class="p">,</span> <span class="mi">0</span><span class="o">..</span><span class="n">n_occ</span><span class="p">]);</span>
<span class="k">let</span> <span class="n">d_new</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">c_occ</span><span class="nf">.dot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">c_occ</span><span class="nf">.t</span><span class="p">());</span>
</code></pre></div></div>
<h3 id="energy-convergence-check">Energy convergence check</h3>

<p>We can calculate the energy from summing enetries in the Fock operator and core Hamiltonian</p>

\[E = \frac{1}{2}\text{Tr}[\mathbf{D}(\mathbf{H}^{\text{core}} + \mathbf{F})]\]

<p>Then itâ€™s just the matter of checking that the energy hasnâ€™t changed between each cycle, to some tolerance</p>

\[\Delta E = |E_{\text{new}} - E_{\text{old}}| &lt; \epsilon_{\text{tol}}\]

<p>ğŸ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">E_new</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">trace</span><span class="p">(</span><span class="n">D_new</span> <span class="o">@</span> <span class="p">(</span><span class="n">H_core</span> <span class="o">+</span> <span class="n">F</span><span class="p">))</span>

<span class="n">delta_E</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">E_new</span> <span class="o">-</span> <span class="n">E_old</span><span class="p">)</span>
<span class="k">if</span> <span class="n">delta_E</span> <span class="o">&lt;</span> <span class="n">epsilon_tol</span><span class="p">:</span>
    <span class="n">converged</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Converged! Final energy: </span><span class="si">{</span><span class="n">E_new</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s"> Ha"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">E_old</span> <span class="o">=</span> <span class="n">E_new</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">D_new</span>
</code></pre></div></div>
<p>ğŸ”´ğŸŸ¢ğŸŸ£</p>
<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">E_new</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">tr</span><span class="x">(</span><span class="n">D_new</span> <span class="o">*</span> <span class="x">(</span><span class="n">H_core</span> <span class="o">+</span> <span class="n">F</span><span class="x">))</span>

<span class="n">Î”E</span> <span class="o">=</span> <span class="n">abs</span><span class="x">(</span><span class="n">E_new</span> <span class="o">-</span> <span class="n">E_old</span><span class="x">)</span>
<span class="k">if</span> <span class="n">Î”E</span> <span class="o">&lt;</span> <span class="n">Îµ_tol</span>
    <span class="n">converged</span> <span class="o">=</span> <span class="nb">true</span>
    <span class="n">println</span><span class="x">(</span><span class="s">"Converged! Final energy: </span><span class="si">$</span><span class="s">E_new Ha"</span><span class="x">)</span>
<span class="k">else</span>
    <span class="n">E_old</span> <span class="o">=</span> <span class="n">E_new</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">D_new</span>
<span class="k">end</span>
</code></pre></div></div>
<p>ğŸ¦€</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let e_new = 0.5 * (&amp;d_new * &amp;(&amp;h_core + &amp;f)).trace().unwrap();

let delta_e = (e_new - e_old).abs();
if delta_e &lt; epsilon_tol {
    converged = true;
    println!("Converged! Final energy: {:.6} Ha", e_new);
} else {
    e_old = e_new;
    d = d_new;
}
</code></pre></div></div>

<p>We wrap the above in a loop with a maximum number of iterations and weâ€™re ready!</p>

<hr />
<h1 id="performance-comparison">Performance comparison</h1>

<p>Obviously solving a fake H<sub>2</sub> is a terrible comparison for the code performance doing real chemistry. Nevertheless..</p>

<hr />

<h2 id="non-execution-speed-stuff">Non execution speed stuff</h2>

<h3 id="lines-of-code">Lines of code</h3>
<h3 id="ease-of-development">Ease of development</h3>
<h3 id="readability">Readability</h3>
<h3 id="any-other-pains">Any other pains</h3>

<hr />
<h1 id="creating-web-content">Creating web content</h1>
<hr />
<p>Embedded Rust with <code class="language-plaintext highlighter-rouge">wasm-pack build --target web</code> and upload as a module with a <code class="language-plaintext highlighter-rouge">.js</code> file</p>

<p>Python load a <code class="language-plaintext highlighter-rouge">pyodide.js</code>. Will be slow</p>

<p><code class="language-plaintext highlighter-rouge">Julia</code> ğŸ”´ğŸŸ¢ğŸŸ£: thereâ€™s a live Pluto notebook with H<sub>2</sub> sliders <a href="https://pluto.land/n/lg6ry63f">here</a>.</p>

<p>Julia is designed to hit sweet-spot of easy to write and performance for scientific code, so muich so that thereâ€™s now a full production quality <a href="https://doi.org/10.1021/acs.jctc.0c00337">Quantum Chemistry package written in Julia</a>.</p>

<p>The sliders will be of R (maybe 0.25-1.5 A), so you can see the off-diagonal elements of S change, and the basis sets chosen from a dropdown. Then hit â€˜runâ€™ and watch the SCF cycles converge.</p>

<p>Have all 2x2 S matrix elements displayed. Plot the SCF cycles</p>

<hr />

<h2 id="related-web-resources">Related web resources</h2>

<ul>
  <li>ğŸ <a href="/interactive/hf-python/index.html">Python version</a> - Run with Pyodide</li>
  <li>ğŸ”´ğŸŸ¢ğŸŸ£ <a href="/interactive/hf-julia/index.html">Julia version</a> - Try it in your browser in a Pluto notebook</li>
  <li>ğŸ¦€ <a href="/interactive/hf-rust/index.html">Rust version</a> - WebAssembly performance</li>
  <li>ğŸ’» <a href="https://github.com/keiran-rowell/hartee-fock">Source Code</a> - All implementations</li>
</ul>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="code" /><category term="Hartree-Fock" /><category term="Python" /><category term="Julia" /><category term="Rust" /><category term="code" /><category term="tutorial" /><category term="quantum-chemistry" /><summary type="html"><![CDATA[ğŸ“– 15 min read â€¢ Quantum chemistry's fundamental solver in a trifecta of NextGen languages]]></summary></entry><entry><title type="html">Interactive Hartreeâ€“Fock in your browser: Julia | Python | Rust</title><link href="http://localhost:4000/interactive/2026-12-12-HF-interactive/" rel="alternate" type="text/html" title="Interactive Hartreeâ€“Fock in your browser: Julia | Python | Rust" /><published>2026-12-12T00:00:00+11:00</published><updated>2026-12-12T00:00:00+11:00</updated><id>http://localhost:4000/interactive/HF-interactive</id><content type="html" xml:base="http://localhost:4000/interactive/2026-12-12-HF-interactive/"><![CDATA[<blockquote>
  <p>Choose a language to explore the Hartreeâ€“Fock algorithm interactively:</p>

  <table>
    <tbody>
      <tr>
        <td>ğŸ”´ğŸŸ¢ğŸŸ£ Julia</td>
        <td>ğŸ Python</td>
        <td>ğŸ¦€ Rust</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<hr />

<h2 id="-julia-pluto-notebook">ğŸ”´ğŸŸ¢ğŸŸ£ Julia (Pluto Notebook)</h2>
<p><a href="https://pluto.land/n/lg6ry63f">Launch externally hosted notebook â†’</a></p>

<p><a href="/assets/interactive/hf-julia/index.html">Launch static HTML page â†’</a></p>

<p><em>Full interactivity with sliders and live recalculation.</em></p>

<h2 id="-python-pyodide">ğŸ Python (Pyodide)</h2>
<p><a href="/assets/interactive/hf-python/">Launch Python demo â†’</a></p>

<p><em>Run NumPy in your browser (~30s load time).</em></p>

<h2 id="-rust-webassembly">ğŸ¦€ Rust (WebAssembly)</h2>
<p><a href="/assets/interactive/hf-rust/">Launch Rust demo â†’</a></p>

<p><em>Near-native blazingly fast Rust performance compiled to WASM to run in your browser.</em></p>

<hr />

<p><strong>Companion guide:</strong> <a href="/code/2026-12-12-HF-in-rust-julia-python/">Hartree-Fock in Rust, Julia, and Python</a></p>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="interactive" /><category term="Hartree-Fock" /><category term="Julia" /><category term="Python" /><category term="Rust" /><category term="WASM" /><category term="interactive" /><category term="tutorial" /><category term="quantum-chemistry" /><summary type="html"><![CDATA[Choose a language to explore the Hartreeâ€“Fock algorithm interactively: ğŸ”´ğŸŸ¢ğŸŸ£ Julia ğŸ Python ğŸ¦€ Rust]]></summary></entry><entry><title type="html">Codon rarity translator and viewer in your browser</title><link href="http://localhost:4000/interactive/2026-03-01-codon-rarity/" rel="alternate" type="text/html" title="Codon rarity translator and viewer in your browser" /><published>2026-03-01T00:00:00+11:00</published><updated>2026-03-01T00:00:00+11:00</updated><id>http://localhost:4000/interactive/codon-rarity</id><content type="html" xml:base="http://localhost:4000/interactive/2026-03-01-codon-rarity/"><![CDATA[<p>[FRONT MATTER]</p>

<hr />

<p><a href="/assets/interactive/codon-rarity-viewer/index.html">Launch codon rarity viewer â†’</a></p>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="interactive" /><category term="codons" /><category term="structural" /><category term="biology" /><category term="synonymous" /><category term="harmonisation" /><category term="translation" /><category term="ribosome" /><summary type="html"><![CDATA[[FRONT MATTER]]]></summary></entry><entry><title type="html">Blue Fire and Yellow Brimstone: the worldâ€™s waning appetite for hellish sulfur</title><link href="http://localhost:4000/sulfur/2026-03-01-fire-and-brimestone/" rel="alternate" type="text/html" title="Blue Fire and Yellow Brimstone: the worldâ€™s waning appetite for hellish sulfur" /><published>2026-03-01T00:00:00+11:00</published><updated>2026-03-01T00:00:00+11:00</updated><id>http://localhost:4000/sulfur/fire-and-brimestone</id><content type="html" xml:base="http://localhost:4000/sulfur/2026-03-01-fire-and-brimestone/"><![CDATA[<p class="figcaption"><em>Photo Credit: <a href="https://commons.wikimedia.org/wiki/File:Menambang_Belerang.jpg">Candra Firmansyah</a> [CC BY-SA 4.0]</em></p>

<blockquote>
  <p>Content notice: child labour, exploited labour / slavery, the Mafia, smog deaths.</p>
</blockquote>

<hr />

<p><em>Itâ€™s just smoke. Floating over theâ€…volcano <br />
Itâ€™sâ€…just smoke. Go on,â€…you know I canâ€™t say no</em></p>

<p class="faded">â€” â€œSmokeâ€, Caroline Polachek, <strong>2023</strong></p>

<!-- -> Through line "From Hell, life". 

Also a story of commodity value inversion. What caused wars is now sold to be *taken away*. If the petroleum industry shrinks it might invert again

---
#### Open on the geothermal vent and sulfur eating life. Heat + energy + sulfur can be metabolism [image of hydrothermal vent]. BILLIONS OF YEARS OLDER THAN PHOTOSYNTHESIS *a couple of sentences setting up the smash cut to modern day humans surrounded by blue fire*
#### Open again on the blue fire of Indonesian suflur mines. (Humans not microbes) [image of blue fire]
4 billion years later, well above the sulfur-eating sea creatures that still cluster around deep-sea vents, Idonesian miners descend into volcano Ijen to start their work. 
#### Move on to the Carusi and the Silician Sulfur mines. (Human societal exploitation) [painting of carusi]
"This hell is not new. Mining brimstone fueled the growth of one of humanity's most notorious organisations --- the Silician Mafia"
#### Gunpowder and Greek Fire. (Human destruction in warfare) [ancient illustration of Greek Fire]
#### Industrial demand (Vulcanisation) then the great economic inversion (S as petroleum byproduct people *pay* to get taken away). [image of modern day S yellow waste mounts] Even if H2SO4 is one of the most produced industrial chemicals and needed for fertiliser. 
#### Natural disasters take away biological life London Smog, Year Without Summer [image of London Smog]
#### Biochemistry -- now reveal Fe-S clusters as the fundamental primeval electron harvest unit. They were the origin but they're *still* essential and unchanged. Proteins stabled together with disulfide bridges in Cysteine. [Protein structure illustration]

##### Limit to the above topics and  make it tight and cinematic -->

<hr />

<h3 id="from-hell-life-sulfur-eating-microbes">From hell, life: sulfur eating microbes</h3>

<p><img src="/images/archaea_giggenbach_hydrothermal_vents.jpg" alt="Underwater volcano microbes" /></p>

<p class="figcaption">Archaea at the hydrothermal vents of the Giggenbach underwater volcano 800 km North-Northeast of New Zealandâ€™s North Island. <strong>2005</strong>, <a href="https://www.omao.noaa.gov/image-licensing-usage-info">NOAA Vents Program</a>.</p>

<p>Sulfur â€œeatingâ€ microbes - reduction to H2S. Basically just mention this life energy source is billions of years older than photosynthesis</p>

<p><a href="https://www.livescience.com/extreme-microbes-underwater-volcano.html">â€œHundreds of never-before-seen life-forms live in this 6,000-foot-deep volcanoâ€™s acid jetsâ€</a></p>

<h3 id="mountains-of-fire-ijens-sulfur-volcano">Mountains of fire: Ijenâ€™s sulfur volcano</h3>

<p><img src="/images/Ijen_fire.jpg" alt="Ijen fire" /></p>

<p class="figcaption">Blue fire spewing forth from the sulfur mine around Ijen volcano complex. <a href="https://flic.kr/p/AZLUcx">Trian Wida Charisma</a> [CC BY-NC 2.0]</p>

<p>These â€œsoldiers of sulfurâ€ (<em>prajurit belerang</em>) are here to mine <em>emas setan</em> â€“ devilâ€™s gold.</p>

<h3 id="an-infernal-gateway-sulfur-and-the-sicilian-mafia">An infernal gateway: sulfur and the Sicilian Mafia</h3>

<p><img src="/images/I_carusi.jpg" alt="I_carusi" /></p>

<p class="figcaption">â€˜I carusiâ€™, Onfrio Tomaselli, <strong>1905</strong>.</p>

<blockquote>
  <p>â€œI am not prepared just now to say to what extent I believe in a physical hell in the next world, but a sulfur mine in Sicily is about the nearest thing to hell that I expect to see in this life.â€</p>
</blockquote>

<p>â€” <em>The Man Farthest Down</em>, Booker T. Washington, <strong>1911</strong></p>

<p><a href="https://doi.org/10.1086/705370">â€œWhen necessary to guarantee the supply of cheap sulfur against price and supply regulation, the British mobilized their Royal Navy. It is argued that the Sicilian frontier should be incorporated into the history of the Industrial Revolution.â€</a></p>

<ul>
  <li><a href="https://youtu.be/FzIg3yDC6pg?si=dn74s8vSDOEg19HP">Why Was Sicilian Sulfur So Desired Across the Medieval World?</a></li>
</ul>

<p>Messinian Salinity Crisis â€“ 6 million years ago connection to ocean closed, the water evapourated, the calcium sulfate dissolved and sulfate-reducing bacteria reduced CaSO4 -&gt; CaCO3 + S â€“ sulfur bearing limestone.</p>

<p>A movie depecting a child minerâ€™s descent into the mines <a href="https://youtu.be/p_4abqpxlZs?si=HDjE8h_DK9Ax19SV">â€˜La discesa di AclaÌ€ a Floristellaâ€™</a></p>

<ul>
  <li>Silician diaspora to the USA <a href="https://siciliangodmother.com/2015/04/01/sulphur-sicilians-and-the-exodus-to-the-usa/">https://siciliangodmother.com/2015/04/01/sulphur-sicilians-and-the-exodus-to-the-usa/</a></li>
</ul>

<h3 id="hellfire-sulfur-in-gunpowder-and-greek-fire">Hellfire: sulfur in gunpowder and Greek fire</h3>

<p><img src="/images/Greekfire-madridskylitzes1.jpg" alt="Greek fire" /></p>

<p class="figcaption">â€œThe Roman fleet setting fire to the enemy fleet [led by Thomas of Sicily]â€. <em>Madrid Skylitzes</em>, manuscript on teh Byzantines for the court of Plamero in Sicily, <strong>12th century CE</strong></p>

<blockquote>
  <p>Automatic fire is composed of equal parts of native sulfur, rock salt, incense, thunderbolt stone, or pyrites, ground in a black mortar in the midday sun, and mixed with equal parts of the resin of the black sycamore and liquid asphalt of Zakynthos to a greasy paste.</p>
</blockquote>

<p>â€” <em>Kestoi</em> [Fragment D25], Sextus Julius Africanusm, <strong>c. 220 CE</strong></p>

<p>Fireships (inspired by, though not using,  â€œGreek fireâ€) were instrumental in <a href="https://en.wikipedia.org/wiki/Burning_of_the_Ottoman_flagship_off_Chios">defeating the Egyptian fleet of the Ottoman Empire in the Greeek war of Independence</a></p>

<h3 id="yellow-mammon-sulfurs-economic-inversion-by-the-petrodollar">Yellow mammon: sulfurâ€™s economic inversion by the petrodollar</h3>

<p>H2SO4 production - Contact Process
Frasch process - no longer confident to a Sicilian mob monopoly</p>

<p><img src="/images/syncrude_sulfur_mountains.jpg" alt="Sulfur industrial mountains" /></p>

<p class="figcaption">Unwanted mountains of sulfur piling up at the Syncrude Athabasca oil sands in Alberta, Canada. <a href="https://www.flickr.com/photos/woodhead/8650842382/in/photolist-ebrQ3S-zJxnjj-qMsLT-gaZAVh-2hCV2Pf-2hqJPoP">Jason Woodhead</a> [CC BY 2.0]</p>

<p>BBC New article <a href="https://www.bbc.com/news/magazine-28369829">Sulphur surplus: Up to our necks in a diabolical element</a></p>

<p>Sulfur mountains <a href="https://www.sciencedirect.com/science/article/abs/pii/S0360544209005118">Large scale disposal of waste sulfur: From sulfide fuels to sulfate sequestration</a></p>

<p>This economic inversion is what allows <a href="https://news.flinders.edu.au/blog/2025/06/27/golden-opportunity-to-reduce-toxic-waste/">researchers to develop on â€˜no/low costâ€™ sulfur sponges</a> cooked in â€”I joke you notâ€” spent fish and chip shop oil, to <a href="https://micro.org.au/news/the-future-of-gold-is-green-new-tech-recovers-the-precious-metal-without-pollution/">clean up the toxigoldâ€“mercury</a> amalgam waste in the [desparate industry of â€˜artinisalâ€™ gold mining] common in the Amazon.</p>

<p>From wars and the British Industrial revolution (link the Royal Navy fighting Sicily) to a negatively priced commodity.</p>

<p>But if we stopped using fossil fuels entirerly will there be a dearth of sulfur?
<a href="https://rgs-ibg.onlinelibrary.wiley.com/doi/10.1111/geoj.12475">Sulfur: A potential resource crisis that could stifle green technology and threaten food security as the world decarbonises</a></p>

<p>The high sulfur content of Venzeluan oil (and the depressing and scary political actions and  ramifications)
â€˜Sourâ€™ oil has &gt; 0.5% sulfur. Oil in the Venzuelan Orinoco belt contains ten times that amount.</p>

<p>Vulcanisation</p>

<p>Sulfuric acid for fertilisation</p>

<h3 id="sulfurous-sky-sox-and-atomspheric-pollution">Sulfurous sky: SO<sub>x</sub> and atomspheric pollution</h3>

<p><img src="/images/NYC_1966_smog.jpg" alt="NYC 1966 smog - Moden Smog of the City" /></p>

<p class="figcaption">Smog on the front page of <em>The New York Times</em>, photo by Neal Boenzi, November 25, <strong>1966</strong>.</p>

<blockquote>
  <p>Such yellow sullen smokes make their own element. They will not rise, but trundle around the globe. Choking the aged and the meek, the weakâ€¦</p>
</blockquote>

<p>â€” <em>Fever 103Â°</em>, Sylvia Plath, <strong>1963</strong></p>

<p>1816 Year Without Summer, 1952 Great Smog of London, 1966 New York City Smog,</p>

<p>2020 International Maritime Organisation legislations â€“ temporary sea level warming effect.</p>

<p>Sulfur containing ship fuel. Acts as a global <em>coolant</em> but SOx is so toxic in the atmosphere it needs to be banned</p>

<h3 id="an-infernal-engine-iron-sulfur-clusters-and-bioelectricity">An infernal engine: iron-sulfur clusters and bioelectricity</h3>

<p><img src="/images/iron-sulfur_clusters.jpg" alt="Iron-Sulfur clusters" /></p>

<p class="figcaption">Iron-Sulfur clusters that act as waypoints in the electrical process of life, including the reactive â€˜crucibleâ€™ of <a href="link back to nitrogen fixation post">nitrogenase</a>. Tracey A. Rouault &amp; Wing-Hang Tong, <a href="https://doi.org/10.1038/nrm1620">â€œIron-sulphur cluster biogenesis and mitochondiral iron homeostasisâ€</a>, <em>Nature Reviews Molecular Cell Biology</em>, <em>6</em>, 345â€“351, <strong>2005</strong>.</p>

<p><a href="https://en.wikipedia.org/wiki/Iron%E2%80%93sulfur_world_hypothesis">Fe-S world hypothesis</a></p>

<p>Also mention disulfide bridges betwen cystestine amino acids stapling proteins together</p>

<p>Thereâ€™s something almost mythical about underwater brimstone cauldrons being the origins of us all/</p>

<hr />

<p><em>â€¦ but torture without end <br />
Still urges, and a fiery deluge, fed <br />
With ever-burning sulfur unconsumed</em></p>

<p class="faded">â€” <em>Paradise Lost</em> [Book I], John Milton, <strong>1667</strong></p>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="sulfur" /><summary type="html"><![CDATA[ğŸ“– 10 min read â€¢ Life and death from satan's gold]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/images/Menambang_Belerang.jpg" /><media:content medium="image" url="http://localhost:4000/images/Menambang_Belerang.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">The Delian Mode: anti-imperial leagues, synths, federated computing, and lost futures</title><link href="http://localhost:4000/writing/2026-01-01-the-delian-mode/" rel="alternate" type="text/html" title="The Delian Mode: anti-imperial leagues, synths, federated computing, and lost futures" /><published>2026-01-01T00:00:00+11:00</published><updated>2026-01-01T00:00:00+11:00</updated><id>http://localhost:4000/writing/the-delian-mode</id><content type="html" xml:base="http://localhost:4000/writing/2026-01-01-the-delian-mode/"><![CDATA[<p class="figcaption"><em>Photo credit: <a href="https://www.bbc.co.uk/programmes/profiles/51LC2shThjnCNR8dd4z2SRQ/delia-derbyshire">BBC Archives</a></em></p>

<blockquote>
  <p>Content notice â€” mentions of: The Blitz. The War on Terror. The Khmer Rouge. Realpolitik. Depression. The COVID-19 pandemic.
Not the views of any employers, obvs.
Not a historian or constitutional scholar, obviously.</p>
</blockquote>

<hr />

<style>
  /* Force parchment colour personal signifier light mode */
  body, .page, .content, article {
    background-color: #faf8f3 !important; /* beige/paper */
    color: #000 !important; /* black text */
  }
 
  /* Override any dark mode text colors */
  p, h1, h2, h3, h4, h5, h6, li {
    color: #000    !important;
  }
  
  blockquote {
    color: #6b5d5d !important; /* darker, more sepia-toned */
    font-style: italic; /* classic quote styling */
    border-left: 3px solid #d4c5b9; /* subtle parchment-toned border */
    padding-left: 1em;
    margin-left: 0;
  }

  blockquote p {
    color: #887777 !important;
  }
 
  /* Tags */
  .ellipsis {
    color: #7F7F7F !important;
  }
 
  /* Keep links visible */
  a {
    color: #0066cc !important; /* or whatever link color you want */
  }
  
  a:visited {
    color: #551a8b !important;
  }
</style>

<p><em>Long was the year, will you stay now youâ€™re here?</em></p>

<hr />

<p>The Lycian League lasted for hundreds of years (constituted <em>ca.</em> 2<sup>nd</sup> century BCE â€“ 43 CE) as an ancient democratic alliance of prosperous and culturally rich city-states along the Southern Anatolian coast. Lycian civilisation itself dates from the Bronze Age. Yet theyâ€™re barely known in modern times outside niche archaeological circles. Perhaps because they didnâ€™t expand, they didnâ€™t conquer, they didnâ€™t have a Great Empire or a Great Leader. Rich civic life is often not enough for the historical record â€” the conventional narrative of history becomes condensed to battles and states begat in blood.</p>

<p>The Lycians left behind some <a href="/images/lycian_cliff_tomb.jpg">monumental tombs</a> hewn into the cliffs of TÃ¼rkiye and stunning <a href="/images/lycian_griffin_sarcophagus.jpg">griffin-fringed sarcophagi</a>. They also left behind an early democratic model, effectively repelled powerful imperial neighbours, and retained some autonomy even after annexation as the final Roman province in Anatolia in 43 CE. Assimilated under Pax Romana, their courts and federated structure were allowed to stand. Yet, the Lycian legacy dissipated except among a few scholars.</p>

<h3 id="forgotten-federations">Forgotten Federations</h3>

<p>The Delian League was an anti-Persian Empire defensive alliance, after repelling the largest invasion force the Aegean had ever seen. It united the smaller Greek city-states â€”150â€“200+ at its peakâ€” against the dominance of the continental threats. Its symbolic core was in Delos, where the Treasury was kept. The members of the alliance paid into the <em>phoros</em> tribute system that provided funds, ships, manpower for the league. The island of Delos had practical advantages: it was central to the Aegean and far-flung from any dominant city-states. It also held symbolic power: it was neutral territory controlled by no-one, and was long sacred as the birthplace of Apollo and Artemis and so hopefully inviolable.</p>

<p>This alliance divvied among equals, where the <em>phoros</em> was paid according to the population, means, and resources of each island city-state lasted in true form for less than 25 years, shattered by a hollowing out of the alliance structure. In 454 BCE the accumulated treasury was relocated from Delos straight to Athens â€” under the justification of security, while also in reality accomplishing fiscal control. Voluntary contributions into the league were now mandatory, the treasury re-appropriated for the glorification of Athens, and Athens began to dictate the politics of other city-states. States which tried to leave were kept in the league by military force, the <em>phoros</em> increased, and the tribute paid to Athens from client city-states was <a href="https://www.davidgill.co.uk/attica/atl578.htm">totted up in stone in the Acropolis for all to see</a> [with 1/60<sup>th</sup> dedicated to Athena]. In this way all tributaries flowed back to the Athenian well. The Athenian hegemony began to impose democratic government structures across the region. The centre that brought together the League grew too powerful. Sparta, often steadfast and unafraid to be bellicose, grew weary of growing imperial ambitions from Athens, and in the Peloponnesian War that followed Sparta reversed the power structure using the support of the Persian Empire to crush Athens, waging shameless total war, and bringing an end to the Ancient Greek Golden Era as the Aegean states became Spartan subjects.</p>

<p>Athena is known as the goddess of wisdom and strategic warfare, symbolised by the wise owl. Moreover, as <em>Athena Polias</em> (â€˜Athena of the Cityâ€™) she was protector of the <em>polis</em> â€” civic life, the city-state, democratic institutions. This model was seen by Athenians to be superior and they used the wealth of their splendid Athens (bolstered by <em>phoros</em> revenue) and naval domination to export this governance model to the periphery. Athens, under the aegis of the goddess of the civic state, could not resist overriding the isolated autonomy of the league it drew together. The impulse to federate, to balance local autonomy with central authority, echoes down the centuries, even if the voices of the <em>polis</em> are silent in our history. A resonance resurfaces during experiments in democracy of the early United States.</p>

<hr />

<h3 id="federalism-returns">Federalism Returns</h3>

<p>The American revolution was against paying tribute without representation. A revolt against a naval empire that could no longer effectively reach them. As a set of colonial outposts they had choices to make on how to unite. All States [except RI, the smallest] sent delegates to the 1787 Federal (AKA Constitutional) Convention to address what the scope of federal powers should be: what were inalienable states rights, who got representation and how, and who was considered a citizen or property.</p>

<p>What emerged was the compromise: a core Constitution settling divisive views, which needed to be ratified by the States. The Federalist Papers were circulated to sell the document to the new nation. Three papers mention the Lycians. <a href="https://avalon.law.yale.edu/18th_century/fed09.asp"><strong>No. 9</strong></a> argues that political science had advanced since Ancient times, including legislative checks and balances. The Lycian confederation is cited as proof that â€œan assemblage of societiesâ€ with proportional city-state representation could endure.  <a href="https://avalon.law.yale.edu/18th_century/fed16.asp"><strong>No. 16</strong></a> argues that confederation (a looser allegiance than proposed in the Constitution) typically failed because the laws reached the States and not the people, though â€œ the Lycian and Achaean leaguesâ€ appear to have been the most free of mistakes. Laws enforceable against States not people removed personal culpability and the ability for non-violent civil lawsuits. <a href="https://avalon.law.yale.edu/18th_century/fed45.asp"><strong>No. 45</strong></a> rails against Old World doctrine that â€œpeople were made for kings, not kings for the peopleâ€ ever taking hold in America. The Lycian and Achaean leagues were held up as examples of federation collapsing not into monarchical authority but disunion into constituent States. The author of <strong>No. 45</strong>, Madison, thought the United States would avoid either mode of collapse since the federal government could not operate without State consent, and the States benefited from federal control of national priorities and the guarantee of the rights of the â€œlives, liberties, and propertiesâ€ of the people.</p>

<p><strong>No.s 9 &amp; 16</strong> were authored by Alexander Hamilton. Godfather to the Federal Reserve; <em>the</em> global benchmark for Funds interest rates, manager of US Treasuries, and lender of last resort. Hero of the 2015 Broadway historical hip-hop/classical <a href="https://youtu.be/DSCKfXpAGHc?si=79B6xRXz-cZevJ_m">runaway success</a>. An unstoppable anachronistic restaging of an indomitable legacy â€” but after all, <a href="https://youtu.be/6_35a7sn6ds?si=GjEWL2_XHz2p0SJO">immigrants, they get the job done</a>. It was wildly popular and audiences were humming about <em>The Room Where it Happens</em> just over a year before the election of a leader whose anti-federalist tendencies and refusal to relinquish power strike close to fears the Founding Fathers had that their American experiment in government would be brought to an end by a democratically elected president who would <a href="https://www.theatlantic.com/magazine/archive/2025/12/trump-third-term-authoritarianism/684616/">proceed to dismantle the checks and balances on the reins of power</a>.</p>

<p>The American experiment had positioned itself as the inheritor of Athenian democratic ideals, even as it transformed from isolationist republic into â€˜the worldâ€™s policeâ€™ after being drawn into WWII. But the war that brought America into global hegemony also revealed something new: modern technology had made the imperial centre vulnerable. Germanyâ€™s expansion into neighbouring democracies â€”promising a thousand-year realm that fell within twelveâ€” set the battlefield for demonstrating that geographic distance no longer provided security. Long range bombers could level civic centres, and V2 rockets could strike the capital regardless of how far your territories extended. The hegemon was no longer safe from modern technological development, even if the sun never set on your empire. Isolation was over. There is no buffer.</p>

<hr />

<p>The imposition of fascism is brought with sound and fury. The drone of buzz bombs, the liftoff of rockets, the orders barked over the top of any sense or objections, the shortwave broadcasts to a captive enraptured audience, the enraged soundbites of sole saviour reposted throughout a social media echo chamber, the cheering of crowds promised a triumphant future in front of fake monuments, the piercing wails of air raid sirens. It was the last that Delia Derbyshire heard the most, growing up in Coventry during the Blitz.</p>

<h3 id="resistance-as-a-noise">Resistance as a Noise</h3>

<p>Deliaâ€™s experience of the air raid siren wasâ€”buried in her subconsciousâ€”formative in her career journey into synthesising repetitive sound. A bright girl captivated by music from all time periods, Delia won a scholarship to Girton College at Cambridge University where she studied a mathematics degree, incorporating music studies. The mathematical training brought a perfectionistic precision to her work, but she wasnâ€™t ruled by the slide-rule and intentionally used human fallibility to introduce swing into the rhythm. To transform industrial sounds into art required understanding what sound <em>is</em> and how synthesis could build it from base component frequencies. New worlds of sound were explored by experimenting with layerings of the five basic sound waves: sine, square, sawtooth, triangular, and white noise.</p>

<p>Rather than drone on about the physics, Iâ€™ll let the synth pioneers demonstrate. Delia <a href="https://youtu.be/qsRuhCflRyg?si=6mQbVvDQJmQT6oYZ">demonstrated with an oscilloscope in 1965</a> including her analogue sampling work. Wendy Carlos <a href="https://youtu.be/4SBDH5uhs4Q?si=9LpckiUrRIjcoolQ">demonstrates waves with a patch bay</a> five years later. Some trailblazers adept with a soldering iron even invented their own machines. Daphne Oram, cofounder of the Radiophonic Workshop, was inspired by a school experiment using an oscilloscope to visualise a sound wave. Why couldnâ€™t the reverse be possibleâ€”sound generated from inputting a graph? The <a href="https://www.daphneoram.org/oramicsmachine/">Oramics machine</a> was born: lines drawn on glass slides allowed free-form pitch expression beyond electrical oscillations, though with many technical difficulties.</p>

<p>Musicians werenâ€™t the only ones soldering electronics and poring over sine waves. Ruby-Payne Scott, working on secret war-time radar technologies, had become interested in transmissions from beyond Earth. Working in academia with Lindsay McCready and group leader John Pawsey they were able to pick up and classify bursts of radiowaves <a href="https://www.nature.com/articles/157158a0">broadcast during sunspot fluctuations</a>. The understanding of the signals from our universe had moved beyond <a href="https://www.smsa.org.au/book-reviews/the-glass-universe-by-dava-sobel/">ceiling-breaking spectral photographs of the night sky</a> to the <a href="https://theconversation.com/joy-division-40-years-on-from-unknown-pleasures-astronomers-have-revisited-the-pulsar-from-the-iconic-album-cover-119861">â€˜soundâ€™ of stars themselves</a>. Ruby would lose her permanent position, not due to her ASIO file <a href="https://web.archive.org/web/20140714170923/http://www.naa.gov.au/collection/snapshots/find-of-the-month/2009-march.aspx">documenting leftist tendencies</a>, but in 1951 when her hidden marriage was exposed for being in violation of Australian public service marriage rules in force until 1966.</p>

<p>All of the above was visualised as electrical current fluctuations on an oscilloscope. The Australian Broadcasting Corporation (ABC) logo itself is connected to this motif: the <a href="https://www.abc.net.au/science/holo/liss.htm">three-loop Lissajou polynomial figure</a> of out-of-phase sine waves represented its broadcast charter for both radio and TV. The ABC archives might hold an indirect legacy connection to Delia. The BBC discarded archived content for cost saving measures, including <em>Doctor Who</em> recordings for which Delia created the theme tune. The ABC though, receiving copies for broadcast from the BBC centre, makes Australia ripe for rediscovering <a href="https://www.abc.net.au/news/2020-08-23/doctor-who-missing-episodes-could-they-be-in-australia/12568918">lost footage</a>, especially censored edits spliced by the Film Censorship Board.</p>

<p>But the oscilloscope tracesâ€”whether exploring the universe or measuring tonesâ€”were a way to visualise something deeper. The core driver of the work was exploration: scientific and cultural. While the waveforms were mathematically neutral, the human ear encoded them as emotion in the brain. Somehow, this beating of the air makes us feel something. Sometimes, it changes how we think.</p>

<h3 id="sirens-into-songs">Sirens Into Songs</h3>

<p>Early synthetic pioneers figured out how to imbue true emotions into sine and sawtooth waves: creating some of the most evocatively accurate soundscapes of <a href="https://youtu.be/XQEYdgY2M8U?si=5wj2Vh0FD1uuQi_F">depression</a>, <a href="https://youtu.be/SNpIYln58EE?si=6u7ASIeGBbSwTi7r">despair</a>, and <a href="https://youtu.be/1RrsiGmLp_E?si=xacVEqkG7AfNDbxD">enervated overawe</a>; but also <a href="https://youtu.be/yVLjbGs2s-8?si=W7yoW1QleBG9Uo7K">serene calm</a>, <a href="https://youtu.be/OyUkmxy5VMI?si=Id1Ciwpe_AoCTYXY">arrestingly beautiful desert soundscapes</a>, <a href="https://youtu.be/NChqEEz31eE?si=cH4djqqz1EE5N6Cc">cosmic wonder</a>, <a href="https://youtu.be/RScZrvTebeA?si=z02HqP_EojAKpP3B">Sci-Fi noir intrigue</a>, and several odd <a href="https://youtu.be/jetzY-W78gg?si=DdpNwUCSC9A7pM02">ditties</a> of <a href="https://youtu.be/3YudPg7cbR4?si=dvKPemx7fzEnNMmv">pure joy</a>. It was the kind of no roadmap cultural movement where Delia could dictate <em>â€œUhh.. forget about this, itâ€™s for interest onlyâ€</em> and then unleash <a href="https://youtu.be/vwQIgGQLOQ8?si=tzi0diKqHZR_ZkwS">one of the first (entirely analogue) electronic driving techno beats</a>.</p>

<p>Many early synth pioneers were <a href="https://www.allenandunwin.com/browse/book/Cosey-Fanni-Tutti-Re-sisters-9780571362189">unconventional</a> in social categories. <a href="https://youtu.be/7r-3hlzpV7M?si=3e7fzqAegLWC02bx">Women securing a respected place</a> in traditionalist organisations undergoing a new technology landscape, openly queer and <a href="https://youtu.be/Z3cab5IcCy8?si=G86RNli9vIi5rU2h">trans individuals</a>. People who were equally comfortable with mathematics and engineering as with classical composition. The BBC Radiophonic Workshop had a policy of staff anonymity (â€˜non-musicalâ€™ technicians shouldnâ€™t compete with the jobs of â€˜realâ€™ composers), which may have paradoxically created some space to navigate within the organisation â€” you couldnâ€™t be dismissed purely on your identity if no-one knew who you were. This also ironically meant pioneering work could only be evaluated in hindsight. While Australian composer Ron Grainer wrote the notational sketches of the <em>Doctor Who</em> theme, it was Deliaâ€™s sonic wizardry that took a leftfield implementation and made the iconic sounds her own, and he was delighted. It was an uphill battle to get technicians recognition, only half-a-century later was Delia officially recognised in BBC screen credits in the <em>The Day of the Doctor</em> (2013). The internet, gladly, is awash with her legacy; remembering what institutions had for the longest time forgotten.</p>

<p>With growing use of synths in movie scores, pop music, and the production of digital samplers and sequencers synth music could become commercial. Aussie company Fairlight released one of the first with the <a href="https://youtu.be/jkiYy0i8FtA?si=FgorFmUbZzTeMgdI">Computer Musical Instrument (CMI) in 1979</a>. The synthetic instrument had moved from soundscape to melody. The 80s had arrived. People flocked like seagulls to dance to four-on-the-floor pop tracks, with pitch perfect synthesised songlines and unerring drum machines. Just as quickly the weird and experimental became adapted for the commercial, some Sheffield lads <a href="https://youtu.be/gpGMPiWMjN4?si=f8yz58mszBbr0-_R">started an electronic music project</a> (a <em>Doctor Who</em> rendition their crowd draw) only hitting the big leagues after <a href="https://youtu.be/uPudE8nDog0?si=k5Wa7gwBMVD68GMA">meeting a waitress working at a cocktail bar</a>.</p>

<p>Everyone was changing up quickly for music television; <a href="https://youtu.be/u1ZvPSpLxCg?si=jXPmCNQX49c6x-Aj">childlike insecurities</a> were discarded to <a href="https://youtu.be/aGCdLKXNF3w?si=sWFe8q2tmgX4MBqQ">rule the world</a> (and the charts); Al Jourgensen tried his hand at the <a href="https://youtu.be/1VFqVRepm6U?si=nG0J0gFLQ91B-rtD">Goth romantic thing</a> later swerving <a href="https://youtu.be/GXCh9OhDiCI?si=7bDuRs66fba4nPco">to headbanging hotrod trash</a>; the quintessential post-punk band reformed as the <a href="https://youtu.be/9GMjH1nR0ds?si=Ea6TRW4aNCSVQRKr">quintessential synth-pop band</a>; and an experimental melancholic new wave duo hit meteoric success by placing their edge <a href="https://youtu.be/qeMFqkcPYcg?si=vKn4EJDo59adVnLE">under a 4-4 bouncing synth</a>. By the mid-80s synth had gone full pop and Madonna told us all to just <a href="https://youtu.be/52iW3lcpK5M?si=hjsNBIz0WBlsz46N">get into the groove</a>. Stock Aitken Waterman dominated this new commercial space, turning out the synth-pop assembly line that produced over 100 Top 40 hits, becoming one of the most <a href="https://youtu.be/PGNiXGX2nLU?si=mhQ5CWLzkUlW7lKh">successful</a> <a href="https://youtu.be/dQw4w9WgXcQ?si=tBbZR14ow8ZwgAWl">hit</a> <a href="https://youtu.be/LaTGrV58wec?si=mYV6MNxWXwI9VqaE">factories</a> <a href="https://youtu.be/aGxJm_Sy2aw?si=0gzPliTXFrflLvnc">of</a> <a href="https://youtu.be/tto_nmsND_o?si=FzXaU1D8ZqPzCh1C">all</a> <a href="https://youtu.be/d4-1ASpdT1Y?si=hV6AleNEn-nEqvkm">time</a>.</p>

<p>Electronic Dance Music (if that category is even definable) competes with other massive genres under rock and pop for most listens, and is widely popular particularly <a href="https://mixmag.net.au/read/stats-reveal-that-australians-listen-to-dance-music-more-than-any-other-country-news">in Australia</a> and Europe, especially when <a href="https://youtu.be/7oQFns0WQTo?si=s9CKJjUeaqaZn2Yu">set against the American charts</a>. The early affective experiments of the synthesized sounds have been replaced with dance tracks, free of arresting content and structured around repetition for pure hedonism. Anthems have also escaped their nationalistic or community constraints, with loss of designed civic purpose, but also with freedom from official narrative and record. You can just beâ€”dance, exist, have fun, go to the festivalâ€”<em>without serving a state purpose or national cause</em>.</p>

<hr />

<p>Delia Derbyshire would work late at night in the BBC Radiophonic Workshop, where no-one could supervise her obsession. Magnetic tape, meticulously spliced by hand with a razor blade, hung around the rooms â€” a hand crafted sample bank. Within the hierarchy of the prestigious institution of the BBC the cover of night gave Delia creative free rein, her sounds could echo the halls and delay effects were instantiated in real physical distance. She held the record for the longest tape loop. Trailing off from the read heads, it was run in streamers through doors and along the longest corridor in London. The Workshop was filled with oscillators, tone generators, and wobbulators she didnâ€™t need to share at night. This was where air raid sirens became music.</p>

<p>The European counterparts to the Radiophonic Workshop (the <a href="https://120years.net/the-grm-group-and-rtf-electronic-music-studio-pierre-schaeffer-jacques-poullin-france-1951/"><em>Groupe de Recherches Musicales</em></a> [FR], the <a href="http://120years.net/wordpress/wdr-electronic-music-studio-germany-1951/"><em>Westdeutscher Rundfunk KÃ¶ln</em></a> [DE]) were seen as <em>expressly</em> artistic studios. The <a href="https://www.funkhaus-berlin.net/"><em>Funkhaus</em></a> [GDR] studios in East Berlin were the most sprawling recording studios in the world, and extensively wiretapped by the surveillance obsessed Stasi. In contrast, the BBC Radiophonic Workshop had an express utility: to create sonic effects for radio (<em>The Hitchhikerâ€™s Guide to the Galaxy</em>) and incidental music for TV (<em>Doctor Who</em>), particularly serving the civic purpose of British educational broadcasts. An otherworldly creative soundset put to use to reach millions in the sonic stings of 70s/80s school documentaries, now spoofed in <a href="https://youtu.be/z2myFLUDB74?si=3k2imbzdtBEAxc9i"><em>â€˜Look Around Youâ€™</em></a>.</p>

<p>The BBC Radiophonic Workshop was <a href="https://doi.org/10.1093/acprof:oso/9780195368406.003.0006">drawn to a close in 1998</a>. With new technology much of its core work could be outsourced or  superseded, and despite being funded from the shared civic model of the TV licence, it had been given 5 years to demonstrate economic self-sustainability. Its work dried up, key figures left, and left and the workshop closed for good. An inevitable foreclosure under this economic calculus; especially if you follow government fiscal policy where the <a href="">much debated</a> BBC licence fee is <a href="https://youtu.be/4luBQ8b1j28">not public money but taxpayersâ€™ money</a> and a philosophy that really, <a href="https://youtu.be/WhJvOKJCYP4?si=7YmWcwBZPSolZ7Hn">there is no such thing as a society</a>. Though, one wonders how to continue running difficult civic spaces, such as <a href="https://youtu.be/_G4dHRN2Dug">childrenâ€™s programming that discusses the realpolitik complexities</a> of keeping â€˜trueâ€™ administrative continuity after the Vietnamese army deposed the horrific, <em>brutal</em>, atrocity ridden Communist Party of Kampuchea (Cambodia).</p>

<blockquote>
  <p>I was trying to analyse myself and Iâ€™ve got an open attitude to soundâ€¦ I was there in the Blitz and itâ€™s come to me, relatively recently, that my love for abstract sounds [came from] the air raid sirens: thatâ€™s a sound you hear and you donâ€™t know the source of as a young childâ€¦ then the sound of the â€˜all clearâ€™ â€” that was electronic music.</p>
</blockquote>

<p>â€” Delia Derbyshire, <em><a href="https://youtu.be/JlBLcLdTYr4?si=hyB52-XgvS5jDJME">Boa</a></em> [<a href="https://web.archive.org/web/20210620000413/http://www.delia-derbyshire.org/interview_boa.php">defunct fanzine</a>], <em>Issue 7</em>, <strong>1998</strong>.</p>

<h3 id="there-is-no-alternative">There is No Alternative</h3>

<p>I grew up in a period of seemingly unending neocon governments, with neoliberal alternatives offering not much departure and acquiescing on foreign policy conflicts, throughout my childhood years. George Bush Jr had assumed his fatherâ€™s prior role in office, and echoed his fatherâ€™s intervention in the Gulf, but this time not due to destruction of the Gulf oil fields, but with pretext of manufactured weapons to build a coalition for regime change and occupation.  John Howard was in power for 11 years, long enough to bring me into my teens. As far as I knew, smiling jingoism and cynical geopolitical calculus <em>was</em> one way for a head of state to keep power. What held sway was the simulation of success, and the <a href="https://millercenter.org/americas-war-in-iraq/mission-accomplished-moment"><em>projection</em> of victory</a> in foreign policy. Nevertheless for the Anglosphere living standards were rising, it was an era of relative prosperity and Fukuyamaâ€™s â€œend of historyâ€ appeared vindicated as the endpoint of ideological rifts in human governance.</p>

<p>Compared to the famous protest songs of the 70s, there felt like a dearth of grassroots protest songs reaching mass broadcast during the Second Gulf War. There are no synths on American Idiot, straight pop-punk rock and <a href="https://youtu.be/r00ikilDxW4?si=84gWBNzAgYLY6Wvh">heavy use of a pitch correction</a> technology <a href="https://www.businessinsider.com/auto-tune-developed-by-oil-engineer-2014-7">originating in the oil industry</a>. US radio charts remained similarly silent on the ancillary Middle Eastern wars, though Brian Williams dropped a Leonard Cohen reference about the guiding <a href="https://youtu.be/DrADbquuMb4?si=0RndBZy2hpTSTtFo">beauty of their weapons</a> watching the missiles used against the Assad regime in Syria. Bill Bailey pointed out that the BBC broadcast tune had the <a href="https://youtu.be/vc9xLvrV_Zw?si=S3UYhHqrHkv2AyKr">hallmarks of an apocalyptic dance track</a>.</p>

<p>While the radios felt muted, from the perspective of an Australian child The War on Terror was remote, dispersed, and silent. In the US no air raid sirens provided warning and there was no shelter to take. Instead, a Homeland Security colour scale was used to assess the current terror threat level. Throughout the entire decade it sat in the warm colours; never dropping to â€˜general riskâ€™ (<em>blue</em>) or â€˜low riskâ€™ (<em>green</em>). It hit <em>red</em> (â€˜severe riskâ€™) once during actionable insights to UKâ†”US flight threats, raised to <em>orange</em> (â€˜high riskâ€™) five times outside of NYC in 2003. Otherwise it remained at a constantly ominous <em>yellow</em> (â€˜elevated riskâ€™) until replaced by a new system in 2011. In fact, it was recommended to remove the low risk tiers altogether, setting the alert constantly on â€˜guardedâ€™ without reworking the classification criteria. Luckily, civil servants pushed back on <a href="https://web.archive.org/web/20130419031645/https://www.google.com/hostednews/afp/article/ALeqM5h1W_dkUJZmLCnpf-AJQwNa0N-ptg">raising the â€˜guardedâ€™ threat level on the eve of an election</a> due to opportunistic political ramifications.</p>

<p>This created the conditions where the world lived under the constant drone of anxiety, never knowing where it would strike next. Swiftly to follow were legal memoranda <a href="https://en.wikipedia.org/wiki/Patriot_Act">massively expanding surveillance activities</a>, making <a href="https://en.wikipedia.org/wiki/Torture_Memos">â€˜enhanced interrogationâ€™ legally permissible</a>, giving the president significant executive authority over the <a href="https://www.dhs.gov/homeland-security-act-2002">largest federal internal security organisation created since the end of WWII</a>, and unilateral engagement in overseas conflicts by the executive without going through Congress or the <a href="https://en.wikipedia.org/wiki/War_Powers_Resolution">War Powers Act</a> by not formally declaring war. Because after all, <a href="https://youtu.be/RXUqJC3rXV0?si=ss5X714wTySJ41TW">wars end</a>. The worldâ€™s police had become the worldâ€™s SWAT team.</p>

<hr />

<blockquote>
  <p>Any musical innovation is full of danger to the whole State, and ought to be prohibitedâ€¦ when modes of music change, the fundamental laws of the State always change with them.</p>
</blockquote>

<p>â€” Plato, <em>The Republic</em> (Benjamin Jowettâ€™s translation)</p>

<h3 id="noise-as-a-resistance">Noise as a Resistance</h3>

<p>Even in eras when power feels absolute and alternatives seem erased, small acts of rebellion persisted â€” sometimes in music, sometimes in code, sometimes in the quiet persistence of niche communities. The 70s and 80s saw an independent music label scene rise and thrive (Rough Trade, 4AD, Factory Records). Some acts escaped the need for societal narrative by constructing tracks of pure sonic beauty, paying no heed to unintelligible lyrics â€” turning the <a href="https://youtu.be/6KnYw4EwYGc?si=D8C76mbWTDlrmYHw">human voice into another synthesizer</a>. Under austere conditions, others took punk music in rougher and more combative directions â€” or into new waveâ€™s more melodic and experimental protest (<em>e.g.</em> Devo).</p>

<p>This was a time that the official broadcasters would suffer the occasional subversive performance: such as <a href="https://youtu.be/eD_24nDzkeo?si=yk9AMf1ox-VP8iQz">Elvis Costello getting a â€œlifetimeâ€ ban from Saturday Night Live</a>; <a href="https://youtu.be/EfK-WX2pa8c?si=osOvS_wp2XYRTmOV">London Calling</a> was successful as a radio hit despite being politically charged, though other more clearly read songs faced the <a href="https://www.bbc.co.uk/programmes/articles/5R152hTbVPQdYjn29q5jt4/16-songs-banned-by-the-bbc">ire of BBC censors</a>; and <a href="https://youtu.be/q31WY0Aobro?si=2pajhGGpSqThZw3Q">Sex Pistols were banned from BBC airplay</a>, though some of Johnny Rottenâ€™s unbroadcast shocking and shock-factor banned content was <a href="https://youtu.be/v4OzI9GYag0?si=NCC8ita85r6Ebqcd">vindicated</a> in the 2010s.</p>

<p>The dissolution of this noisy resistance movement resulted in underground and invisible pockets:</p>
<ul>
  <li>Independent distribution models couldnâ€™t scale up to keep up with major label infrastructure.</li>
  <li>Mergers of independents into majors; Rough Trade and 4AD survive as Beggars Group label holdings.</li>
  <li>MTV became the commercial gatekeepers, you couldnâ€™t just sound good you needed to look good doing it.</li>
  <li>Music piracy eroded record profitability, forcing reliance on touring and stadium-sized ticket sale boons.</li>
  <li>Internet distribution meant the obscure found its audience, but keeps communities small and fragmented.</li>
</ul>

<p>Some notes, originally startling, hang around for decades. Deliaâ€™s life has been frequently revisited; biofictionalised in <em>Delia Derbyshire: The Myths and the Legendary Tapes</em>, produced for BBC broadcast. Written, produced by, and starring a British TV actor, it was obsessively scored by an Industrial music pioneer. Itâ€™s available to stream <a href="https://www.bbc.co.uk/programmes/m000w6tr">by those subject to the license fee</a>, while if you want to <em>hear</em> it you can buy a <a href="https://www.discogs.com/release/24542615-Cosey-Fanni-Tutti-Delia-Derbyshire-The-Myths-And-The-Legendary-Tapes-Original-Soundtrack-Recordings">vinyl from <em>Conspiracy International</em></a> any non-British viewers needed to have caught it at a film festival or start up an <a href="https://mubi.com/en/au/films/delia-derbyshire-the-myths-and-legendary-tapes">arthouse flicks subscription</a>. The biopic on synthetic sound did not leave behind a physical imprint.</p>

<hr />

<h3 id="digital-palimpsests">Digital Palimpsests</h3>

<p>The digital audio workstation (DAW) <a href="https://www.musicradar.com/news/daphne-oram-oramics-daw">evolved from early synthesis machines</a>, and now provides a near-infinite collection of sound banks and samples, as long as the origin sound was generated somewhere, somehow. This sonic resampling is now an invisible part of our audio lives, and teasing apart the layers of historical referentiality has now become a cultural game. Later generations growing up with samplers during childhood could even build the skeleton of hits of the 2000s around the <a href="https://www.whosampled.com/sample/155470/Klaxons-Atlantis-to-Interzone-Yamaha-DJ-Voice/">vocal</a> <a href="https://www.whosampled.com/sample/1121560/alt-J-Intro-Yamaha-DJ-Voice/">sample banks</a> of <a href="https://youtu.be/JUPvKIjqx-M?si=QEJu8sGficwd-74h">consumer</a> <a href="https://youtu.be/GOJUNJ1o394?si=nCAIwMyuajuLibcz">keyboards</a>.</p>

<p>Ainâ€™t it funny how Deliaâ€™s <a href="https://youtu.be/jpdiMcEeTJA?si=gtoC47FIZ5K6xdaa">meat-and-veggies synth experiments</a> re-emerged as a sample on both one of the <a href="https://www.whosampled.com/sample/331068/Freddie-Gibbs-Madlib-Real-Delia-Derbyshire-Pot-Au-Feu/">most gritty rap albums of 2014</a> and <a href="https://www.whosampled.com/sample/433441/Danny-Brown-When-It-Rain-Delia-Derbyshire-Pot-Au-Feu/">2016â€™s most lauded experimental hip-hop album</a>? Wendy Carlosâ€™ synth re-interpretations of classical pieces similarly litter legendary producer J Dillaâ€™s records that invigorated the genre. Raymond Scott, endless inventor of early electronica, has his sound form the retro groove of <a href="https://youtu.be/Bul7m3jN25Q?si=bHDrAjJ6kcDHRDer">â€˜Lightworksâ€™</a>. Such sonic overlaying is no accident, itâ€™s the very origins of hip-hopâ€™s Disc Jockey culture, and continued source of fun in crate digging at a record fair. For some acts the sampling escaped simply recutting music â€” all media was fair game, rerecorded and repurposed as the <a href="https://bocpages.org/wiki/List_of_samples_used_by_Boards_of_Canada">entire bedrock of the music</a>. The sounds of our civic life saw ephemeral reappearance, as fragments of broadcasts, childrenâ€™s programming, documentaries and incidental music became lo-fi beats to chill to.</p>

<p>The reverberations of early synth warbles are reproduced into 90s computing culture â€”  the <a href="https://youtu.be/8jjT4AjTUMA?si=IyUeTVKZ7Or9moO9">slightly surreal Windows 95 start-up sound</a> is an accompaniment to one of the <a href="https://www.bbc.com/audio/play/w3ct5yfs">biggest corporate computing launches in tech history</a>. Brian Eno, widely credited as crystallising the ambient music genre, had provided a synthetic sting heard every time a Personal Computer booted. This unnatural chime arrived as introduction to the Information Age. The American public were about to be <a href="https://web.archive.org/web/20120824202929/http://pewinternet.org/Static-Pages/Trend-Data-%28Adults%29/Internet-Adoption.aspx">connected to everyone on the information super highway</a> when a â€œcarpet bombingâ€ campaign of free CDs (nearing half of CDs manufactured worldwide) brought <a href="https://americanhistory.si.edu/collections/object/nmah_1395721">America Online</a>.</p>

<p>Now, niche genres of sample music proliferate and fragment on popular platforms, such as the literalist <a href="https://pcmusic.info/">PC music</a> (a movement that hit a knockout with a <span style="color:#8ACE00">brat</span> summer), Synthwave nostalgically remixing 80s synth, shortly thereafter Vaporwave spoofing and reveling in internet consumerism, and even <a href="https://youtu.be/6QOUNvMX-ws?si=wedkE2cE4AJ-LfFu">Utopian Scholastic</a> mining the nostalgic sound of the optimism of the civic educational project. Now with featureful web browsers and distributed networking you can run a synth jam with strangers <a href="https://nudel.cc/">entirely in your browser</a>.</p>

<hr />

<p>Computers used to be physical monoliths. They <a href="/images/csirac.jpg">filled entire rooms</a>, took teams of people punching cards to operate them, and their commissioning was a matter of national priority and pride. See: <a href="https://almanac.upenn.edu/archive/v42/n18/eniac.html">ENIAC</a> [US], <a href="https://www.whipplemuseum.cam.ac.uk/explore-whipple-collections/calculating-devices/edsac-and-computing-cambridge">EDSAC</a> [UK], <a href="https://cacm.acm.org/blogcacm/the-mesm-ukraine-beats-russia/">MESM</a> [USSR], <a href="https://cis.unimelb.edu.au/about/history/csirac">CSIRAC</a> [AU], <a href="https://www.wisdom.weizmann.ac.il/~www/pages/milestones/1954.html">WEIZAC</a> [IL], <a href="https://museum.ipsj.or.jp/en/computer/dawn/0021.html">TAC</a> [JP], <em>etc</em>â€¦</p>

<p>These national behemoths did not dominate for long. Computer luminaries like <a href="https://archive.computerhistory.org/resources/text/Oral_History/Hopper_Grace/102702026.05.01.pdf">Grace Hopper advocated for systems involving smaller, distributed computing machines</a>. Information exchange and data sharing was cracked wide open by computer networking; pioneered at the ARPA and RAND agencies, with Stanford and UCLA the first nodes joined together in 1969 to grow into the <a href="https://en.wikipedia.org/wiki/File:Arpanet_logical_map,_march_1977.png">US-wide ARPANET in the 1970s</a>. By the 1980s <a href="https://www.podc.org/">symposia on distributed computing</a> were held and <a href="https://lovetechai.com/history-of-lan/">Local Area Networks</a> began to spring up. But the Internet of the World Wide Web as we know it was only formed in the 90s, built upon a common communication protocol (TCP/IP) and the hypertext system of linked information <a href="https://info.cern.ch/hypertext/WWW/History.html">proposed at the worldâ€™s largest particle physics institute</a>, the <a href="https://www.w3.org/People/Berners-Lee/WorldWideWeb.html"><em>WorldWideWeb</em></a> browser developed to surf the â€˜net, and from the mid-90s onwards the â€œbrowser warsâ€ <a href="https://youtu.be/Hdit5-yFHI8?si=YU_D1uUt8_7J4z6o">saw software vie for market share</a>.</p>

<p>This enabled distributed communication at a then-astounding scale, but what about distributing <em>computing power itself</em>?</p>

<p>While the <code class="language-plaintext highlighter-rouge">.com</code> commercial web was centralising around Internet Service Providers and browser portals, another model was emerging on university campuses.</p>

<h3 id="federation-returns">Federation Returns</h3>

<p>The worldâ€™s premier engineering institute was hampered by a lack of computers available for their courses. Mainframes had been available on campus for decades, in fact the first computer to use <a href="https://mitmuseum.mit.edu/collections/object/2000.006.001">magnetic core memory</a> had been developed on site for the US Navy. But there was a dire need to modernise computing access outside of specialised systems intended for operation by computer engineers and timeshared to grant holders.</p>

<p><a href="https://news.mit.edu/2018/mit-looking-back-project-athena-distributed-computing-for-students-1111">Project Athena was launched at MIT</a> in 1983 to the tune of $100 million dollars, the largest ever undertaken. The computing transformation at MIT was done in collaboration with the two titans of the computer industry IBM (International Business Machines) and DEC (Digital Equipment corporation) who supplied hundreds to thousands of terminals, microcomputers, and workstations.</p>

<p>The model was this: users interfaced with easy to set up <code class="language-plaintext highlighter-rouge">clients</code> (terminals, workstations) which communicated to powerful clustered computing <code class="language-plaintext highlighter-rouge">servers</code> that did the operation-crunching for their requests. In this way a campus-wide network of computers could be deployed to meet the needs in each faculty. Unix was used as the operating system for this distributed computing network, and MIT put effort into designing their system to be vendor-agnostic, so they werenâ€™t locked in to either IBM or DECâ€™s hardware compatibilities. One way this was achieved was through <code class="language-plaintext highlighter-rouge">thin clients</code>: the workstation didnâ€™t need to provide the computing power itself, acting only as a consistent interface to a wider variety of computing hardware on the back end. This Athenian league of federated academic computing environments can still be found in use at <a href="https://ist.mit.edu/athena">MITâ€™s Information Systems &amp; Technology website</a>.</p>

<p>Project Athena influence not only help cement the foundations of <code class="language-plaintext highlighter-rouge">client-server</code> distributed computing architecture we all use today, but also brought with it many innovations:</p>
<ul>
  <li>The Kerberos (AKA Cerberus) authentication protocol â€” the default method of securing corporate computer networks from Windows 2000 onwards.</li>
  <li>The Unix framework for remote graphical user interfaces (the â€˜X Window Systemâ€™)</li>
  <li>One of the first internet protocol Instant Messaging (IM) services</li>
  <li>A <em>public</em> campus-wide Bulletin Board System (BBS)</li>
  <li>Online computer help (reminiscent of the modern helpdesk)</li>
</ul>

<p>MIT, IBM, and DEC <a href="https://dl.acm.org/doi/10.1145/4547.4553">reflected on the impacts of Project Athena partway through</a>, but perhaps the greatest marker of the achievements of Project Athena was its successful wider spread.</p>

<blockquote>
  <p>â€œI felt that we would know Athena was successful if we were surprised by some of the applications. It turned out that our surprises were largely in the humanities.â€</p>
</blockquote>

<p>â€” Dr Joel Moses, then head of the Electrical Engineering &amp; Computer Science (EECS)</p>

<p>Distributed computing took rapid foothold outside of MIT by the early 90s because it was <em>useful</em>. Several US and some international campuses started using an implementation (DECathena, now <a href="https://debathena.mit.edu/">Debathena</a>), though inevitably the protocols and hardware implementations changed with the frenetic obsolescence pace of the computing industry. The impact was conceptual; the model was no longer the monolith â€œsupercomputerâ€, but instead users work at domestic <code class="language-plaintext highlighter-rouge">clients</code> accessing distributed <code class="language-plaintext highlighter-rouge">servers</code> (nowdays often a â€œ<a href="https://spinoff.nasa.gov/Spinoff2020/it_1.html">Beowulf cluster</a>â€ of commodity computing parts). Computing was now non-local and the arc of the attendant technological implications leads to virtual desktops, enterprise computing, cloud computing, and modern web services.</p>

<hr />

<p>The internet was constituted from the elite organisations of the US academic-military complex, establishing institutional resilience and decentralisation during the Cold War. Civic use followed not long after. Web 1.0 was formed from static sites of inter-linked pages of thousands of little â€œgeo-citiesâ€ dotted as islands in cyberspace. To transmit their own autonomous content, everyone bore their cost and acquired the skills to host, spreading knowledge through  word-of-mouth and announcements on the public fora. It was useful as a reference, but not as much as a means of mass expression or a way to go viral. And despite dotcom hype, most Web 1.0 sites <a href="https://www.investopedia.com/ask/answers/08/dotcom-pets-dot-com.asp">werenâ€™t making money</a>. Only a handful of tech companies survived the crash, able to build empires from the rubble. But the connectivity remained: cables stayed buried, network switches kept routing packets, even as the companies that installed them went insolvent. The physical network of the internet endured, but the governance model was about to change as people opted-in to seamless communication through centralisation.</p>

<p>Web 2.0 offered convenience and security in placing your expression online. In the knowledge economy, stable corporations provided a way to protect travellers and the marketplace from cyberattacks. Anyone could become a netizen, and did. In the Information Age the worldâ€™s accumulated knowledge was at <em>everyoneâ€™s</em> fingertips. Scholastic output was no longer isolated to ivory tower islands or curated in slow moving encyclopÃ¦dias. Anyone could share their information, and didnâ€™t have to speak the language of the technical tribe to gain entry. The global <em>polis</em> <a href="https://www.wikipedia.org/">even assembles its own encyclopedia</a>.</p>

<p>The content also became more interactive and engaging. A massive connectivity, and <a href="https://youtu.be/hnEun07xEUU?si=XM0jLw-WgbKNK3ae">we were not ready</a>. Ultimately a web pageâ€™s dynamic nature meant it could adapt to the needs <em>of each citizen that visited it</em>. Your niches, your communities, your interests all found you as much as you found them. You didnâ€™t just make content, you had a â€˜feedâ€™, you were <em>fed</em> it. The network was no longer a fibreoptic one; the network was <em><a href="https://letterboxd.com/film/the-social-network/">social</a></em>. This too started in US elite institutions and spread. These network effects were built at a loss in their first years, the market would follow the people. Sometimes, the profit came from enabling genuine connections fostering specialisation and trade; markets made locally or international through human connection. The worldâ€™s information made convenient, organised, radically accessible. Seamless services in busy lives.</p>

<p>Othertimes, the connection portal <em>was</em> the profit. Slowly but surely voluntary social participation came to hold our cherished social information and memories hostage to lock-in. Attention economy user data became the tribute harvested to fill consumer markets. Not tallied in stone, but invisible extraction behind addictive UX and frictionless interfaces.</p>

<blockquote>
  <p>If youâ€™re not paying, youâ€™re the product</p>
</blockquote>

<p>â€” Tim Oâ€™Reilly by way of Andres Lewis from Richard Serra &amp; Carlota Schoolman</p>

<p>Enabling the rollout to billions was the Cloud. Our devices were all still clients to servers, but rather than fixed physical assetsâ€”requiring distributed skills and maintenance crewsâ€”servers themselves were now <em>software</em>. On-demand, scalable, and far more cost efficient for small engagements than dedicated infra, the capital was invested in hyperscalers and their data centres. As much compute power as you could pay for was available to <em>everyone</em>: public, private, research. In tech, distance collapsed behind an API call. Tech giants that survived the dotcom crash now fund pioneering fundamental computing and science research divisions, much like Bell Labs had done in the telecom era. Several of their developments in the ecosystem and breakthroughs became open source, many massive investment projects remain proprietary. In an interesting data model, some biotech and pharma companies have partnered with open source projects <a href="https://www.apheris.com/resources/blog/advancing-protein-prediction-with-federated-learning-on-nvidia-dgx-cloud">to provide federated training data</a>. This allows corporate datasets to go into the fundamental open source tools, without publishing proprietary data outside the organisationâ€™s storage infrastructure.</p>

<p>Web 3.0 offers the promise of a new era of federation, bypassing intermediaries. The technical federation mechanisms are there (distributed ledgers, decentralised applications, non-fungible assets) but so far it seems the federated governance models have not kept up. The â€˜Magic: The Gathering Online eXchangeâ€™ cryptocurrency exchange (Mt. Gox for respectability) was <a href="https://trakx.io/resources/insights/the-mt-gox-hack-story-explained/">hacked</a>, demonstrating a secure currency doesnâ€™t mean security of the treasury trading it. Many retreated to centralised exchanges to mediate the decentralised ledger. The treasury after all could still just be stolen, as was the case with the spectacular downfall of FTX where a <a href="https://www.theblock.co/post/255352/ftx-used-random-numbers-to-generate-the-size-of-its-insurance-fund">lack of insurance fund reserves</a> could be obscured by a <a href="https://www.citationneeded.news/the-fraud-was-in-the-code/"><code class="language-plaintext highlighter-rouge">numpy.random()</code> number</a> hidden behind the interface.  I havenâ€™t followed the development of Web 3.0 closely, but its main mode appears to be distributed proof of <em>ownership</em>: energy intensive proof-of-work (now dramatically less intensive proof-of-stake) to calculate not productive work,  but stake a claim. Regardless of the promise held in this decentralised new internet, I hear, currently, <a href="https://www.web3isgoinggreat.com/">Web3 is going just great</a>.</p>

<p>Some civic projects began with the federation of civic life as their core aim. The â€˜Fediverseâ€™, enabled by the open standards of the ActivityPub (<em>e.g.</em> Mastodon) and AT Protocol (<em>i.e.</em> Bluesky) are live and <a href="https://news.ycombinator.com/item?id=39274882">open to the public</a> to interface with. Federation is still not without friction or governance debates, when signing on to an instance you need to decide what â€˜tribeâ€™ you belong to. The digital geo-cities have returned but with WorldWideWeb backing and Web 2.0 user-friendly improvements. Federation keeps your data in the open, but mediated by an interest group paying the hosting costs, not a monolith covering the cost through market creation. The reach, compared to a forum of the world, is rarely the same. Your data is <em>more</em> your own, and interoperability a key protocol focus, but migrating to a different city-state comes with transmission barriers.</p>

<hr />

<p>While the commercial world was migrating to centres for horizontal scale-out, right-sized services, and virtualised infrastructure, the campus and research computing market pursued a different model with different compute resourcing demands. A fascinating experiment was distributed computing that served scientific inquiry <em>without</em> being located on a single premises at all, harnessing instead the vast untapped power of domestic commercial computing sitting idle when not used by its individual owner.</p>

<p><a href="https://setiathome.berkeley.edu/">SETI@home</a> (released 1999, defunct 2021) was an experiment in crowdsourcing compute power to analyse cosmic radiowaves to search for signals from life beyond earth. Backed by the University of California at Berkeley, the scale of compute power contributed was immense â€” 5.2 million volunteers, a zetta-FLOP (10<sup>21</sup>) of cumulative calculation power expended by 2001. The largest computational campaign in history. It would have staggered John Pawsey &amp; Ruby Payne-Scott. Astrophysics didnâ€™t get all the fun. <a href="https://foldingathome.org/">Folding@home</a> was released in 2000 and continues to receive updates, providing one of the only ways of covering the cost burden of simulating the atomic-scale folding process of proteins that mediate biology and disease; something inaccessible to AlphaFold-style methods that are trained to predict stably folded structures. The scale, again, is staggering. During the COVID-19 pandemic as citizen and institutional compute resources alike pitched in available calculation cycles, <a href="https://foldingathome.org/2020/07/26/citizen-scientists-create-an-exascale-computer-to-combat-covid-19/">Folding@home broke the exa-scale calculation speed barrier before any singular supercomputer</a>. Almost a decade after initial launch, both these citizen science compute projects would find extra power from the consumer entertainment market, ported to the Playstation 3 to harness the latent power of its unique Cell Engine.</p>

<p>The democratisation of computing power had outpaced the democratisation of the knowledge it produced, even in the Information Age. While citizens were defraying the compute cost of science, the research transmission models didnâ€™t necessarily keep up. Commercial publishers of publicly funded research have responded to the governance change demands of Open Access like <a href="https://www.coalition-s.org/">â€˜Plan Sâ€™</a> by changing their product model. Beyond supporting the hosting cost and editorial quality control &amp; coordination, the processing fee now differentiates a PDF hosted on the arÏ‡iv from a publishing site by the prestige token of the journal imprint vouching for impact.</p>

<p>Computing monoliths still serve stable infrastructure for megascale projects; timeshared among states and countries at the â€˜Tier-0â€™ supercomputers hosted by the megapowers on the continents of the Global North. Scheduling the monolithic computing workload may also be becoming federated. As the largest hardware vendor by market capitalisation <a href="https://blogs.nvidia.com/blog/nvidia-acquires-schedmd/">buys in to support tighter integration</a> with the most widely distributed open-source workload manager, a next generation scheduler is built at a supercomputing juggernaut. <a href="https://computing.llnl.gov/projects/flux-building-framework-resource-management">Flux</a> provides nested and flexible hierarchy of resource management, <a href="https://flux-framework.readthedocs.io/en/latest/faqs.html?h=site#where-does-flux-work">with aspirations to enable converged computing</a> where compute workloads can be shared <em>inter</em>-cluster, inter-site, and between local compute and the cloud. Distributed governance persists in scientific projects too, cascading down the tiers to experimental local deployments, where someone may be doing the digital equivalent of running a tape loop along the longest corridor in town.</p>

<hr />

<p>Now, we have gargantuan data centres. Ingesting <em>exa</em>bytes of data from the collective voice of the internet. Undergoing intense language-on-language training campaigns to generate models that convincingly emulate the ability to think by statistically sampling massive context. These get widely released, some centralised to a particular company, some distributed, and become almost trivial to run as the power draw efficiency per inference response dramatically improves and AI chips balloon in capability. The <a href="https://en.wikipedia.org/wiki/Multivac">Multivac</a> era of omniscient (though oft-times hallucinatory) district-sized supercomputers appears to have arrived. Will the power remain in the centre, or will it federate while it spreads out to embed as intermediary of societal interactions?</p>

<hr />

<h3 id="the-owl-of-minerva-">The Owl of Minerva ğŸ¦‰</h3>

<p>Wisdom takes flight only at dusk, often when itâ€™s too late.</p>

<p>Why is there a tendency to collapse into tributary systems until thereâ€™s a technological or social systemic shock?
Do lost futures only become visible when an era has already passed, or because they only become visible in the murky twilight?</p>

<p>Now, talking with the ghosts of our civic memory has become the â€˜killer appâ€™ of our era.</p>

<p>Technology shock permeates quickly, but has financial incentives to be harnessed by status quo power structures. Just because distributed information systems are easier to implement than ever doesnâ€™t mean weâ€™re guaranteed a future not held by a few monoliths. Centralisation allows for seamlessness at scale. The Parthenon, cultural splendour, and famous thought of Athens we still admire in history, was built and protected by distributed tribute. When power projection moved slowly, the civic world made gods of the rulers of kingdoms. Even now those structures are social and can be chosen deliberately; a new type of economic elect in an era where information, goods exchange, and coordination systems can span the world in an instant.</p>

<p>Yet the alternatives keep emerging â€” Athena <em>polias</em> persists, new federations form. The twilight offers a moment to breathe, to choose alternate futures.
Letâ€™s hope social coordination and civic productivity can free up our future, one not driven to mass unrest or conflict as its remaining system shock mechanism.</p>

<hr />

<p><em>I found the fragrance separate from the flower. In all the logic, I was lost.</em></p>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="writing" /><category term="Delia" /><category term="Derbyshire" /><category term="Lycians" /><category term="imperialism" /><category term="federalism" /><category term="hauntology" /><category term="synths" /><category term="BBC" /><category term="computing" /><category term="Athens" /><category term="federation" /><summary type="html"><![CDATA[ğŸ“– 30 min read â€¢ personal exploration in the vein of the 33â…“ music books, inspired by naming resonances --- not professional commentary.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/images/delia_derbyshire.jpg" /><media:content medium="image" url="http://localhost:4000/images/delia_derbyshire.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">From Muck to Mauve: the creation of modern dyes from coal tar</title><link href="http://localhost:4000/dyes/2025-11-05-aniline-and-the-german-chemical-industry/" rel="alternate" type="text/html" title="From Muck to Mauve: the creation of modern dyes from coal tar" /><published>2025-11-05T00:00:00+11:00</published><updated>2025-11-05T00:00:00+11:00</updated><id>http://localhost:4000/dyes/aniline-and-the-german-chemical-industry</id><content type="html" xml:base="http://localhost:4000/dyes/2025-11-05-aniline-and-the-german-chemical-industry/"><![CDATA[<p class="figcaption"><em>Photo credit: James St. John. <a href="https://www.flickr.com/photos/47445767@N05/50656174972/">Flickr</a> [CC BY 2.0]</em></p>

<blockquote>
  <p>Content notice: this post discusses the early dye companies of industrialised pre-WWI Germany that were at one point put to horrific wartime use. World War II is alluded to in a literary work that was famously denied a Pulitzer prize in part because of its confronting content.</p>
</blockquote>

<p><em>In this post Iâ€™m aiming to give a broad-brush overview of how the near-infinite array of colours we see in textiles today were wrought from some of the most murky carbon substances known. This post will focus on</em> <span style="color:rebeccapurple">purple</span> (specifically, <span style="color:#8D029B">mauveine</span>) <em>but will meander through the history and chemistry of the blue hues.</em></p>

<p><em>Iâ€™d like to write more on specific dyes in the future because they have so many fascinating chemical properties. For example,</em> <span style="color:indigo">indigo</span> <em>forms from a dimer using the indole group common in biochemistry, placing it within striking distance of tryptophan (amino acid \(W\)) in the biosynthetic pathway.</em></p>

<p><img src="/images/indole_metabolism_in_plants.png" alt="Indigo biosynthesis in plants" class="lead" width="609" height="364" loading="lazy" /></p>

<p class="figcaption">Indigo is made from joining two slightly modified indole molecules. Indole is such a common structure in biology that it is used to make tryptophan, one of the 20 standard amino acids, which can reveal protein folding properties through fluorescence. â€”Synthesis diagram from <em>Plant Cell Reports</em>, <strong>2016</strong>, 35, <a href="https://doi.org/10.1007/s00299-016-2046-3">2449â€“2459</a>.</p>

<p><em>The development of dyes used to be covered in a (rarely taught) NSW syllabus option, â€œChemistry of Artâ€, that touched on everything from indigenous ochres to transition metal pigments and atomic spectroscopy, but is sadly now gone.</em></p>

<p><em>For those interested in colour more generally, I can recommend</em> <a href="https://www.kassiastclair.com/books">â€œThe Secret Lives of Colourâ€</a><em>. Its chapters are arranged by colour, making it addictively easy to pick up and dive into each hue. I also recommend</em> <a href="https://www.rca.ac.uk/more/staff/neil-parkinson/">â€œThe History of Colourâ€</a> <em>for an academic history of the conception of colour â€” Chapter 2 starts with synthetic purple and details the explosion in commercially valuable tints that followed. If the development of industrial dyes interests you, BASF have an account of their history <a href="https://www.basf.com/global/en/who-we-are/history/chronology/1865-1901.html">on their website</a> including the â€œ<a href="https://www.basf.com/dam/jcr:83bc219e-0800-3c1b-bb2c-d682491a3195/basf/www/global/images/about-us/history/21252221_BRO_Anilinerinnen_englisch_final.pdf">Aniline Women</a>â€ who worked there.</em></p>

<p><em>Some correspondence by scientists picturing this new cyclical chemical reality is contained in</em> <a href="https://press.uchicago.edu/ucp/books/book/chicago/I/bo8434945.html">â€œImage and Reality: KekulÃ©, Kopp, and the Scientific Imaginationâ€</a> <em>, providing primary sources around the murky question of whether he actually dreamed the snake.</em> Image and Reality <em>gives interesting rapid recount into the depictional development of atomic theory, including the radically clear-eyed early experimental proof by Alexander Williamson who provided, using etherification reactions, his pictorial theory of</em> â€œan actual image of what we rationally suppose to be the arrangement of constituent atoms in a compoundâ€.</p>

<p><em>Williamsonâ€™s visual foresight gave a hazy glimpse at perceiving how constant molecular motion created reactivity, and many other scientists saw farther than the peers of their day by picturing the non-empirical.</em></p>

<hr />

<h3 id="pauvre-mauve-">Pauvre mauve ğŸª»</h3>

<p>Thereâ€™s an abundance of green in the natural world (likely because plant chlorophyll is <a href="https://www.quantamagazine.org/why-are-plants-green-to-reduce-the-noise-in-photosynthesis-20200730/">tuned for reliable photosynthesis</a>), but blues and purples stick out because they are so <a href="https://set.adelaide.edu.au/news/list/2019/08/20/why-is-the-colour-blue-so-rare-in-nature">rare in nature</a>. Maybe thatâ€™s why blue is <a href="https://au.yougov.com/international/articles/12336-why-blue-worlds-favorite-color-1">humanityâ€™s favourite colour</a>. The rare examples of natural blue are unusual â€” bird and butterfly wings have to resort to optical trickery (metamaterials); blueberries get their name and antioxidant health craze because their skin is packed with the crop pigment <a href="https://en.wikipedia.org/wiki/Anthocyanin">anthocyanin</a>; the blue warning signal of the poison dart frog doesnâ€™t arise from its toxin (pumiliotoxin), but <a href="https://doi.org/10.1002/ece3.11438">comes from skin iridophore cells</a> containing <a href="https://doi.org/10.1038/s41467-020-20088-1">stacks of reflective guanine platelets</a>; and lobsters change spectacularly from blue to red upon boiling due to heat denaturing their <a href="https://doi.org/10.1002/anie.201501609">crustacyanin</a>.</p>

<p><img src="/images/anthocyanidine_320-228.png" alt="Anthocyanin skeleton" style="display:block; margin-left:auto; margin-right:auto" /></p>

<p class="figcaption">Almost all natural pigments in the blue end of the spectrum (and others) are pigments built from the anthocyanidin skeleton shown above. â€”<em>Wikimedia Commons</em>, <a href="https://commons.wikimedia.org/wiki/File:Anthocyanidine.svg">NEUROtiker, 5 August 2008</a>.</p>

<p>Similarly, thereâ€™s an almost complete absence of natural purple. Purple cabbage and eggplant contain the same anthocyanins as blueberries, similarly for violetâ€™s flowers whose colour may be striking but is not colourfast when used to dye fabric. So, when nature was our only source of chemicals, peopleâ€™s desire to wear the spectrum of â€˜coolâ€™ colours was met by crushing the leaves of the somewhat drab <span style="color:#7B99B0">woad,</span> and the perennially popular <span style="color:indigo">indigo</span> â€” the name given to both the plant and one of Newtonâ€™s seven â€˜ROYGB<span style="color:indigo">I</span>Vâ€™ colours partitioning the rainbow.</p>

<p>The only concentrated, colourfast sources of organic purple come from the seas. <em>Aplysia</em> sea slugs <a href="https://youtu.be/qmn1bpz00qA?si=ajvqjlsCp7IaI25-">spray purple</a> aplysioviolin molecules when threatened. Sea hares build this ink up in their glands by eating red algae; stripping the colourant molecule from the algaeâ€™s light harvesting proteins and concentrating an aplysioviolin derivative. A painstaking, but more reliable, way to obtain natural purple is to extract ink glands from the <em>Murex</em> sea snail. The â€˜Tyrian purpleâ€™ dye harvested from these snail glands was, and is, <a href="https://youtu.be/IVXqisH6VeM?si=mRh5GDGBscIPJDDH">outrageously expensive</a>, fetching around $3,000 USD/g in the 21st century. Tyrian purple is in fact a brominated derivative of indigo, synthesised using a bromoperoxidase enzyme unique to <em>Murex</em>. Scientists still have not confirmed the active metal within the <em>Murex</em>â€™s bromoperoxidase enzyme (most bromoperoxidases use the rare vanadium), or which gene in the sea snail encodes for this purple producing enzyme.</p>

<h3 id="lapis-lazuli-and-other-blues-of-value-">Lapis lazuli and other blues of value ğŸ”µ</h3>

<p>For making paints and dyes, even the colour diversity found within the minerals of the Earth was of little help; the naturally occurring mineral pigments are prone to dull hues, rapid fading, and discolouration into green (<em>e.g.</em> azurite). Synthetic mineral blue dyes were created in ancient times from copper silicates (mixed with calcium - â€œEgyptian Blueâ€, or barium - â€œHan Blue &amp; Purpleâ€), or otherwise just from indigo â€˜baked intoâ€™ a mineral substrate, as detailed in a <em>Chemical Society Reviews</em> article on <a href="https://doi.org/10.1039/B606268G">â€œThe invention of blue and purple pigments in ancient timesâ€</a>. However, Han Purple did not provide a pure purple, its appearance was due to red copper oxide impurities. Similarly, pure, brilliant blue mineral pigment was only provided by eye-wateringly expensive lapis lazuli (ultramarine), mined only around the mountains on the North-Eastern tip of Afghanistan. Ultramarine would cost up to 100x other pigments, but its dazzling effect was valued in religious iconography across Asia and Europe, and has notable use in famous paintings (<em>e.g.</em> the <a href="https://heritagesciencejournal.springeropen.com/articles/10.1186/s40494-020-00364-5">blue headscarf</a> in <em>Girl with a Pearl Earring</em>). Since mineral pigments and synthetics paled in comparison to â€œtrueâ€ ultramarine, lapis lazuli was in demand well into the 19th century. The physical origin of the intense blue appearance of ultramarine is chemically interesting: rather than a metal at the centre of the mineral, the colour comes instead from a negatively charged trisulfur radical (S\(_3^{\bullet-}\)).</p>

<p class="figcaption"><img src="/images/sodalite_S3_radical.png" alt="Sodalite S3 chromophore" style="display:block; margin-left:auto; margin-right:auto" />
The negatively charged trisulfur radical caged in a zeolite with its surrounding sodium ions. â€”<em>Chemical Society Reviews</em>, <strong>2013</strong>, 42, <a href="https://doi.org/10.1039/C3CS60119F">5996-6005</a> adapted from <em>Inorganic Chemistry</em> <strong>2002</strong>, 41, 11, <a href="https://doi.org/10.1021/ic010822c">2848â€“2854</a>.</p>

<p>Now with modern chemistry, blue hues can be created that are so striking that an artist can make a multi-million dollar name for themselves with <a href="https://www.invaluable.com/blog/yves-klein-blue/">one famous blue dye</a>, and scientific careers and reputations can be built upon chemistsâ€™ prowess to manufacture the <a href="https://www.huffpost.com/entry/quantum-blue-berkeley_n_5b8db0a4e4b0511db3db33a1">bluest blue</a>. The chemistry to produce commercially abundant purple dyes was however only cracked in the 19th century, and with it opened up new possibilities in organic synthesis. Even now, there is unplumbed depths to these cool hues: the colour terminology for purple and violet is murky, our <a href="https://jakubmarian.com/difference-between-violet-and-purple/">visual perception</a> strains near the UV wavelengths, and even the <a href="https://ericportis.com/posts/2024/okay-color-spaces/">colour range</a> of our computer monitors come up short.</p>

<h3 id="porphyrogeniture-">Porphyrogeniture ğŸ‘‘</h3>

<p>Purple has <a href="https://doi.org/10.1111/j.1747-4469.2008.00097.x">long signified royalty and power in the ancient world</a>, to the point that its use was restricted to high office; not just due to the expense of natural purple dye, but often enforced by social codes and law. Famously, Roman officials would colour their formal attire (togas) with a strip of purple along the border. This style, the <em>toga praetexta</em> (from Praetor, a magistrate position below Consul) wasnâ€™t solely restricted to appointed officials, but likely had a religious origin and was recorded as being worn by priests and <a href="https://www.jstor.org/stable/693055">pre-adolescent children of fortunate birth</a>. However, a toga fully clad in purple became restricted to Roman consuls and generals performing a Triumph, and later to the Emperor alone. Nero limited the use of purple to the imperial court, and the unsanctioned wearing of purple was even <a href="https://en.wikipedia.org/wiki/Codex_Theodosianus">codified as an offence punishable by death</a> by Theodosius II.</p>

<p>The association of the purple hue with royalty extended beyond clothing, and Byzantine (Eastern Roman) queens would give birth to future rulers in rooms decorated with a deep-purple Imperial Porphyry stone (from Ancient Greek <em>porphyra</em> â€” purple). This birthright to distinction through colour was enforced from cradle to grave, as <a href="https://www.pallasweb.com/deesis/imperial-porphyry-tombs.html">Emperors were buried in tombs made from porphyry</a>, some <a href="/images/porphyry_tomb.jpg">survive today outside the Archaeological Museum in Istanbul</a>. The purple name echoes throughout history, such as the sisters <a href="/images/zoe_porphyrogenita.jpg">Zoe</a> and Theodora Porphyrogenita who co-ruled the Byzantine Empire after a popular revolt.</p>

<h3 id="born-in-the-purple-">Born in the purple ğŸŸ£</h3>

<p>Ironically, despite the incredible rarity of steadfast purple in nature, purple was the first in a tidal wave of synthetic industrial dyes, bringing the colour to the masses and, as it goes with fads, becoming so commonplace as to be unfashionable quickly after reaching the mass market. The discovery of artificial purple dye (mauvine) was entirely accidental, but the chemical knowledge to synthesise it at massive scale required unravelling some of the fundamental mysteries in organic (carbon-based) chemistry; in the process clarifying how electrons create molecular structure and govern the interactions of dye molecules with light.</p>

<p>The first artificial purple dye was synthesised by William Henry Perkin in 1856 from an accidental side discovery. Perkinâ€™s motivation was not encolouration, but empire. What Perkin was searching for was a cheap synthetic route to quinine, an antimalarial substance isolated from cinchona tree bark, useful for stationing soldiers in colonies of the British Empire. Perkinâ€™s synthesis attempts were misguided from the start, having only the empirical formula of quinine (C\(_{20}\)H\(_{24}\)N\(_{2}\)O\(_{2}\)) and no idea of its structure, he explored combining two equivalents of an organic starting material whose masses would sum to the total atom count of quinine once oxygenated. In reality quinineâ€™s structure is quite complex and the quest to irrefutably create it from scratch kicked off <a href="https://en.wikipedia.org/wiki/Quinine_total_synthesis">150 years of investigation and controversy into its difficult total synthesis</a>. Incidentally, quinine is the source of <a href="/images/tonic_water_UV_Paul_Garland.jpg">tonic waterâ€™s ultraviolet glow under blacklight</a>.</p>

<p>What Perkin saw in his experiment was not emissions de-energised from the ultraviolet, but instead found that when diluting his failed synthesis product with alcohol during wash-up the solution turned purple. He opened up a dyeworks in Greenford the next year. The success of a synthetic dyes would lead to a <a href="https://www.jstor.org/stable/43427950">complete collapse of the economic harvesting of natural dyes such as madder root</a>.</p>

<p><img src="/images/perkins_mauve_sample.jpg" alt="Sample of Perkin's mauve aniline dye" style="display:block; margin-left:auto; margin-right:auto" /></p>

<p class="figcaption">Perkinâ€™s mauve was a runaway success but through its overuse in fashion it came to be see as tawdry. The use of the gaudy colour fell out of favour for everyday wear. â€”<em>Journal of the Society of Dyers and Colourists</em>, Nov. <strong>1906</strong>, <em>via</em> the <a href="https://digital.sciencehistory.org/works/o2sfuyr">Science History Institute</a> .</p>

<p>However, Perkinâ€™s happy discovery at 18 years old started from being encouraged to experiment with the idea of synthesising quinine  <a href="https://pubs.rsc.org/en/content/articlelanding/1896/ct/ct8966900596">by August Wilhelm von Hofmann while working as his assistant</a>. Perkin continued his experiments out of the lab, and in his own shed, in order to trial creating proper dyes and keep the profits. The raw organic feedstock to make these dyes became available at a commercial scale due to breakthroughs in organic synthesis and industrial processes to make flammable gas from coal tar. Though able to unlock amazing synthesis routes, Perkin, Hofmann and chemists were working on organic materials without knowing their true atomic connectivity. The substances they worked with were termed â€œaromaticâ€ compounds due to a few representatives having a strong smell (<em>e.g.</em> benzoin, in incense), but the molecular structure of these aromatics was a puzzle from only their empirical formulae and reactivities.</p>

<h3 id="muckraking-ï¸">Muckraking âš—ï¸</h3>
<p>Coal tarâ€™s shimmering opacity hides its chemical complexity. In the murky pitch black mixture are thousands of different hydrocarbon species, and until modern petroleum extraction they were <em>the</em> major feedstock to synthesise organic molecules. The stodgy goopâ€™s appearance obscures a mosaic of complex carbon skeletons, ripe to transform into a rainbow of complex organics furnished from chemical reactions. August Wilhelm von Hofmann was one of the pioneers in these experiments, considered by science historians to be one of the <a href="https://onlinelibrary.wiley.com/doi/epdf/10.1002/anie.199212653">â€œfathers of synthetic chemistryâ€</a>. He and Jamaican born chemist John Blyth were the first to use the term â€œsynthesisâ€ in a publication.</p>

<p>Hofmannâ€™s interest in coal tar can be seen by the title of his first publication in 1843 <a href="https://doi.org/10.1002/jlac.18430470106"><em>â€œChemische Untersuchung der organischen Basen im
Steinkohlen-Theeroelâ€</em></a> (â€œChemical Investigation of the Organic Bases in Coal-Tar Oilâ€). Hofmann was able to isolate both aniline (the basis for dyes â€” mauvine was also called â€œaniline purpleâ€) and quinoline (a degradation product of the quinine â€” Perkin was also interested in finding) from coal tar.</p>

<p>Experiments with coal tar and other organic synthesis projects were a productive foundation for Hofmann to build a research career on. The structure of Hofmannâ€™s lab is <a href="https://www.chemistryworld.com/features/hofmanns-chemistry-factory/3007787.article">seen as the precusor to the modern industrial chemistry research lab</a> and was a source of many discoveries, such as the <a href="https://doi.org/10.1039/QJ8490100244">isolation of benzene (then benzole)</a> by his British student Charles Mansfield. Additionally, Hofmann was the first to build physical ball-and-stick â€œglyptic formulaeâ€ models to display an object to embody the atomic connections inside molecules. His croquet ball colour choices of black for carbon, white for hydrogen, and red for oxygen remain in wide use today.</p>

<p><img src="/images/hofmann_ball-and-stick.jpg" alt="Hofmann's ball-and-stick models of chloromethane, methanol, and methanamine using coloured croquet balls." style="display:block; margin-left:auto; margin-right:auto" /></p>

<p class="figcaption">August Wilhelm Hofmann, â€œOn the combining power of atomsâ€, <em>Proceedings of the Royal Institution of Great Britain</em>, <strong>1865</strong>, 4, 401â€“430</p>

<p>Despite Hofmannâ€™s lab being in Imperial College London (he moved to the University of Berlin in 1865), and Perkin being the first to commercialise aniline dyes in Britain, this nascent dye and chemical industry was to come to be dominated by Germany, largely due to economic and technological factors. A key factor was the industrial production of synthetic liquid and gaseous fuels from coal tar, <a href="https://doi.org/10.1016/S0167-2991(07)80469-1">invented in Germany in 1920s</a>. As Germany had vast coal deposits and almost no natural petroleum reserves, this Fischer-Tropsch synthesis of fuel from coal tar was crucial for the energy, transport, and military viability of Germany. By making huge quantities of syngas from coal tar deposits and building industrial chemical plants, the feedstocks and techniques for dye creation were linked to plentiful industrial production in the Rhineland.</p>

<p>The economic advantage from industrial scale organic synthesis far outgrew the impact of only dyestuffs. A letter to <em>Nature</em> in 1934 <a href="https://doi.org/10.1038/133576a0">puts it plainly</a>:</p>
<blockquote>
  <p>â€œWHILST the original discovery of a coal-tar dye was made by an Englishmanâ€¦ The consequent decline of the British coal-tar colour industry was already well marked in 1875, and in 1886 had proceeded so far that 90 per cent of the dyes then used in Britain were of foreign manufactureâ€¦ It is not an overstatement to say that the development of this highly scientific and extremely profitable industry in Germany instead of in Great Britain had enormous, if not decisive, political and economic effects both before and during the War.â€</p>
</blockquote>

<p>Enclosed with this submission to <em>Nature</em> is an additional letter where John Brunner (co-founder of a chemical firm that would later merge to become Imperial Chemical Industries) opines in 1915 that, if he and his chemist brother had money in their â€˜teensâ€™, their fascination with aniline dyed silk skeins would have driven them to keep the coal tar chemical industry in Britain.</p>

<h3 id="coal-tarred-and-feathered-">Coal tarred and feathered ğŸª¨</h3>
<p>The importance of the profits from dyes in the founding of chemical companies can be seen in the names of industrial giants which are still around today, for example: BASF - <em>Badische Anilin- und Sodafabrik</em> (Baden <strong>Aniline</strong> and Sodium Carbonate Factory). BASF remains the largest producer of chemicals in the world: a multinational across 80+ countries with an annual revenue around â‚¬70 billion. Its history has touched on many chemical process famous in school curricula: BASFâ€™s main trade was in dyestuffs until the 1900s;  the rise of this company was meteoric after <a href="/nitrogen-fixation/2023-06-14-nitrogen-fixation/">Haber and Bosch invented their method</a> to turn nitrogen from the air into fertiliser; BASF invented polystyrene in the 1930s; and the sodafabrik part of BASF is infamous to New South Wales high school students who had to memorise the conditions of the Solvay process as part of their Industrial Chemistry module.</p>

<p>Under Nazi rule before and during WWII, BASF would be united with other industrial titans into the chemical conglomerate I.G. Farben (loosely, â€œThe Colour Cartelâ€) of notorious and horrific historical fame. This conglomerate was founded by Carl Bosch through merging BASF with Hoechst (now merged under Sanofi), Bayer (widely known for aspirin), and a few other smaller chemical companies. After WWII, IG Farben was seized by Allied forces, its forced labour abolished, and the conglomerate split up into its constituent components. In the reconstruction period, however, several of these companies such as BASF were refounded and allowed to rehire many of the same directorial staff who had served at the behest of depraved, horrific warmongers. These challenges to societal and base human conscience, the reshaping of entire industries, the discovery of new medical compounds (antifungals and antibiotics), and unfurling the spectrum of dyes for fabrics of all colours, resulted from an insight into the puzzling carbon skeleton structure of these newly synthesisable â€œaromaticâ€ substances.</p>

<h3 id="benzene-the-daydream-snake-ï¸ï¸">Benzene: The daydream snake ğŸâ™»ï¸â™¾ï¸</h3>
<p>Benzene is a molecule, whose empirical formula defied the trends determined from other hydrocarbons. It took 40 years from the experimental isolation of benzene to solve its chemical structure. It clearly had a lower H:C ratio than â€œsaturatedâ€ hydrocarbons, yet did not easily accept addition of new atoms like unsaturated hydrocarbons, and its boiling point just didnâ€™t fit with other organics that matched its mass. This puzzled chemists even after they nailed down the true atomic weights of elements and were sure of the empirical composition of molecules. Any chemistry student will tell you itâ€™s a hexagon. Benzene-as-a-hexagon is so commonplace to modern chemists that you can even buy <a href="https://geniuslabgear.com/products/organic-chemistry-stencil-pocket-chemist-wallet-ruler?srsltid=AfmBOoroqyZxeI8-zNB4pelmT3jbRLiHgHEaX-4km0TLbFYi-EVGMvmg">hexagon stencils</a> to help you breeze through your organic chemistry homework. But how was this shape arrived at?</p>

<p>The story of the solution to puzzling structure of C\(_{6}\)H\(_{6}\) is one of the few times instructors can retell a founding myth; like Romulus and Remus being raised by wolves then raising Rome, or Mendeleev playing atomic solitaire until the cards of the Periodic Table just fell into place. (Though Iâ€™m favourable to <a href="https://www.flickr.com/photos/188522613@N05/50034041757/">alternative depictions</a>, or <a href="https://www.sciencealert.com/think-periodic-tables-all-look-the-same-think-again">spiralling out</a> once in a while). Chemistry teachers get to share this dramatic origin story â€” a scientist called August KekulÃ© simply dreamed of benzene and woke up with the solution!</p>

<p>In more detail, while dozing off on the last bus home from a friendâ€™s place in London, KekulÃ© visualised chains of atoms in a whirling dance (at that time chemists were still figuring out how to apply recent studies by physicists on particle motion to their empirical chemical formulae). Suddenly, one chain of atoms seizes its own end, much <em>like</em> a snake biting its own tail. KekulÃ© awoke from his reverie and the structure of benzene was solved!</p>

<p>Did KekulÃ© truly have a sudden prophetic dream solution? Itâ€™s impossible to verify someoneâ€™s recount of their internal thinking, and some have speculated on this story being <a href="https://pubs.acs.org/doi/10.1021/ed052p709">embellished in order establish a legacy</a> due to being retold only many years later by KekulÃ© at the â€œBenzolfestâ€ in honour of his contributions to chemistry. It was unlikely a true bolt from the blue, as a more dramatic telling to first year chemistry students might go. These dreams often clarify conscious suspicions â€” organic reactions was KekulÃ©â€™s profession and solving structures a waking obsession. A defense of it truly being from a dream has been argued from studying <a href="https://www.nature.com/articles/465036a">contemporary letters</a>: in his time nobody refuted either KekulÃ©â€™s primacy claim on clearly proposing a symmetrical hexagon carbon ring, or his disposition to inspiration from visual daydreams. It certainly didnâ€™t stop Cormac McCarthy from <a href="https://nautil.us/the-kekul-problem-236574/">using the story as a launching off point</a> to argue that <a href="https://youtu.be/1eTSL2kopP4?si=FU_FkzTpyh868gaU">language is a virus</a> (I find Laurie the most persuasive here).</p>

<p>Of course, a snake grabbing its own tail is not an invention of KekulÃ©, the Ouroboros is an ancient and world-spanning icon symbolising eternity. Interestingly, the ouroboros has a direct throughline to chemical history through its use as a sygil in alchemy. It expressed the unity of all types of matter, with the ultimate project of course being the profitable demonstration of mastery over matter by gaining the ability to turn lead into gold.</p>

<p><img src="/images/ouroboros_chrysopoea_of_cleopatra.png" alt="Ouroboros of Cleopatra" style="display:block; margin-left:auto; margin-right:auto" /></p>

<p class="figcaption">The ouroboros has a long history, including a connection to alchemy where it is illustrated here in relation to <em>chrysopoeia</em> (â€œgold-makingâ€) through balancing â€œone in the everythingâ€. â€”<em>â€œChrysopoeia of Cleopatra the Alchemistâ€</em>, pseudonymous, 3rd or 4th century CE.</p>

<p>The dreamsnake again rears its head (and heads its rear) in the novel <em>Gravityâ€™s Rainbow</em>. The WWII IG Farben chemical colour cartel functions as a constant ominous industrial spectre stalking the book. It tragically mirrors how scientifically and commercially pioneering chemical companies were wrested into the control of war leaders to commit inhuman acts â€” the â€˜Themâ€™ of the military-industrial complex that haunts the bookâ€™s entire narrative. KekulÃ©â€™s serpentine solution to benzeneâ€™s structure is repurposed as a metaphor of the economic boon and destructive cycle unleashed by the WWII war economy:</p>

<blockquote>
  <p>â€œKekulÃ© dreams the Great Serpent holding its own tail in its mouth, the dreaming Serpent which surrounds the World. But the meanness, the cynicism with which this dream is to be used. The Serpent that announces, â€œThe World is a closed thing, cyclical, resonant, eternally-returning,â€ is to be delivered into a system whose only aim is to violate the Cycle. Taking and not giving back, demanding that â€œproductivityâ€ and â€œearningsâ€ keep on increasing with time, the System removing from the rest of the World these vast quantities of energy to keep its own tiny desperate fraction showing a profit: and not only most of humanityâ€”most of the World, animal, vegetable, and mineral, is laid waste in the processâ€¦</p>
</blockquote>

<blockquote>
  <p>No return, no salvation, no Cycleâ€”thatâ€™s not what They, nor Their brilliant employee KekulÃ©, have taken the Serpent to mean. No: what the Serpent means isâ€”howâ€™s thisâ€”that the six carbon atoms of benzene are in fact curled around into a closed ring, <em>just like that snake with its tail in its mouth</em>, GET IT?â€</p>
</blockquote>

<p>â€” <em>Gravityâ€™s Rainbow</em>, Thomas Pynchon, pg. 412, Penguin 2nd Ed.</p>

<p>The connection to colour and dyestuffs in the novel does not end there; the essay <a href="https://doi.org/10.16995/pn.374"><em>â€œColoring Gravityâ€™s Rainbowâ€</em></a> applies a critical lens to these chromatic and chemical connections and charts how they shift throughout the book. The protagonistâ€™s very name â€”Tyroneâ€” could interpreted to be linked with Tyrian purple, his colour depiction alters as the narrative shifts towards an annihilating white, and the obsessive subjugation of nature through nomenclature and technology is linked explicitly to the terms of the organic chemistry industry.</p>

<p>The connection between the dye industry and the ability to wage war was already well noted in the period between the world wars, as an American industrial pamphlet from the 1920s declares:</p>

<p class="note" title="Dyes and disarmament">â€œWho makes dyes today can tomorrow make high-explosivesâ€</p>
<p>â€”<a href="https://books.google.com.au/books/about/World_Disarmament_and_the_Master_Key_Ind.html?id=CXIPZy6UnVUC&amp;redir_esc=y"><em>â€œWorld Disarmament and the Master Key Industryâ€</em></a>, American Dyes Institute, <strong>1921</strong>.</p>

<h3 id="how-ring-stability-enables-destruction-and-cures-">How ring stability enables destruction and cures ğŸ’¥ğŸ’Š</h3>
<p>The lack of reactivity of benzene was puzzling to chemists ever since it was first isolated. The high C:H ratio entails locations where carbons are double-bonded to themselves, leaving an opening for positions for where atoms could be attached if the double-bond could be broken during an addition reaction. It is now clear that the carbon rings in benzene and benzenoids are unreactive because their bonding arrangements are already stable. However, that does not mean benzene derived compounds are inherently inert. Quite the opposite, the core stability in the centre of benzenoids has led to the creation of molecules that either have phenomenal longevity or massive destructive power depending on whatâ€™s attached to the ring. These aromatic molecules have become notorious globally in their own right, with entire departments required to mitigate their danger to human life.</p>

<p><img src="/images/destructive_aromatic_trio.png" alt="TNT, DDT, and the general structure of a PCB" style="display:block; margin-left:auto; margin-right:auto" /></p>

<p class="figcaption">(In)famous aromatic structures that led to: (<strong>TNT</strong>, <em>left</em>) a profitable explosive and arms company that funded the creation of the Nobel Prize, with Alfred Nobel <a href="https://kathylovesphysics.com/the-merchant-of-death/">believing in a 20th century version of mutually assured destruction</a>, earning himself a mistaken obituary claiming that he <a href="https://gallica.bnf.fr/ark:/12148/bpt6k280366k/f1.item">â€œcould hardly pass as a benefactor for humanityâ€</a>; (<strong>DDT</strong>, <em>centre</em>) the founding of the US Environmental Protection Agency under pressure from <a href="https://www.epa.gov/archive/epa/aboutepa/birth-epa.html">an exposÃ© on pesticides</a>; (<strong>PCB</strong>, <em>right</em>) industrially valuable capacitor materials, that nevertheless are <a href="https://www.unep.org/topics/pollution-and-health/persistent-organic-pollutants-pops/pcbs-forgotten-legacy">carcinogens that have persisted after their global ban by the 2001 Stockholm Convention</a>.</p>

<p>The reason for the proliferation of organics containing these aromatic rings is the central hexagon (or more rarely pentagons and other polygons) supplies a scaffold that provides <a href="https://youtu.be/thOifuHs6eY?si=-ukRqmfwSwEYzAyy">more lateral directions</a> to build out the bonds of a molecule. Small aromatics are also readily bioavailable, and hence frequently absorbed as toxins or cures (indeed many of your own key biomolecules contain aromatic rings). Ring systems are everywhere in pharmaceuticals. Small organic molecules containing ring scaffolds describes many types of drugs including: opioids, painkillers, psychotropics, antibiotics, anti-inflammatories, <em>etc</em>, <em>etc</em>.</p>

<p><img src="/images/aromatic_rings_in_drugs.png" alt="A selection of aromatic rings that frequently show up in drug molecules" style="display:block; margin-left:auto; margin-right:auto" /></p>

<p class="figcaption">An example of how often different rings occur within a 3566 compound dataset (they can occur multiple times in a structure). â€” Roughley, S.; Jordan, A., â€œ<a href="https://doi.org/10.1021/jm200187y">The Medicinal Chemistâ€™s Toolbox: An Analysis of Reactions Used in the Pursuit of Drug Candidates</a>â€, <em>Journal of Medicincal Chemistry</em>, <strong>2011</strong>, 54, 10, 3451â€“3479</p>

<h3 id="the-birth-of-resonance-and-fictitious-intermediates---">The birth of â€œresonanceâ€ and fictitious intermediates âŒ¬ â†” â£</h3>
<p>So, what did KekulÃ©â€™s benzene <em>look</em> like? While itâ€™s commonplace to call the drawing of a hexagon with static alternating single and double bond lines the â€œKekulÃ© structureâ€ to distinguish it from the â€œ<a href="https://en.wikipedia.org/wiki/Dewar_benzene">Dewar benzene</a>â€ that is bifolded by a single-bond through the middle (which <a href="https://pubs.acs.org/doi/10.1021/ja00903a056">can exist</a>, and Dewar <em>also</em> didnâ€™t back the structure that carries <em>his</em> name), these chemists were too empirically-minded to be drawn on a fixed depiction. What is clear instead from the drawings in KekulÃ©â€™s papers is an unsatisfied valence in a C\(_{6}\)H\(_{6}\) chain which is only satisfied when the chain is closed by attaching back to its beginning.</p>

<p><img src="/images/kekule_benze_chains.jpg" alt="KekulÃ©'s benzene schematic" style="display:block; margin-left:auto; margin-right:auto" /></p>

<p class="figcaption">KekulÃ©â€™s schematic of benzene illustrates a sense of overlap, but doesnâ€™t accord with current ways of representing organic molecules. â€”<a href="https://lib.ugent.be/catalog/rug01:001282677">â€œSur la constitution des substances aromatiquesâ€</a>, KekulÃ©, M., <em>Bulletin mensuel de la SociÃ©tÃ© Chimique de Paris</em>, <strong>1865</strong>, 98â€“111.</p>

<p>The oblongs were not meant to show that the molecule literally lay in a straight line, but what the sausage atoms (literally <em>wurst</em> in his articles) were meant to represent was contemporary chemical thought which held the valency property of an element was due to multiple subparts each capable of forming a connection. This is clearer in <a href="/images/kekule_sausage_formulas.jpg">other diagrams</a> where these particles of â€˜atomicityâ€™ are drawn like theyâ€™re wrapped in a sock to form the overall element.</p>

<p>While purely a trick to be able to depict the multibond connections available to these elongated multivalent elements, the dimensional limitation of these sketches seems to have led KekulÃ© to some mistaken structural assignments, such as initially assigning a triangular form of benzene to achieve chain closure. However, other organic chemists immediately picked up on this based on experimental evidence of 6-fold positional symmetry (additions to the benzene ring creating isomer patterns that are unique to a regular hexagon). Regardless, KekulÃ© derived the need for complete symmetry in the ring from carbonâ€™s tetrahedral tetravalent bonding. His supposition was not of alternate structures in equilibrium, but that relationship of each carbon to its ring neighbour was held together in equal spacing, mediated by  oscillating collisions with two neighbouring carbons and one hydrogen. KekulÃ©â€™s daydreamed timescale was likely intramolecular vibrational, not reactive, nor electronic (since the electron was only discovered the year after he died).</p>

<p>The importance of the number of carbon atoms (often six) was recognised by early chemists as well. Armit and Robison popularised the term â€œ<a href="https://doi.org/10.1039/CT9252701604">aromatic sextet</a>â€ through many persuasive molecular examples that differed greatly from benzene but still maintain rings of six delocalised electrons. However it was Ernest Crocker, a scientist who never pursued the â€œDoctorâ€ title, who <a href="https://doi.org/10.1021/ja01429a002">got there first</a>. He did this by applying the valence electron â€œoctect ruleâ€ to all atoms in benzene with Lewis-Langmuir bonding and accounting for the aromatic stability from the remaining six electrons. He places the electrons clearly â€œoutsideâ€ the ring due to charge considerations, but states that: <em>â€œelectrons are continually vibrating in the plane of the ringâ€¦ The net physical effectâ€¦ serving to bind together all carbon atoms present into virtually a single atom.â€</em></p>

<p>These days, it is common to introduce students to benzeneâ€™s cycle through a smearing of two â€œresonanceâ€ structures. We come to a resonance structure due to a dogged adherence to Lewis bonding and â€œformal chargesâ€ as a pedagogical accounting tool for building up (<em>â€œaufbauâ€</em>) bonding lines from atoms. Two valid Lewis structures, with alternating double bonds, are drawn with â€œresonance equilibrium arrowâ€ between them (though the reality being â€œ1.5â€ bonds is generally acknowledged). So, how did we arrive at two so-called â€œâ€œKekulÃ©â€â€ structures of benzene if the early pioneers and experimental evidence evinced a complete symmetry in the nature of benzene?
<img src="/images/benzene_resonance_structures.png" alt="Benzene resonance structures" style="display:block; margin-left:auto; margin-right:auto" /></p>

<p class="figcaption">The two â€œresonance contributorsâ€ of benzene, where the single and double bonds are shown to alternate in viable positions.</p>

<p>Likely the instructional ease of drawing Lewis bonding structures helped the misnomer â€œresonanceâ€ stick. Iâ€™ve labelled it a misnomer as there is not a â€œresonationâ€ allowing for two nuclear or bonding position extrema to interconvert in equilibrium; benzene in an unaltered state is a purely symmetrical (\(D_{6h}\)) flat hexagon. What the resonance concept does is bring the concept of energetic degeneracy (<em>i.e.</em> multiple quantum states that have identical value upon measuring a specific observable) into the chemical drawing system learned by practicing chemists. The adoption of this useful fiction was turbocharged by populariser extraordinaire: Linus Pauling.</p>

<p>Linus Pauling <a href="https://www.jstor.org/stable/4027968">ran an exposition campaign to bring the insights of the new quantum mechanical theories of bonding to chemistry departments</a>. While Paulingâ€™s explanations focused on chemical conceptual accessibility rather than the rigours of strict physical chemistry research, this approach was widely popular. It was couched in a visual process that unlocked the conceptual basis of structural chemistry in a way that could be latched on to by scientists designing organic synthesis reactions. While Pauling may be responsible for popularising electron delocalisation concepts in language and rules palatable to the synthetic chemists of his day, <a href="https://pubs.acs.org/doi/pdf/10.1021/ed036p336?ref=article_openPDF">Fritz Arndt may be the source</a> for the double-headed â€œresonance equilibriumâ€ arrow that can mislead some chemistry undergraduates. Arndt published papers expounding on  a â€œ<a href="https://doi.org/10.1002/cber.19300631108">Zwischenstufe</a>â€ (intermediate state) in resonance stabilised structures, though to Arndtâ€™s credit he never committed to an oscillating model, or timescale, and emphasised purely electronic bonding rearrangement in a pre-quantum mechanical explanation.  Decades later Paulingâ€™s prestige, accumulation of credits, and renowned teaching skills would <a href="https://openlibrary.org/books/OL4914696M/Vitamin_C_and_the_common_cold">generate a best seller</a>, <a href="https://www.sciencehistory.org/stories/magazine/linus-paulings-vitamin-c-crusade/">popularise a dubious concept</a>, that led to <a href="https://theweek.com/articles/454161/how-vitamin-industrial-complex-swindled-america">a lot of wasted money and time</a> despite a <a href="https://youtu.be/HKTSaezB4p8?si=sXm1DxhbSutiJDPQ">bongo accompanied ode to orange juice</a> from an equally lionised scientist going through his final days.</p>

<p>The Soviets, however, were having none of it. Resonance structures were <a href="https://www.jstor.org/stable/227752">decried as â€œanti-realistâ€</a> and antithetical to the true teaching of dialectical materialism. The fictitious mathematical idealisation of real atomic positions was viewed with suspicion, and the Soviet chemists adopted a terminological compromise, with the mathematical constructs themselves considered more palatable to a realist philosophy than these bourgeois anti-realist â€œresonance hybridâ€ notions. To object to such notions is not surprising, as they clash with the official Marxist-Leninist views of a state that held <a href="https://www.marxists.org/archive/marx/works/1877/anti-duhring/ch04.htm">Engels as an authoritative expert on geometric cosmology</a>.</p>

<blockquote>
  <p>â€œA motionless state of matter is therefore one of the most empty and nonsensical of ideas â€“ a â€œdelirious fantasyâ€ of the purest water.â€</p>
</blockquote>

<p>â€” <em>Anti-DÃ¼hring: Philosophy of Nature. Cosmogony, Physics, Chemistry</em>, Friedrich Engels, <strong>1877</strong>, Part I, Section IV.</p>

<p>Resonance joins a pantheon of scientific concepts which at one time or another were suppressed by the Bolshevik state, including: <a href="https://en.wikipedia.org/wiki/Lysenkoism">Darwinian evolution</a>; Ernst Machâ€™s philosophical moves from Netwonâ€™s clockwork universe to one that permitted relativity in motion but <a href="https://www.marxists.org/archive/ilyenkov/works/positive/positi.htm">also sensational experience</a>; <a href="https://en.wikipedia.org/wiki/Cybernetics_in_the_Soviet_Union">early cybernetic thought</a> (which appears to have been shucked down into systems theory in STEM fields, while cybernetics remains a domain of HASS departments); <a href="https://nah.sen.es/index.php/en/issues/past-issues/volume-10/issue-2/stalin-s-interventionism-in-soviet-physiology-the-pavlovian-session">non-Pavolvian physiology</a>; and interpretations of <a href="https://aeon.co/essays/how-soviet-communist-philosophy-shaped-postwar-quantum-theory">wave-particle duality</a>.</p>

<p>It should be conceded that, while formally fictitious, the concept of resonance hybridised orbitals played an outstanding explanatory role in revealing bonding behaviour in typical aromatic organic molecules.  It has been argued they can still be considered <em>a</em> â€œcorrectâ€ representation of aromatic molecules (particularly of charged delocalised tautomers) since <a href="https://doi.org/10.3390/molecules26144110">dominant resonance contributor representations can be constructed from wavefunction-based molecular orbitals</a> by applying natural bonding orbital analysis.</p>

<h3 id="the-electronics-of-dyes-ï¸">The electronics of dyes âš›ï¸</h3>
<p>Planar, hexagonal benzene geometry was key to advancing the quantum mechanical explanation of its bonding pattern. The six â€œremainderâ€ electrons after accounting for co-valent bonding do not lie â€œoutsideâ€ the carbons. Instead, contrary to the Crocker proposal, the electrons â€˜circulateâ€™ both above <em>and</em> below the ring at once. In fact, in the plane of the ring is the one area the â€œremainderâ€ carbon electron orbitals <em>cannot</em> be due to a node of density absence caused by the angular momentum of the orbitals. Angular momentum is one of the few properties that an electron can have, being particles otherwise indistinguishable from one another. These remainder electron orbitals are commonly described as <em>hybridised</em> â€” another concept <a href="https://doi.org/10.1016/S1355-2198(00)00027-7">Pauling intuited and popularised from the mathematical constructs created by the likes of Slater</a>. The outer orbitals of carbon each have a one angular momentum â€œsliceâ€ through them, making it a \(p\)-orbital (from now-nonsensical <a href="https://homepages.uc.edu/~jensenwb/reprints/137.%20s,%20p,%20d,%20f.pdf">vestigial spectroscopic notation</a>). In the hybridised view, all 4 carbon valence electron arrange into the <a href="https://youtu.be/SJdllffWUqg?si=OdNZ1yJLusEdHOxi">tetrahedrally splayed \(sp^{3}\) hybrid orbitals</a> to join with 4 neighbours. The cyclic chains in aromatic systems instead permit for 3 \(sp^{2}\) hybridised carbon covalent bonding orbitals, with the â€œremainderâ€ \(p\)-orbitals supplying â€˜freeâ€™ electron density whose adjacent densities can join in what is called a \(\pi\)-bond. Because electrons <em>do</em> display wave-particle duality, these â€˜waviclesâ€™ can add their amplitudes because their density wavefunctions are <em>in phase</em>. \(\pi\)-bonds provide typical double bonds, but what makes aromatic bonding special is continuous, cyclical, \(\pi\)-bonds tracing a ring an electron can flow around.</p>

<p><img src="/images/p_to_pi_cloud_aromatic.png" alt="p -&gt; Ï€ electron delocalisation" /></p>

<p class="figcaption">Chemical aromaticity arises due to a planar cyclic \(p\)-orbital system that can delocalise to form a Ï€-electron system around a closed ring. â€”<em>LibreTexts Chemistry</em> <a href="https://chem.libretexts.org/Bookshelves/Organic_Chemistry/Map%3A_Organic_Chemistry_%28Smith%29/15%3A_Benzene_and_Aromatic_Compounds/15.09%3A_What_Is_the_Basis_of_Huckels_Rule"><em>15.9: â€œWhat Is the Basis of HÃ¼ckelâ€™s Rule?â€</em></a>, Tim Soderberg (University of Minnestota, Morris)</p>

<p>HÃ¼ckel solved the quantum mechanical bonding rules of benzene, even as â€œresonanceâ€ was being bandied around, using two constants: \(\alpha\) â€“ the energy of a \(p\)-orbital, and \(\beta\) â€“ the stabilisation gained by allowing adjacent \(p\)-orbitals to delocalise into a \(\pi\)-orbital. This is because electron position and momentum observables follow the Uncertainty Principle; they multiply together to some (Planck) constant. A highly constrained electron has very low position uncertainty, meaning broad uncertainty in its momentum, allowing a high kinetic energy value. Conversely, the delocalisation stabilisation energy \(\beta\) occurs because the electron density is spread over a large position space in an extended \(\pi\)-orbital, <a href="/guide/2023-04-12-compchem-methods-basics/">lowering the kinetic energy of the system (\(\nabla^{2}\))</a>.</p>

<p>It turns out six isnâ€™t the sole magic number allowing an â€œaromaticâ€ ring of delocalised electrons, nor must every atom strictly be carbon (if \(p\)-orbitals are still available after covalent hybridisation). So â€œaromaticâ€ rings can be created whenever \(\pi\)-orbital electrons can loop back on themselves. This leads to the common rule-of-thumb in chemistry.</p>

<p class="note" title="HÃ¼ckel's rule">Delocalised â€œaromaticâ€ systems arise in cyclic arrangements of atoms, where \(4n+2\) \(p\)-electrons are â€œsharedâ€ between all atoms in the ring; \(n=1,2,3...\)</p>

<p>In fact the overlapping orbitals can be obtained from unusual geometric configurations, even highly exotic twists like <a href="https://commons.wikimedia.org/wiki/File:Mobius_v_huckel_aromatic.png">MÃ¶bius aromaticity</a>. More commonly, several smaller rings are joined together to make one large delocalised electron system. A famous such aromatic scaffold is the porphyrins: four pentagonal nitrogen-containing heterocycles in conjugated linkage, and so named because of their red-purple hues. Research into the physical basis of â€œaromaticityâ€ is still a hot field in chemistry, just this year scientists made a massive <a href="https://pubs.acs.org/doi/10.1021/jacs.5c09149">18-porphyrin ring</a> that displays <a href="https://phys.org/news/2025-09-member-nanoring-boundaries-global-aromaticity.html">current across 242 electrons running through the entire system</a>.</p>

<p>Understanding the electronic basis of benzeneâ€™s bonding explained its unreactivity through aromatic stabilisation. But it also explained something more visible: colour.</p>

<h3 id="tuning-the-resonant-hue-">Tuning the resonant hue ğŸ¨</h3>
<p>The origin of the colour of aromatic dyes can be studied when two aromatic rings are strung together with a conjugated carbon chain. This chain provides the length along which the electron wavefunction can form standing waves. This behaviour is effectively a complicated particle-in-a-box constraint. Consequently, lengthening the conjugated chain lowers the frequency of the electronic wavefunction. But for colour what matters is how this electron wavicle interacts with <em>light</em>. A photon can excite the electronic wavefunction from the highest lying resting state, to next available (â€˜virtualâ€™) standing wave, provided the energies match. In the process the photon is absorbed, leading to the observation of colour due to a spectral gap in the white light reflected from an object. Longer chains will have a smaller occupied-virtual gap, shifting the absorption to redder light and making the dye appear the complementary colour (bluer). Thus, for calculating the colour of dyes, what matters is the <em>gap</em> between the highest occupied electronic state and the next available lowest energy â€˜virtualâ€™ state â€” the excitation energy.</p>

<p>Seth Olsen (<a href="https://condensedconcepts.blogspot.com/2018/02/seth-olsen-1975-2018-theoretical-chemist.html">vale</a>) was an Australian theoretical chemist, and like many physical chemists the excitation energies of dyes fell inside his many interests. Relevant here is his work using modern computational modelling with molecular orbital theory to provide predictive explanation of Leslie Brookerâ€™s rules of resonant dye colour absorption <a href="https://doi.org/10.1103/RevModPhys.14.275">discovered in the 1940s</a>. Brooker studied dyes with two aromatic ring systems linked by a simple conjugated carbon chain of different lengths. In the process, Brooker discovered a relationship when he contrasted dyes that were symmetrical (both ends the same), versus asymmetrical dyes. The relationship was this:</p>

<p class="note" title="Brooker's Deviation Rule">Dyes with asymmetric ends absorb at a photon wavelength at the mean value of the two symmetric parents, but deviating by a blueshift. This deviation is related to the different abilities of the end rings to pull electrons from the central chain (their â€œbasicityâ€). The larger the difference in basicities, the greater the blueshift deviation from the simple average.</p>

<p><img src="/images/brooker_deviation.jpg" alt="Brooker's deviation" style="display:block; margin-left:auto; margin-right:auto" /></p>

<p class="figcaption">The asymmetrical dye deviates from its â€œresonantâ€ isoexcitation point â€” the average of the two symmetric parents. This deviation is directly linked to the electron attractive nature of the end ring systems. â€” Olsen, S.; McKenzie, R., â€œ<a href="https://doi.org/10.1063/1.3563801">Bond alternation, polarizability, and resonance detuning in methine dyes</a>â€, <em>The Journal of Chemical Physics</em>, <strong>2011</strong>, 134, 114520</p>

<p>Brookerâ€™s Deviation Rule was worked out experimentally within Kodak labs, decades before computational chemistry methods could be used to find explanations. Seth Olsen and Ross McKenzie showed this empirical deviation rule can be explained by molecular orbital theory, though the <a href="/guide/2023-04-12-picking-an-active-space/">orbital active spaces</a> involved <a href="https://pubs.acs.org/doi/full/10.1021/ct100001b">go well beyond</a> the simple HÃ¼ckel picture given here, even for <a href="https://pubs.acs.org/doi/abs/10.1021/jp309006e">classic green and blue dyes</a>. One key result is that the one-electron Brooker basicities can be treated as a constant for each aromatic ring end, <em>regardless of what other ring it is conjugated to</em>, because the localised frontier orbitals remain unchanged. This greatly simplifies the prediction of the excitation energy, meaning the colour of any such dye can be predicted if the constants of each ring system is known â€” without the need to actually construct them and measure physical values.</p>

<p>By providing a representationally simple two-state model of dyes, these studies yield interesting results for the oxonol dye chromophore housed inside Green Fluorescent Protein (GFP), the most widely used <a href="/photobiology/2023-04-15-photobiology/">bioluminescent</a> probe in molecular biology experiments. These include that the prevalent form of the dye is the anionic one (since the resonant colour is more easily tuned to fit evolutionary pressures), and the existence of an unobserved <a href="https://doi.org/10.1016/j.cplett.2010.04.024">â€˜darkâ€™ state in GFP absorption</a>.</p>

<p>The molecular orbital picture of dyes can get stranger still. Take azulene, a vivid dark blue isomer of naphthalene. While azulene has been isolated as a dye for hundreds of years by steaming chamomille, <a href="https://doi.org/10.1021/jacs.3c07625">research in 2023</a> reveals that the moleculeâ€™s excited state has unique anti-aromatic ring currents which makes it disobey a long standing principle in photochemistry â€” azuleneâ€™s photon emission is not from its lowest lying excited state (Kashaâ€™s rule) but from the 2nd excited state. More widespread but no less entrancing is the class of compounds that are a byword purple itself: the <em>porphyr</em>ins. They often function as the molecular holster for a metal atom: the combinations of the transition metal \(d\)-orbitals with the delocalised orbitals extended over the aromatic ring system have beautiful molecular orbital representations, as illustrated below with an iron atom.</p>

<p><img src="/images/Fe-porphyrin_CAS-14-14.png" alt="CAS(14e,14o) orbitals of an iron-porphyrin complex" class="lead" width="520" height="856" loading="lazy" /></p>

<p class="figcaption">Ten active orbitals in the electronic structure of an iron-porphyrin complex typical of <a href="https://www.nobelprize.org/prizes/chemistry/1962/perspectives/">haem proteins</a>. Calculated at the CAS(14e,14o) level of theory with \(A_1\) symmetry. â€”<a href="https://doi.org/10.1007/s00894-017-3226-y">â€œMethodological CASPT2 study of the valence excited states of an iron-porphyrin complexâ€</a>, <em>Journal of Molecular Modelling</em>, <strong>2017</strong>, 23, 53.</p>

<h4 id="porphyrins-everywhere">Porphyrins everywhere!</h4>
<p>The porphyrin with greatest recognition is chlorophyll: a modified porphyrin ring holds the central magnesium atom and a poly-terpene hydrocarbon chain extends off as a tail. Chlorophyll is of course the key photon antenna for photosynthesis, and the ultimate input channel of energy into all biological ecosystems, captured from radiation cast off during nuclear fusion. The high school formula 6CO\(_{2}\) + 6H\(_{2}\)O + light \(\rightarrow\) C\(_{6}\)H\(_{12}\)O\(_{6}\) + 6O\(_{2}\) completely hides the spooky resonant action-at-a-distance of absorbing stray photons, channeling their energy to a photosynthetic reaction system, and charging electrons to then drive formation of carbohydrates. Words fail me and Iâ€™ll let Drew Berryâ€™s <a href="https://youtu.be/jlO8NiPbgrk?si=qAVHE1R_WHU4dvS1">gobsmacking animation of the photosynthesis process</a> for the Walter &amp; Eliza Hall Institute of Medical Research speak for itself.</p>

<p>We started this colour journey with the abundant green from the chlorophyll of plants, but porphyrins are responsible for far greater share of the rainbow displayed by living organisms. Natural colours from porphyrins include:</p>

<p>ğŸŒˆ Bilins, which are â€œunwrappedâ€ porphyrins. They display <a href="https://www.nature.com/articles/nature08811">interesting light harvesting properties</a>, <em>e.g.</em> in pychobilin (algae). Their colour spans the rainbow range upon chemical degradation. <br />
ğŸ”´ Haem (as in haemoglobin) the source of unmistakable red of oxygenated blood, which is broken down within 3-4 months by your liver to produceâ€¦ <br />
ğŸŸ¢ Bile, a disconcerting colour to ever see. <br /> 
ğŸŸ¡ Urine, and <a href="https://www.compoundchem.com/2017/01/12/bodily-fluids/">other bodily fluids</a>. Unless you are unlucky enough to be suffering fromâ€¦ <br />
ğŸŸ£ <a href="https://en.wikipedia.org/wiki/Porphyria">Porphyria disease</a> where badly formed enzymes causes porphyrin build-up, turning your urine purple. <br />
ğŸŸ¤ The <a href="https://www.compoundchem.com/2016/03/26/eggs/">brown of egg shells</a>, unless transformed intoâ€¦ <br />
ğŸ”µ The blue of a robinâ€™s egg from oocyanin. <br />
âš« The petrochemical darkness of crude oil and shale, which are <a href="https://pubs.acs.org/doi/10.1021/acs.energyfuels.1c02002">full of geoporphyrins</a>, some of the <a href="https://doi.org/10.1016/j.orggeochem.2005.09.001">first clues that petrol has biological origin</a>. <br />
ğŸŒŸ The â€˜glow-in-the-darkâ€™ of the <a href="https://en.wikipedia.org/wiki/Motyxia#/media/File:Motyxia_sequoiae_(Loomis_&amp;_Davenport,_1951).jpg">Sierra luminous (<em>Motyxia</em>) millipede</a> comes from <a href="https://www.sciencedirect.com/science/article/pii/0305049184903675?via%3Dihub">a porphyrin containing photoprotein</a> whose structure is unresolved (a candidate for AlphaFold prediction?).</p>

<h3 id="retinal-in-microbes--and-in-our-eye-ï¸">Retinal: in microbes ğŸ¦  and in our eye ğŸ‘ï¸</h3>
<p>Life has an even more ancient connection to purple, harking back to rise of the microbes. Bacteriorhodopsin occurs in the â€œpurple membraneâ€ of phototrophic archaea. Similar rhodopsins are found across diverse microbes, including proteobacteria, enabling a protean metabolism â€” traditional chemical food can be supplemented with a light-driven energy source. The bacteriorhodopsin purple protein operates as a light driven proton pump as animated in <a href="https://youtu.be/w241TNxqa6I?si=CXurpxOgOoDX-key">this video</a> where the absorption of a photon triggers proton transfers and subsequent isomerisation, causing the protein to change shape.</p>

<p>The structure of bacteriorhodopsin was <a href="https://doi.org/10.1016/S0022-2836(05)80271-2">solved to atomic resolution using cryogenic electron microscopy</a> by Richard Henderson and co-workers in 1990, who would later go on to win a <a href="https://www.nobelprize.org/prizes/chemistry/2017/popular-information">Nobel prize</a> in part due to that work. This partnership of a photosensitive retinal contained inside a rhodopsin protein is found across all domains of light sensing organisms, including the structures solved this year for the Asgard archaea domain of life.</p>

<p><img src="/images/heimdallR1_retinal.png" alt="HemdallR1 archaeal rhodopsin" class="lead" width="504" height="753" loading="lazy" /></p>

<p class="figcaption">Structures of HeimdallR1 rhodopsin with the retinal chromophore, energy minimised using a QM/MM method. â€”<a href="https://doi.org/10.1038/s41564-025-02016-5">â€œStructural insights into light harvesting by antenna-containing rhodopsins in marine Asgard archaeaâ€</a>, <em>Nature Microbiology</em>, <strong>2025</strong>, 10, 1484â€“-1500.</p>

<p>The purple membrane shares a remarkable similarity with vision â€” not through direct ancestry but through convergent evolution. Microbial proton-pumps (Type I) and visual opsins (Type II) both <a href="https://evolutionarynovelty.blogspot.com/2008/12/opsins-amazing-evolutionary-convergence.html">adapted to use retinal</a> as the light harvester to conduct their work. Type II opsin molecules are directly <a href="https://doi.org/10.1098/rstb.2009.0051">evolutionarily related to each other</a>, while Type I pumps show <a href="https://doi.org/10.1038/s42003-021-02326-4">strong structural conservation</a>, indicative of shared ancestry even without much sequence similarity. Amazingly, both use variants of the same photochemistry shown above: rotation around the double-bonds upon light absorption.</p>

<p>Which brings us full circle. Purple gave nature rhodopsin, allowing microbes to feed off light. Evolution rediscovered this molecular trick for the opsins that now mediate our vision, (watch â€œ<a href="https://youtu.be/NjrFe7JHY1o?si=e89wfi5EBwqwzfvc">Phototransduction: How we see photons</a>â€ for the best explanation Iâ€™ve seen), while our cones allow us to gaze on purple in all its power and write a post of purple prose about it.</p>

<hr />

<p class="lead">Purple is my favourite colour :)</p>

<p><em><a href="/images/deep-purple-shades-of-deep-purple-cover-art.jpg">Deep Purple</a> is shrouded in mystique, while thereâ€™s something spectrally special about <a href="https://4ad.com/releases/922">High Violet</a> hinting at energies just beyond human perception, pushing into the <a href="https://kellymoran.warp.net/release/426380-kelly-moran-ultraviolet">Ultraviolet</a>.</em></p>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="dyes" /><category term="purple" /><category term="coal-tar" /><category term="aniline" /><category term="chemistry" /><category term="dyes" /><category term="BASF" /><category term="KekulÃ©" /><category term="dream" /><category term="Perkins" /><category term="quinine" /><category term="Pauling" /><category term="aromaticity" /><category term="resonance" /><category term="benzene" /><category term="Thomas" /><category term="Pynchon" /><category term="porphyrins" /><category term="orobouros" /><category term="Gravitys" /><category term="Rainbow" /><summary type="html"><![CDATA[ğŸ“– 40 min read â€¢ Aniline and the birth of the German chemical industry]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/images/Peacock_coal_11.jpg" /><media:content medium="image" url="http://localhost:4000/images/Peacock_coal_11.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Nitrogen fixation: artificial lightning, bird poop, and how kudzu grew out of control</title><link href="http://localhost:4000/nitrogen-fixation/2023-06-14-nitrogen-fixation/" rel="alternate" type="text/html" title="Nitrogen fixation: artificial lightning, bird poop, and how kudzu grew out of control" /><published>2023-06-14T00:00:00+10:00</published><updated>2023-06-14T00:00:00+10:00</updated><id>http://localhost:4000/nitrogen-fixation/nitrogen-fixation</id><content type="html" xml:base="http://localhost:4000/nitrogen-fixation/2023-06-14-nitrogen-fixation/"><![CDATA[<p class="figcaption"><em>Photo credit: Clinton Steeds. <a href="https://www.flickr.com/photos/cwsteeds/4688893055/">Flickr</a> [CC BY 2.0]</em></p>

<blockquote>
  <p>Content notice: this post discusses the history and chemistry that was occurring within the context of the invention of some of the worst chemical agents of World Wars I &amp; II, but doesnâ€™t go into detail. It also mentions a suicide, deaths in an industrial accident, bombing campaigns, and indefinite detention of migrants.</p>
</blockquote>

<p><em>Nitrogen fixation is a subject I was taught about ever since high school chemistry, where the <a href="https://chem.libretexts.org/Bookshelves/Physical_and_Theoretical_Chemistry_Textbook_Maps/Supplemental_Modules_(Physical_and_Theoretical_Chemistry)/Equilibria/Le_Chateliers_Principle/The_Haber_Process">Haber process</a> was <a href="https://educationstandards.nsw.edu.au/wps/portal/nesa/11-12/stage-6-learning-areas/stage-6-science/chemistry-2017/content/2267">part of the curriculum on equilibria</a>. The book that most influenced this current post is <a href="https://www.penguinrandomhouse.com/books/73464/the-alchemy-of-air-by-thomas-hager-author-of-the-demon-under-the-microscope/">The Alchemy of Air</a>, which details the life of Fritz Haber and Carl Bosch.</em></p>

<p>Carl Bosch was an industrialist unafraid to apply the highest pressures and the wildest materials in the search for a new catalyst. Bosch guided the German chemical conglomerates in 1930s that provided Germany chemical supplies (BASF and Bayer were denazified after WWII and thrive to this day). When the Nazis began to dictate to industry, Bosch was removed from his positions for speaking up against anti-Semitism. Fritz Haber was zealously loyal to imperial Germany, developing many horrific chemical warfare gases; a loyalty that horrified his pacifist wife who took her life following Haberâ€™s gas attacks on the battlefield, and ended up meaning nothing to the ascendant Nazi regime which attempted to erase his legacy because he was Jewish. Bosch and Haber were also involved in the early pushes for a synthetic dye industry â€” a subject of a <a href="/dyes/2025-11-05-aniline-and-the-german-chemical-industry/">later post</a>.</p>

<hr />

<h3 id="nn-the-strongest-bond-in-the-air">Nâ‰¡N: the strongest bond in the air</h3>
<p>Nitrogen gas (N<sub>2</sub>) is the most common molecule in the atmosphere (~80%), yet it sits there inert, each nitrogen atom strongly bound to the other.  Because each nitrogen atom requires 3 electrons, the surrounding oxygen atoms canâ€™t easily fulfil nitrogenâ€™s bonding requirements since they only have 2 unpaired electrons, so the Nâ‰¡N triple bond dominates the air. When nitrogen-oxygen bonds are made (mostly in car engines), the molecules that are formed (NO<sub>x</sub>) are at the top of the list of atmospheric pollutants.</p>

<p>Despite N<sub>2</sub> being plentiful in the atmosphere, most of the biosphere is nitrogen starved. Nitrogen, in a form that is less strongly bound than Nâ‰¡N, and hence bioaccessible, is crucial to provide organisms the feedstock for manufacturing the DNA and amino acids that build the complex machinery of cells. This is what fertilisers are for. Despite making up 4/5<sup>ths</sup> of the air, nitrogen is found in the soil at ~50-100 mg/kg, and this is because only a few bacteria and one industrial reaction generates bioaccessible nitrogen from the air (termed nitrogen fixation). The industrial reaction to break the Nâ‰¡N bond and form useful chemicals is one of the most energy-intensive reactions invented by humanity, and essential to our survival.</p>

<h3 id="nn---the-promethean-way-to-unbind-nitrogen">Nâ‰¡N + âš¡: the Promethean way to unbind nitrogen</h3>
<p>It was at the beginning of the 20th century that humanity snapped the Nâ‰¡N bond open through sheer energy, when the Norwegian hydro-electric nitrogen stock company (<em>Hydro</em>) built the Vemork power plant. Vemorkâ€™s world-leading 108 MW output was used to generate arcs of artificial lightning that split the surrounding N<sub>2</sub> and O<sub>2</sub> gases, overcoming the Nâ‰¡N triple bond strength of 942 kJ/mol (twice that of oxygen gas). The split nitrogen and oxygen gases formed NO gas, which was shepherded along to produce feedstock nitric acid. This arc lightning process was so energy intensive that it was unable to compete economically when the alternative Haber-Bosch process, which requires only pressure and heat, was brought to industrial scale.</p>

<p>Vemork began producing other chemicals, including separating heavy water, D<sub>2</sub>O, from water by electrolysis. D<sub>2</sub>O is H<sub>2</sub>O whose hydrogens are now deuterium (D) because they are â€˜heavierâ€™ by one neutron. D<sub>2</sub>O was a <a href="https://arxiv.org/pdf/physics/0206076.pdf">potential route making nuclear energy and weapons</a> if enough could be stockpiled (neutrons slow down when passing through heavy water, allowing to them to be absorbed into atoms which then become nuclearly unstable). Vemork was the only site that produced heavy water industrially, and while D<sub>2</sub>O stockpiles were exported to France from then-neutral Norway, <em>Hydro</em> management caved in and agreed to produce new heavy water after the Quisling government surrendered to the Nazis. This launched a sabotage mission by Norwegian resistance ski troops, an operation portrayed in the TV series <a href="https://www.imdb.com/title/tt3280150/">The Heavy Water War</a>.</p>

<p><em>Hydro</em> continues as Norwayâ€™s renewable energy company and one of the largest global suppliers of aluminium. Norwayâ€™s abundant hydro power is still <a href="https://www.statkraft.com/what-we-do/hydropower/">leveraged by the Norwegian state as the largest generator of renewable energy in Europe</a>.</p>

<p class="note" title="Update Note">Removed a reference to FREYR since the company abandoned plans for battery manufacturing from hydro power.</p>

<h3 id="nn--ï¸-the-brute-force-way-to-make-nh3">Nâ‰¡N + ğŸ—œï¸: the brute force way to make NH<sub>3</sub></h3>
<p>Fixation of atmospheric nitrogen through electrical arcs was not viable almost anywhere else in the world. Bioaccessible nitrogen was needed to meet the fertiliser demands of mechanised agriculture, and mined supplies of nitrates in the form of niter (a vague historical term for various mineral deposits) or guano (bird droppings, <em>detailed below</em>) were not going to be able to meet demand. Research had been underway for an alternative source of nitrogen, particularly in Germany which lacked niter deposits (a vulnerability that was exposed in WWI when the German navy was blockaded from colonies and foreign trade). Commercially viable artificial nitrogen fixation was developed by Haber, Bosch, and others at BASF in 1909â€“1910. The development of the Haber-Bosch process for nitrogen fixation was largely down to brute force searching driven by need: a wide array of catalysts were tested (originally Os, later to be replaced by affordable Fe-based surfaces), and the industrial capabilities of the Rhine were used to make the sturdiest metal walls to allow the reaction vessels to withstand the intense pressures (hundreds of times Earthâ€™s atmosphere) necessary to force nitrogen and hydrogen gases into NH<sub>3</sub> (ammonia).</p>

<p>BASF built an industrial plant at Oppau to generate Germanyâ€™s fertiliser and munitions, but the ammonium nitrate manufactured is inherently dangerous  and in peacetime between WWI &amp; WWII <a href="https://en.wikipedia.org/wiki/Oppau_explosion">more than 500 people died when ammonium nitrate plastered on the storage silo walls was detonated during the, at that time routine, use of small explosive charges</a>. Nevertheless, Oppau was built up as an industrial powerhouse until the end years of WWII when city was <a href="https://en.wikipedia.org/wiki/Ludwigshafen#World_War_I_through_World_War_II">virtually levelled in a series of continuous bombing campaigns by the Allies</a>.</p>

<p>The Haber-Bosch process is used unchanged in its fundamentals today, consumes 1â€“2% of all the worldâ€™s energy, and creates the fertilisers that provide nitrogen to crops that <a href="https://ourworldindata.org/how-many-people-does-synthetic-fertilizer-feed">sustain half the worldâ€™s population</a>.</p>

<h3 id="---white-gold-of-the-seas">ğŸ¦ + ğŸ’©: white gold of the seas</h3>
<p>Nitrogen-containing mineral deposits (historically known by the vague term â€˜niterâ€™) <a href="https://geographyfieldwork.com/Coves-del-Collbato.htm">crystalise on cave walls</a>, of which potassium nitrate (â€˜saltpeterâ€™) was extensively mined for gunpowder and fertiliser. In these caves, it wasnâ€™t only the mineral deposits that were a source of nitrates, but also the bat droppings. The volume of bat poo available pales in comparison to islands covered in bird poo, which was harvested by people of the Andes mountain region who it called guano. Since nitrates dissolve in water, dry conditions were needed for rich guano deposits, so it only piled up on certain islands. In the 19th century, Europeans used their vast shipping infrastructure to run a guano industry that fervently extracted hundreds of thousands of tonnes of the fertiliser for intensive agricultural use. This made intensive agriculture reliant on a few islands. This led to <a href="https://en.wikipedia.org/wiki/Chincha_Islands_War">war between Spain and its former colonies for the Chincha guano islands</a>.</p>

<p>Hard labour is still performed to extract guano from the droppings of 4 million birds on Peruvian islands, <a href="https://www.audubon.org/news/holy-crap-trip-worlds-largest-guano-producing-islands">where it is stacked in giant sacks among the throng of cormorants</a>. Guano was also vital to American farming; causing the to U.S. pass the Guano Islands Act, allowing any U.S. citizen who stumbles upon an uninhabited guano island to <a href="http://memory.loc.gov/cgi-bin/ampage?collId=llsl&amp;fileName=018/llsl018.db&amp;recNum=1152">seize it on behalf of federal government</a>. The U.S. acquired many islands this way (often transiently, just to extract guano), including the Midway Atoll of the Battle of Midway fame. The Guano Islands Act is still in force, for any Americans brave enough to venture in search of new islands to claim.</p>

<p>Australia has its own involvement in the administration of a guano island, Nauru, a 21 km\(^2\) country whose economy collapsed once its guano and calcium pyrophosphate deposits were depleted. The Australian government uses the now guano-free land of Nauru for an <a href="https://en.wikipedia.org/wiki/Nauru_Regional_Processing_Centre">offshore immigration processing centre</a>, representing the most extreme outcome of Australiaâ€™s <a href="https://humanrights.gov.au/our-work/asylum-seekers-and-refugees/projects/immigration-detention-and-human-rights">controversial indefinite detention laws</a>.</p>

<h3 id="nn---the-organic-way-to-fertilise-soil">Nâ‰¡N + ğŸ¦ : the organic way to fertilise soil</h3>
<p>Pre-existing nitrogen in the soil has been put there by <a href="https://www.science.org/doi/10.1126/science.1165675">nitrogen fixing bacteria roughly 2.5 billion years ago</a>, around the time the atmosphere became oxygen rich and <a href="https://www.science.org/doi/10.1126/science.355.6330.1110">well before plants learned to breathe</a>. Nitrogen fixing bacteria contain <a href="https://pdb101.rcsb.org/motm/26">nitrogenase</a>: an enzyme that funnels electrons to a molecular-scale crucible of metal clusters where the Nâ‰¡N bond is broken. While the structure of this â€˜crucibleâ€™ has been <a href="https://www.rcsb.org/structure/1n2c">determined in exquisite detail</a>, to my knowledge <em>exactly</em> where and how famously unreactive Nâ‰¡N binds inside nitrogenase is still an unsolved, subtle, complex molecular puzzle <a href="https://pubs.acs.org/doi/10.1021/acs.chemrev.9b00650">actively researched with modern techniques</a>. The efficiency of nitrogenase leaves contemporary molecular science a little embarrassed; what bacteria can do in the open air humans must still force through using electric arcs or hundreds of atmospheres of pressure.</p>

<p>Some nitrogen fixing bacteria, known as rhizobia, require a plant host (specifically legumes: beans, clover, peas, <em>etc</em>) in which rhizobia form root nodules. Rhizobia feed legumes fixed nitrogen until their host dies, at which point rhizobia infect a new legume or return to the soil, providing bioaccessible nitrogen. This is the answer to the childrenâ€™s song, <em>â€œDo you, or I, or anyone know how oats, peas, beans, and barley grow?â€</em> â€” legumes are included in the crop rotation to ensure the soil remains nitrogen-rich. Several other bacteria can fix nitrogen, including some blue-green algae which have a symbiotic relationship with many plants, including giant Rhubarb (<em>Gunnera manicata</em>); an example of which <a href="/images/giant_rhubarb.png">can be found in the Tasmanian Botanic Gardens</a>.</p>

<h3 id="---kudzu-and-the-overrun-of-the-american-south">ğŸŒ¿ + ğŸ¦ : kudzu and the overrun of the American south</h3>
<p>Kudzu is a vine native to the Asia-Pacific and is a legume with a phenomenally successful symbiotic relationship with nitrogen fixing bacteria. Kudzuâ€™s hardiness and scrabbling tendrils make access to plentiful nitrogen supply via rhizobia a dangerous combination. Kudzu took root in the U.S. after being introduced both for its fashionable purple flowers and as fast growing fodder for livestock. Kudzu is capable of growing at a rate of a foot a day, and was declared a weed as it spread over the landscape, blocking the sun and smothering all below it. Kudzuâ€™s growth has been so efficient in the American South that kudzu engulfed entire settlements, as captured in eerie quiescence of <a href="https://upload.wikimedia.org/wikipedia/en/c/c0/R.E.M._-_Murmur.jpg">R.E.Mâ€™s debut album cover</a>. Kudzuâ€™s onward march appears unstoppable, and <a href="https://thehill.com/homenews/4025176-midwest-primed-to-be-next-frontier-for-invasive-plant-kudzu/">the Midwest is set to be next</a>.</p>

<h3 id="nn-----research-to-improve-nitrogen-fixation">Nâ‰¡N + ğŸ§‘â€ğŸ”¬ + ğŸ”: research to improve nitrogen fixation</h3>
<p>As it stands, nitrogen fixation remains critical to global food supply, uses 1â€“2% of the worldâ€™s energy (concomitantly producing <a href="https://www.iea.org/reports/ammonia-technology-roadmap/executive-summary">1â€“2% of human CO<sub>2</sub> emissions</a>), and underpins a roughly $60 billion ammonia industry. A fundamental change in how the world gets its nitrogen would be transformative.</p>

<p>Some alternatives to the Haber-Bosch process could be:</p>

<ul>
  <li>
    <p>Human made, inorganic, nitrogen fixing catalysts</p>
  </li>
  <li>
    <p>â€˜Green nitrogenâ€™ through applying the Haber-Bosch process in alternative ways</p>
  </li>
  <li>
    <p>Coercing natureâ€™s pre-existing nitrogenases by using directed mutations</p>
  </li>
  <li>
    <p>Developing new artificial nitrogen fixing enzymes using synthetic biology</p>
  </li>
</ul>

<p>I have no expertise in this field, but thereâ€™s plenty of literature on such approaches for those interested.</p>

<p>For the approach of developing inorganic nitrogen fixing catalysts, a <a href="https://doi.org/10.1039/D0CS01341B">recent review</a> surveys the staggering diversity of metals (Mo, Re, V, Zr, Ti, â€¦) and structures investigated for potential catalysts, of which only Mo-based catalysts work under ambient conditions. Breakthroughs in the use of inorganic nitrogen fixing catalysts will come when there is a combination of: an inexpensive catalytic metal, <a href="https://www.nature.com/articles/nchem.690">such as Fe</a> which is the key metal inside nitrogenase; use of H<sub>2</sub>O as a hydrogen source; and function under ambient conditions. If these developments can be achieved, commercial scale nitrogen fixation might be done without huge industrial plants.</p>

<p>For <a href="https://royalsociety.org/topics-policy/projects/low-carbon-energy-programme/green-ammonia/">â€˜green ammoniaâ€™</a>, the Haber-Bosch process itself is already efficient at combining hydrogen and nitrogen gas, once reactors could contain high pressures. Renewable energy might best be directed towards powering gas compressors, and to electrolyse H<sub>2</sub>O for a source of hydrogen, since the use of fossil fuels as a hydrogen source in the Haber-Bosch process is the largest contributor to its CO<sub>2</sub> emissions. It <a href="https://doi.org/10.1039/C9EE02873K">has been estimated</a> that an electricity driven Haber-Bosch process will be cheaper and involve less energy loss than the fossil fuel based status quo.</p>

<p>It could be possible to selectively mutate sections of pre-existing nitrogenases (in a process known as â€˜directed mutagenesisâ€™) to increase the efficiency of the enzyme. I canâ€™t easily find any literature on improvements to nitrogenases through mutagenesis, which suprises me since the technique has been around for a while, so I suspect the structure of nitrogenase is so finely tuned to N<sub>2</sub> that most site mutations kill the enzymeâ€™s efficiency. Mutagenesis was, however, <a href="https://doi.org/10.1073/pnas.84.20.7066">used on nitrogenase in the 1980s</a> to show that upon replacement of crucial components (specific amino acids) nitrogenase ceases to fix nitrogen, and of the two â€˜crucibleâ€™ sections (Fe-containing and MoFe-containing) activity continues even when only the Fe-containing â€˜crucibleâ€™ is present. In fact, nitrogen fixing bacteria have a range of <a href="https://link.springer.com/protocol/10.1007/978-1-4939-8864-8_1">nitrogenases using alternative metals</a> for when Mo is not available in the environment.</p>

<p>As for <a href="https://www.pnas.org/doi/10.1073/pnas.0630028100">entirely new artificial enzymes</a>, I donâ€™t know if this has been achieved by anyone, but one approach has been to <a href="https://doi.org/10.1186/s12934-016-0442-6">combine parts of the nitrogenase system from different bacteria by exchanging gene segments</a>. I donâ€™t have enough working molecular biology knowledge to fruitfully read the nitty-gritty of these papers, but a key result is that <a href="https://www.pnas.org/doi/full/10.1073/pnas.1620058114">hooking up the electron transport infrastructure</a> from one type of bacteria to the nitrogenase of another can lead to greater efficiency. Gains can also be made by doing things like <a href="https://academic.oup.com/jxb/article/71/15/4591/5817768">turning off the regulatory networks that monitor nitrogen production in a cell</a>.</p>

<hr />

<p><em>Despite N<sub>2</sub> being abundant and simple in structure, it has underpinned entire ecosystems, determined wars, and continues to escape the complete control of chemists. It may be worth reflecting on N<sub>2</sub>, the particle you collide with the most throughout your life, the next time you eat your (likely fertiliser grown) rice, toast, or other grain in the morning.</em></p>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="nitrogen-fixation" /><category term="lightning" /><category term="Haber-Bosch" /><category term="guano" /><category term="nitrogenase" /><category term="kudzu" /><summary type="html"><![CDATA[ğŸ“– 15 min read â€¢ How breaking the Nâ‚‚ bond unleashed unstoppable growth]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/images/kudzu_bloom_clinton_steeds.jpg" /><media:content medium="image" url="http://localhost:4000/images/kudzu_bloom_clinton_steeds.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">The chemistry behind bioluminescence</title><link href="http://localhost:4000/photobiology/2023-04-15-photobiology/" rel="alternate" type="text/html" title="The chemistry behind bioluminescence" /><published>2023-04-15T00:00:00+10:00</published><updated>2023-04-15T00:00:00+10:00</updated><id>http://localhost:4000/photobiology/photobiology</id><content type="html" xml:base="http://localhost:4000/photobiology/2023-04-15-photobiology/"><![CDATA[<p class="figcaption"><em>Photo credit: Adam Foster. <a href="https://www.flickr.com/photos/fosterlightroom/50106668788/">Flickr</a> [CC BY-NC-SA 2.0]</em></p>

<p><em>This post is adapted from</em> <a href="https://github.com/keiran-rowell/Presentations/blob/main/Bioluminesce%20-%20theory%20group%20presentation.pdf">a talk</a> <em>I gave at one of the University of Sydneyâ€™s Theory Group meetings, but is ultimately a refashioned book report of</em> <a href="https://www.hup.harvard.edu/catalog.php?isbn=9780674067165">Bioluminescene by ThÃ©rÃ¨se Wilson &amp; J. Woodland Hastings</a>.</p>

<p><em>The Theory Group talks were an fascinating initiative, where other theoretical chemists were able to present on any topics in science that interested them. I hope my talk was interesting, but I donâ€™t think anything could top the talk given by some postdocs on the optimal physical chemistry for cooking pasta and making espresso.</em></p>

<hr />

<h3 id="glow-worms-fireflies-and-glowsticks">Glow worms, fireflies, and glowsticks</h3>

<p>Glow worms, beyond inspiring a <a href="https://youtu.be/WcZMzH04OwU">calming ballad by Vashti Bunyan</a>, are bewitching organisms, especially if you are lucky enough to be in the Southern Hemisphere and see them up close in the <a href="https://www.waitomo.com/">Waitomo Caves</a> or the <a href="http://www.glowwormtours.sydney/Promo.aspx">Blue Mountains</a>. Glow worms are the larvae of gnats, and glow to attract insects to their sticky thread, entrap them, and digest them. When desperate or territorial they will resort to cannibalism. The larvae metamorphose into adults that have no mouth, live for 2-6 days, mate, then die. Hardly seems worth it. Nevertheless they put on a spectacular show, and carry the MÄori name titiwai meaning â€˜lights reflected in waterâ€™.</p>

<p>The North Americans get fireflies, which are associated with a <a href="https://youtu.be/psuRGfAaju4">popular hit</a>, and encompass a far broader church of glowing beetles. Adult fireflies have mouths. Beyond that I canâ€™t comment, Iâ€™m not a biologist. But fireflies <a href="https://en.wikipedia.org/wiki/Firefly#In_culture">have captivated people throughout history</a>.</p>

<p>Below is a rough chemical overview of where the magic â€˜glowâ€™ comes from: ultimately it is the energy released upon breaking a strained O-O bond and forming two C=O bonds that affords the generation of an electronically excited molecule, which proceeds to emit light when the electrons relax to the ground state. There is some <a href="https://doi.org/10.1021/acs.chemrev.7b00649">full-on physical chemistry behind this process</a>.</p>

<p>In glowsticks a simple <a href="https://en.wikipedia.org/wiki/1,2-Dioxetane">dioxetane</a> is used, energy is released when the glowstick is cracked, and a dye is electronically excited and begins glowing. If the dioextane is used by itself, an electronically excited carbonyl is created, but triplet carbonyls are <a href="https://doi.org/10.1016/0009-2614(85)85149-6">poor photon emitters</a> â€“ so instead nature devises a concurrent charge transfer process, creating a singlet excited state and ensuring a photon is emitted from the O-O bond breakage. A chemical schematic of the process looks like <a href="/images/cyclic_peroxide_to_light.png">this</a>.</p>

<hr />

<h3 id="bioluminescence-as-oxygen-disposal">Bioluminescence as oxygen disposal</h3>

<p>Bioluminescence is found in creatures from sea to sky, but is not evenly distributed amongst organisms on the phylogenetic tree. The central argument in â€œBioluminescence: living lights, lights for livingâ€ is that bioluminescence was actually an evolutionary accident: a side reaction for disposing toxic oxygen,  back when oxygen was plentiful in Earthâ€™s atmosphere and organisms had not yet adapted the chemistry to cope. This â€œoxygen detoxificationâ€ cause for bioluminescence is a compelling argument, but I donâ€™t believe it is proven conclusively. Regardless, hereâ€™s a summary of the molecules used to create bioluminescence in different organisms.</p>

<h3 id="luciferin--luciferase--">Luciferin + luciferase = ğŸ’¡</h3>

<p>The reactions that cause bioluminescence involve: a <a href="https://en.wikipedia.org/wiki/Luciferin">luciferin</a> (â€˜light-bearerâ€™), a molecule that is electronically excited upon addition of O<sub>2</sub>; and a <a href="https://pdb101.rcsb.org/motm/78">luciferase</a>, a protein that catalyses the addition of O<sub>2</sub> to luciferin and alters the colour of the emitted photon based on the amino acids surrounding the luciferin.</p>

<p>Every class of organism seems to have independently evolved a different luciferin and luciferase, lending credence that it was an oxygen disposal mechanism. Here are the different luciferins used by different organisms.</p>

<h3 id="crustaceans">Crustaceans</h3>

<p>Crustaceans use the simplest known bioluminescence process: they release two secretions, one containing the luciferin and the other contains the luciferase. The glow begins (<em>see below</em>) when the secretions come into contact.</p>

<p><img src="/images/crustaceans_glow.png" alt="Crustacean bioluminescence" /></p>

<p class="figcaption">The bioluminescence of the <em>Vargula hilgendorfii</em> crustacean.</p>

<p>The luciferin is composed mainly of three amino acids and a central imidazopyrazinone, whose N-C=O bond is ultimately broken, releasing CO<sub>2</sub> and light.</p>

<p><img src="/images/crustaceans_luciferin.png" alt="Crustacean luciferin" /></p>

<p class="figcaption">The luciferin of the <em>Varigula hilgendorfii</em> crustacean. The imidazolepyrazinone (<em>highlighted in red</em>) reacts with oxygen, generating an excited state similar to the excited state carbonyl in dioxetanes that was outlined above.</p>

<h3 id="jellyfish">Jellyfish</h3>

<p>Sea creatures use many different luciferins, and the luciferin for the sea pansy is shown below, it is again is based on three amino acids and a central imidazolepyrazinone.</p>

<p><img src="/images/sea_pansy_luciferin.png" alt="Sea pansy luciferin" /></p>

<p class="figcaption">The luciferin of the <em>Renilla reniformis</em> sea pansy closely resembles that for <em>Varigula</em> shown above, but is surrounded with different amino acids.</p>

<p>However, the bioluminescence most well-known in the sea is that of jellyfish. Jellyfish bioluminescence is also the most widely used in the lab, supplying the ubiquitous <a href="https://en.wikipedia.org/wiki/Green_fluorescent_protein">Green Fluorescent Protein (GFP)</a>. GFP is used in countless assay and biological experiments: itâ€™s easier to image tissue if it glows.</p>

<p>In jellyfish, the luciferin is covalently bound to the luciferase, surrounded by a beta barrel structure (<em>see below</em>) which admits only water and provides control of the colour of bioluminescence.</p>

<p><img src="/images/jellyfish_GFP.png" alt="Jellyfish luciferase" /></p>

<p class="figcaption">The Green Fluorescent Protein in <em>Aequorea victoria</em>, where an enveloping beta barrel is seen around the luciferin. The amino acids in the barrel both prevent the luciferin reacting with external substances, and alter the colour of the light emitted (otherwise the luciferin would glow blue).</p>

<h3 id="algae">Algae</h3>

<p>Several algae can also bioluminesce, leading to the <a href="https://youtu.be/iD_6d2yN3g0">beautiful appearance of sea sparkles</a> in certain shorelines of the world.</p>

<p>Here, a new type of luciferin is found where a modified <a href="https://en.wikipedia.org/wiki/Porphyrin">porphyrin</a>-like molecule is used. The chemistry here is slightly different, adding oxygen to a <a href="https://en.wikipedia.org/wiki/Cyclopentanone">cyclopentanone</a> group and yielding H<sub>2</sub>O, but light is generated just the same.</p>

<p><img src="/images/algae_luciferin.png" alt="Algae luciferin" /></p>

<p class="figcaption">The luciferin of <em>Lingulodinium polyedrum</em> dinoflagellate algae species.</p>

<p>The bioluminescence of these algae only activate at night, but glow brightly (<em>see below</em>).</p>

<p><img src="/images/algae_glow.png" alt="Algae bioluminescence" /></p>

<p class="figcaption">Glowing <em>Lingulodinium polyedrum</em> dinoflagellate algae, where the light-emitting organelles (scintillons) can be clearly seen.</p>

<h3 id="fireflies">Fireflies</h3>

<p>The glow of the lantern on a fireflyâ€™s bum is a well-known sight, and looks stunning en masse.</p>

<p><img src="/images/firefly_glow.png" alt="Firefly bioluminescence" /></p>

<p class="figcaption">The impressive light organ located on abdomen of <em>Photinus pyralis</em>.</p>

<p>The chemisty of firefly luciferin is again different (<em>see below</em>).</p>

<p><img src="/images/firefly_luciferin.png" alt="Firefly luciferin" /></p>

<p class="figcaption">The chemistry of firefly luciferin is driven by ATP (the â€˜battery moleculeâ€™ of biology). Ultimately a dioxetane is again formed, and breaking the O-O bond yields an electronically excited carbonyl that emits light.</p>

<h3 id="quantum-chemical-calculations-on-firefly-luciferin">Quantum chemical calculations on firefly luciferin</h3>

<p>In the 20th century several biological and chemical experiments gave us an understanding of photobiology. In the 21st century, new methods in computational chemistry and increases in compute power allows us to look into the physical chemistry that drives the generation of an excited state luciferin through O-O bond breakage.</p>

<p>These calculations can get <em>very</em> complicated, so much so that people like <a href="https://pagespro.univ-gustave-eiffel.fr/isabelle-navizet">Isabelle Navizet</a> and <a href="https://www.katalog.uu.se/profile/?id=N10-584">Roland Lindh</a> have made careers out of this problem.</p>

<p>Some diagrams follow for the theoretical chemists amongst us.</p>

<p>For those without training: suffice to say the character of several excited states are involved, the presence of an anionic group on the luciferin is required to generate a photon-emitting singlet excited state, and curiously a <a href="https://doi.org/10.1146/annurev-physchem-032210-103522">conical intersection</a> exists along the reaction co-ordinate that ejects the CO<sub>2</sub>. The conical intersection was, at least to me, unexpected because it should <em>lower</em> the quantum yield of the luciferin since the conical intersection allows relaxation to the electronic ground state without emitting a photon. A very good review of bioluminescence using the insights gleaned from computational chemistry is provided in <a href="https://doi.org/10.1002/cphc.201100504">The Chemistry of Bioluminescence: An Analysis of Chemical Functionalities</a>.</p>

<p><img src="/images/luciferin_electron_exchange.png" alt="Luciferin electron transfer" /></p>

<p class="figcaption">Density Functional Theory calculations indicate that the luciferin is in a (Ï€,Ïƒ<sup>âˆ—</sup>) ground state, and the anionic C-O<sup>-</sup> is crucial since the extra electron undergoes an electron transfer process to the site of the broken O-O bond to generate a singlet excited state (\(S_1\)) upon ejection of the CO<sub>2</sub>.</p>

<p><img src="/images/luciferin_CAS_calculations.png" alt="Luciferin CAS calculations" /></p>

<p class="figcaption"><a href="/guide/2023-04-12-picking-an-active-space/">Multiconfigurational quantum chemistry calculations</a> show that the first singlet excited state (\(S_1\)) is a (Ï€,Ï€<sup>âˆ—</sup>) excitation, and the transition state (TS) ejecting the CO<sub>2</sub> corresponds to a very small energy gap between the \(S_1\) and \(S_0\) electronic states.</p>

<p><img src="/images/luciferin_conical_intersection.png" alt="Luciferin conical intersection" /></p>

<p class="figcaption">The transition state (TS) ejecting the CO<sub>2</sub> is generated by an <a href="https://doi.org/10.1351/pac197541040455">avoided crossing</a> between the (Ï€,Ïƒ<sup>âˆ—</sup>) ground and excited states. As the CO<sub>2</sub> separates from the luciferin, the luciferin can either proceed along the (Ï€,Ï€<sup>âˆ—</sup>) excited state surface and eventually emit a photon to relax back down to the ground state, or follow the seam of a sloped conical intersection to access a closed-shell singlet product.</p>

<h3 id="qmmm-calculations-on-luciferin">QM/MM calculations on luciferin</h3>

<p>Finally, a hybrid <a href="https://blogs.scientificamerican.com/the-curious-wavefunction/computational-chemistry-wins-2013-nobel-prize-in-chemistry/">quantum mechnical/molecular mechanical</a> (QM/MM) simulation can be used, where the luciferin is treated with a <a href="/guide/2023-04-12-compchem-methods-basics/">quantum mechanical method</a> to describe the electronic excitation, while the luciferase protein is simulated with standard classical molecular mechanics to allow its shape to move.</p>

<p>This allows a full mechanistic movie of oxygen entering the luciferase protein, binding to the luciferin, and generating an excited state. Iâ€™ve summarised the key findings of such QM/MM calculations in the image below. For those interested, it is worth reading the original paper <a href="https://doi.org/10.1021/acs.jpcb.8b00642">QM/MM Study of the Formation of the Dioxetanone Ring in Fireflies through a Superoxide Ion</a>.</p>

<p><img src="/images/luciferin_QM-MM.png" alt="Luciferin QM/MM" /></p>

<p>I first learnt about this topic when I picked up a secondhand copy of <a href="https://www.wiley.com/en-us/Computational+Methods+for+Large+Systems:+Electronic+Structure+Approaches+for+Biotechnology+and+Nanotechnology+-p-9780470487884">Computational Methods for Large Systems</a>, in which Chapter 12 details â€œModelling Photobiology Using QM and QM/MM Calculationsâ€.</p>

<hr />

<p><img src="/images/fireflies.gif" alt="Fireflies gif" /></p>

<p>Thank you for reading!</p>

<p>I think itâ€™s incredible how nature manages to generate light by combining chemicals inside the bodies of small organisms, and put on an entrancing show.</p>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="photobiology" /><category term="luciferin" /><category term="luciferase" /><category term="photobiology" /><category term="bioluminescence" /><category term="fireflies" /><category term="jellyfish" /><summary type="html"><![CDATA[ğŸ“– 10 min read â€¢ How breaking an oxygen pair bond generates light]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/images/sea_sparkles_adam_foster.jpg" /><media:content medium="image" url="http://localhost:4000/images/sea_sparkles_adam_foster.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">An Ersatz Ansatz</title><link href="http://localhost:4000/guide/2023-04-12-compchem-methods-basics/" rel="alternate" type="text/html" title="An Ersatz Ansatz" /><published>2023-04-12T00:00:00+10:00</published><updated>2023-04-12T00:00:00+10:00</updated><id>http://localhost:4000/guide/compchem-methods-basics</id><content type="html" xml:base="http://localhost:4000/guide/2023-04-12-compchem-methods-basics/"><![CDATA[<p><em>This post is adapted straight from my</em> <a href="http://handle.unsw.edu.au/1959.4/65036">PhD Thesis</a><em>, and is intended as a primer for beginner computational chemists. Thanks goes out to Dr Laura McKemmish, whose notes on compchem for undergraduates is the urtext for this guide.</em></p>

<hr />

<p>Many computational chemistry talks begin with the famous Dirac quote:</p>

<p><em>â€œThe underlying physical laws necessary for the mathematical theory of a large part of physics and the whole of chemistry are thus completely known, and the difficulty is only that the exact application of these laws leads to equations much too complicated to be soluble. It there fore becomes desirable that approximate practical methods of applying quantum mechanics should be developed, which can lead to an explanation of the main features of complex atomic systems without too much computation.â€</em> Dirac, P.A.M. <a href="http://dx.doi.org/10.1098/rspa.1929.0094">Quantum Mechanics of Many-Electron Systems</a>, <em>Proceedings of the Royal Society A</em>, <strong>1929</strong>, <em>123</em>, 714â€“733.</p>

<p>The practice of computational chemistry is then left to picking the appropriate approximate method to answer the scientific question that interests you. Below is a rough primer of the basic quantum chemistry methods.</p>

<hr />

<h2 id="electronic-structure-theory">Electronic Structure Theory</h2>

<p>All chemistry is governed by the behaviour of electrons and nuclei in molecules, which are described by the SchrÃ¶dinger equation \(\hat{H}\Psi = E\Psi\), where the molecular energy (\(E\)) is an eigenvalue found by applying a Hamiltonian operator (\(\hat{H}\)) to the wavefunction (\(\Psi\)) of the molecule. Given the correct Hamiltonian, solution of the full SchrÃ¶dinger equation in principle yields exact properties, but is in practice insoluble for molecular systems. All quantum chemistry methods therefore rely on computational techniques for solving approximations to the full SchrÃ¶dinger equation.</p>

<p>In the full SchrÃ¶dinger equation the Hamiltonian operator \(\hat{H}\) contains all potential and kinetic energy terms from all electrons and nuclei and the interactions between them. The non-relativistic Hamiltonian is commonly simplified by invoking the Born-Oppenheimer approximation: since electrons have smaller masses and faster timescales of motion compared to nuclei, the electronic wavefunction can be solved in a field of nuclei that are considered fixed. This approximation removes the nuclear kinetic energy term from the Hamiltonian and makes the nuclear-nuclear interaction term constant, resulting in the simpler electronic Hamiltonian:</p>

\[\hat{H}_{\mathrm{electronic}} = \underbrace{-\sum \frac{1}{2} \nabla^{2}_{i} -\sum_{i}^{elec.} \sum_{s}^{nuc.} \frac{Z_{s}}{\vec{r}_{is}}}_{\hat{h}_{i}} +\sum_{i\ less\ than\ j}^{elec.} \frac{1}{\vec{r}_{ij}}\]

<p>Atomic units are used here to simplify equations. The first term in \(\hat{H}_{\mathrm{electronic}}\) is the kinetic energy of the electrons, the second term the electron-nuclear attraction, and both are encompassed in the one-electron operator (\(\hat{h}_{i}\)) which is summed over all electrons in the molecule.  The third term represents the electron-electron repulsion and can not be solved exactly for multi-electron systems. Wavefunction-based quantum chemistry methods  differ in the approximations they introduce to solve the electron-electron repulsion term.</p>

<p>In order to solve the electronic SchrÃ¶dinger equation, spin orbitals  (\(\chi_{n}\)) which depend on position of one electron (\(\mathbf{x}_{n}\)) are used. Since electrons are fermions, the wavefunction must obey the Pauli principle and be antisymmetric with respect to the exchange of two electrons. This is achieved by representing the wavefunction of a many electron system (\(\Psi\)) as a Slater determinant of one-electron spin orbitals:</p>

\[\Psi_{0}(\mathbf{x}_{1},\mathbf{x}_{2},\cdots,\mathbf{x}_{n}) = \frac{1}{\sqrt{N!}}
\begin{vmatrix}
\chi_{1}(\mathbf{x}_{1}) &amp; \chi_{2}(\mathbf{x}_{1}) &amp; \chi_{3}(\mathbf{x}_{1}) &amp; \cdots &amp; \chi_{N}(\mathbf{x}_{1}) \\
\chi_{1}(\mathbf{x}_{2}) &amp; \chi_{2}(\mathbf{x}_{2}) &amp; \chi_{3}(\mathbf{x}_{2}) &amp; \cdots &amp; \chi_{N}(\mathbf{x}_{2}) \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\chi_{1}(\mathbf{x}_{N}) &amp; \chi_{2}(\mathbf{x}_{N}) &amp; \chi_{3}(\mathbf{x}_{N}) &amp; \cdots &amp; \chi_{N}(\mathbf{x}_{N}) \\
\end{vmatrix}\]

<p>Quantum chemistry is typically performed according to  molecular orbital (MO) theory, where the wavefunction can be represented as a product of MOs (\(\phi_{i}\)). These MOs are constructed from a linear combination of atomic orbitals (LCAO): \(\phi_{i} = \sum\limits_{n}C_{ni}\chi_{n}\),  where each coefficient (\(C_{ni}\)) determines the contribution of each atomic orbital to a MO. The optimal value of these \(C_{ni}\) coefficients for a set of atomic orbitals can be determined according to the variational principle, which states that energy of the approximate wavefunction will always be higher than the true wavefunction. Therefore, when using a variational method, the coefficients which yield the lowest total energy are the best estimate of energy of the true molecular wavefunction.</p>

<h3 id="hartee-fock-theory">Hartee-Fock theory</h3>
<p>The Harteeâ€“Fock (HF) method is a variational approach to solving an approximation to the electronic SchrÃ¶dinger equation. In HF theory the electron-electron repulsion term is solved iteratively, using a â€œmean-fieldâ€ of the other electrons, until electron distributions and energies converge within a self-consistent field (SCF). The HF equations are cast as an eigenvalue problem:  \(\mathbf{FC} =  \epsilon \mathbf{SC}\), where a Fock operator (\(\mathbf{F}\)) acts on a matrix of \(C_{ni}\) coefficients (\(\mathbf{C}\)) to yield a vector containing the molecular orbital energies (\(\epsilon\)). The Fock operator (\(\hat{F}_{i}\)) contains the one-electron operator (\(\hat{h}_{i}\)), and operators for the exchange (\(\hat{K}\)) and Coulomb repulsion (\(\hat{J}\)) energy between electrons:</p>

\[\hat{F}_{i} = \hat{h}_{i} + \sum_{j=i}^{N/2} (2\hat{J}-\hat{K})\]

<p>This HF solution is often used as the initial trial wavefunction for calculations that use higher accuracy quantum chemical methods.</p>

<h3 id="correlated-methods">Correlated methods</h3>

<p>Since the HF equations are solved in a â€œmean-fieldâ€ of electrons, this method lacks the dynamic electron correlation energy necessary to make quantitative predictions of molecular properties. A number of wavefunction formalisms are available to recover this correlation energy using a correction to the HF wavefunction. These post-HF methods are often referred to as â€œcorrelatedâ€ methods. The energetic predictions of post-HF methods are systematically improved as higher-order terms of electron correlation are included, but at the cost of increased scaling of computational cost with system size.</p>

<p>An alternative quantum chemical approach is to bypass the wavefunction and calculate molecular properties based solely on the electron density. These density functional theory (DFT) methods have reduced computational cost, since a \(3N\) dimensional wavefunction does not have to be computed, but are not systematically improvable since the exact form the exchange-correlation functional should take is not known.</p>

<h3 id="multiconfigurational-methods">Multiconfigurational methods</h3>

<p>Both the DFT and post-HF methods outlined below are â€œsingle-referenceâ€ methods based upon a single reference Slater determinant. In cases such as electronic degeneracies, a single Slater determinant may be qualitatively inadequate to describe the wavefunction, and single-reference DFT and wavefunction methods will fail. In such cases, multiple Slater determinants must be included through a multiconfigurational (MC) approach. The MC form of HF is known as the multiconfigurational self-consistent field (MCSCF) method, and a common variant of MCSCF is to include all Slater determinants describing  a chemically relevant <a href="/guide/2023-04-12-picking-an-active-space/">active space</a> (CASSCF).</p>

<h3 id="formalisms-for-different-spin-states">Formalisms for different spin states</h3>

<p>For closed-shell molecular spin states, where all electrons are paired, a â€œrestrictedâ€ formalism of the quantum chemical method (<em>e.g.</em> RHF) can be used, where the orbitals optimised contain both spin-up and spin-down (\(\alpha\) and \(\beta\)) electrons. Restricted formalisms are used for singlet electronic states (\(S_0, S_1, S_2\)). Photoexcitation can produce open-shell molecules containing unpaired electrons. In these cases â€œunrestrictedâ€ (<em>e.g.</em> UHF) or â€œrestricted open-shellâ€ (<em>e.g.</em> ROHF) formalisms can used. The former uses two independently optimised sets of orbitals to treat the \(\alpha\) and \(\beta\) electrons separately, while the latter uses both singly and doubly occupied orbitals. Unrestricted methods can be used for open-shell states (\(T_1, T_2, D_0\)), since unrestricted methods are computationally simpler and more amenable to post-HF correction than restricted open-shell methods. However, UHF calculations can  encounter â€œspin-contaminationâ€, where the contributions of higher state solutions contaminate the UHF wavefunction and hence the spin operator (\(\mathbf{S}^{2}\)) of the UHF wavefunction is no longer a valid spin eigenfunction. The deviation from the \(\mathbf{s(s+1)}\) expectation value should be monitored as a diagnostic in all calculations of open-shell species. Unrestricted DFT (UDFT) appears to suffer less from spin-contamination due to the use of Kohn-Sham orbitals.</p>

<h3 id="posthartee-fock-wavefunction-methods">Postâ€“Hartee-Fock wavefunction methods</h3>

<h4 id="mÃ¸ller-plesset-perturbation-mpn">MÃ¸ller-Plesset perturbation (MP<em>n</em>)</h4>

<p>A MÃ¸ller-Plesset (MP<em>n</em>) perturbative correction (\(\lambda \hat{V}\)) can be applied to the HF Hamiltonian (\(\hat{H}_{0}\)) to yield a more exact Hamiltonian (\(\hat{H}\)): \(\hat{H} = \hat{H}_{0} + \lambda \hat{V}\). Typically, the perturbation applied is a second order correction (MP2), which takes into account electron repulsion integrals (ERIs) between occupied (\(i,j,\ldots\)) and virtual (\(a,b,\ldots\)) orbitals in the Slater determinant:</p>

\[E^{\mathrm{MP2}} = \sum_{ij}^{occupied} \sum_{ab}^{virtual}  \frac{(ia|bj)(jb|ia)}{\epsilon_{a} + \epsilon_{b} - \epsilon_{i} - \epsilon{j}}\]

<p>This MP2 correction recovers \(\sim\)80â€“90% of the total dynamic electron correlation which was lacking in the HF solution, allowing better chemical predictions at the increased computational cost of evaluating ERIs.</p>

<h4 id="resolution-of-the-identity-ri">Resolution of the Identity (RI)</h4>

<p>The resolution of the identity (RI) approximation replaces computationally expensive four-centre ERIs with three-centre or two-centre integrals through the use of a larger auxiliary basis set. This leads to dramatic gains in computational efficiency with little loss in accuracy, particularly with larger basis sets containing higher angular momentum orbitals. The use of the RI approximation for correlated methods, such as RI-MP2, allows correlated calculations on far larger systems than otherwise possible. The Coulomb and exchange integrals can also be treated with a form of RI, known as RIJK. RIJK can be used for many methods, while the â€œchain-of-spheresâ€ algorithm for exchange integrals (RIJCOSX) can be used for excited state calculations.</p>

<h4 id="coupled-cluster-cc">Coupled cluster (CC)</h4>
<p>Coupled cluster (CC) theory uses a cluster operator (\(\hat{T}\)) that contains excitations that promote occupied orbitals in the Slater determinant to virtual orbitals to obtain a more exact wavefunction: |{\(\Psi_{cc}\)}\(\rangle\) = \(e^{\hat{T}}\)|{\(\Psi_{0}\)}\(\rangle\). The cluster operator can be truncated to include only double excitations (CCD), single and double excitations (CCSD), single, double and triple excitations (CCSDT), <em>etc.</em>:</p>

\[|{\Psi_{\mathrm{CC}}}\rangle = \left(1 + \hat{T}_{1} + (\hat{T}_{2} + \frac{1}{2}\hat{T}_{1}^{2}) + (\hat{T}_{3}+\hat{T}_{1}\hat{T}_{2}+\frac{1}{3!}\hat{T}_{1}^{3}) + \cdots \right)|{\Psi_{0}}\rangle\]

<p>CC calculations deliver some of the best energetic predictions of any quantum chemical method, but the inclusion of high order excitation results in large computational scaling exponents. For example, CCSD formally scales as \(\mathcal{O}(N^{6})\) with system size, while CCSDT scales as \(\mathcal{O}(N^{8})\) and is therefore impractical for modestly sized molecules (\(\sim\)6 non-hydrogen atoms). The use of CCSD with a perturbative triple excitation correction, CCSD(T), scales as \(\mathcal{O}(N^{7})\). CCSD(T) energies are often the â€œgold standardâ€ that other quantum chemical methods are benchmarked against.</p>

<h3 id="density-functional-theory-dft">Density Functional Theory (DFT)</h3>

<p>Density functional theory (DFT) calculates the total energy through the use of functionals which depend on the electron density (\(\rho\)):</p>

\[E[\rho] = T_{s}[\rho]+ E_{eN}[\rho] + J[\rho] + E_{xc}[\rho]\]

<p>The first term (\(T_{s}[\rho]\)) is the electron kinetic energy which can be calculated from a Slater determinant similarly to HF theory, though in DFT Kohn-Sham orbitals are used. The Coulombic electron-nuclear attraction (\(E_{eN}[\rho]\)) and  electron-electron repulsion (\(J[\rho]\)) terms can be calculated classically. The final term, \(E_{xc}[\rho]\), contains the electron-electron exchange-correlation functional whose exact form is not known. There are myriad DFT methods using different functional approximations for \(E_{xc}[\rho]\), however the accuracy of their approximations cannot be known <em>a priori</em>, unlike with wavefunction methods. Though some functionals are non-empirical, many DFT methods are semi-empirical as their functional forms are parameterised with reference experimental data in an attempt to improve their accuracy.</p>

<p>Functionals which incorporate more physical parameters of the electron density have accordingly higher computational costs, but tend to show increased accuracy. This provides a convenient classification of DFT methods into rungs on the conceptual â€œJacobâ€™s ladderâ€ of accuracy, which is illustrated below. The representative accuracy of each rung in Jacobâ€™s ladder is taken from the DFT review by Goerigk and Grimme, <a href="http://dx.doi.org/10.1039/c0cp02984j">A thorough benchmark of density functional methods for general main group thermochemistry, kinetics, and noncovalent interactions</a>. A popular DFT method is listed as an example for each rung.</p>

<p><img src="/images/Jacobs_ladder_Goerigk_Grimme.png?v=2" alt="Jacob's ladder" /></p>

<p class="figcaption">A schematic of the â€œrungsâ€ of accuracy in the conceptual â€œJacobâ€™s ladderâ€ organisation system of density functional methods. The qouted accuracy of each rung comes from a review by Goerigk &amp; Grimme on density functional methods. Schematic of Jacobâ€™s ladder modified from: Robert Fludd, <em>Utriusque Cosmi</em>, <strong>1671</strong>, illustrated by Johann Theodor de Bry, Oppenheim and Frankfort.</p>

<p>Local denistry approximation (LDA) functionals use only the local electron density (\(\rho\)), generalised gradient approximation (GGA) functionals incorporate the electron density gradient (\(\nabla\rho\)), and meta-GGA functionals incorporate the second derivative or kinetic energy of the electron density (\(\nabla^2\rho\)). Improved accuracy relative to pure DFT functionals can be achieved by mixing in a component of a wavefunction method. When HF exchange is incorporated into DFT it is known as a â€œhybridâ€ method, and addition of a perturbative MP2-like correction yields a â€œdouble-hybridâ€ method. The RI approximation can be used for the MP2-like correction in double-hybrid methods. DFT methods, being formulated upon local electron densities, do not properly capture dispersion interactions and so are frequently combined with empirical dispersion corrections.</p>

<h4 id="global-hybrid-functionals">Global hybrid functionals</h4>
<p>Pure DFT functionals suffer from self-interaction error (SIE), where the Coulomb repulsion of an electron with itself is non-zero due to the form of the exchange functional. The Slater determinant adopted for the HF exchange energy (\(E_{x}^{\mathrm{HF}}\)) exactly cancels SIE, and so SIE is lessened in hybrid functionals. Global hybrid (GH) functionals use a set fraction of HF exchange and have the form:</p>

\[E_{xc}^{\mathrm{GH}} = (1 - a_{x})E_{x}^{\mathrm{DFT}} + a_{x}E_{x}^{\mathrm{HF}} + E_{c}^{\mathrm{DFT}}\]

<p>As an example, in the popular B3LYP method \(E_{c}^{\mathrm{DFT}}\) is calculated with the Lee, Yang, and Par (LYP) correlation functional, \(E_{x}^{\mathrm{DFT}}\) with the Becke88 (B88) exchange functional, and the HF exchange mixing coefficient, \(a_{x}\), is 0.2 at all distances.</p>

<h4 id="double-hybrid-functionals">Double-hybrid functionals</h4>

<p>Double-hybrid density functionals (DHDFs) supplement \(E_{xc}[\rho]\) with a mixture of both non-local exchange and correlation energy from wavefunction methods, allowing them to recover more dynamic correlation and dispersion energy. DHDFs have the form:</p>

\[E_{xc}^{\mathrm{DHDF}} = (1 - a_{x})E_{x}^{\mathrm{DFT}} + a_{x}E_{x}^{\mathrm{HF}} + (1 - a_{c})E_{c}^{\mathrm{DFT}} + a_{c}E_{c}^{\mathrm{PT2}}\]

<p>One of the first DHDFs was B2-PLYP which uses the same B88 and LYP functionals as B3LYP, and wavefunction mixing coefficients \(a_{x} = 0.47\) and \(a_{c} = 0.27\). The wavefunction mixing coefficients were re-optimised for specific chemical applications for the B2\(X\)-PLYP set of DHDFs. In a <a href="https://doi.org/10.1021/jp801805p">systematic survey</a> by Karton <em>et al.</em> the â€œgeneral-purposeâ€ B2GP-PLYP functional, with \(a_{x} = 0.65\) and \(a_{c} = 0.36\), was found to be the most robust of the B2\(X\)-PLYP set methods, with maximum errors below 8 kJ/mol across all benchmark datasets surveyed.</p>

<h4 id="range-separated-functionals">Range separated functionals</h4>

<p>The use of a single \(a_{x}\) mixing coefficient in GH functionals leads to incorrect behaviour at long-range electron-electron distances, resulting in poor accuracy for charge-transfer excitations. In range separated hybrids (RSHs) \(\alpha\) and \(\beta\) parameters are introduced to the exchange functional form, to smoothly connect between GH exchange at short range and exact HF exchange at long range:</p>

\[E_{x}^{\mathrm{RSH}} = (1 - \alpha)E_{x}^{\mathrm{DFT}} + \alpha E_{x}^{\mathrm{HF}} + \beta E_{x,\mu}^{\mathrm{HF}} - \beta E_{x,\mu}^{\mathrm{DFT}}\]

<p>The value of \(\mu\) in a RSH functional determines how rapid the switch is between short range and long range exchange behaviour. For example, the CAM-B3LYP functional uses 0.19 \(E_{x}^{\mathrm{HF}}\) + 0.81 \(E_{x}^{\mathrm{B88}}\) at short-range but transitions to 0.65 \(E_{x}^{\mathrm{HF}}\) + 0.35 \(E_{x}^{\mathrm{B88}}\) at long-range.</p>

<hr />

<p><em>I can provide a post on basis sets later, but the nomenclature in the field is messy. Best to go straight to the</em> <a href="https://www.basissetexchange.org/">Basis Set Exchange</a></p>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="guide" /><category term="electronic-structure" /><category term="DFT" /><summary type="html"><![CDATA[ğŸ“– 15 min read â€¢ Computational chemistry methods for beginners]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/images/Jacobs_ladder_Goerigk_Grimme.png" /><media:content medium="image" url="http://localhost:4000/images/Jacobs_ladder_Goerigk_Grimme.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Selecting an active space</title><link href="http://localhost:4000/guide/2023-04-12-picking-an-active-space/" rel="alternate" type="text/html" title="Selecting an active space" /><published>2023-04-12T00:00:00+10:00</published><updated>2023-04-12T00:00:00+10:00</updated><id>http://localhost:4000/guide/picking-an-active-space</id><content type="html" xml:base="http://localhost:4000/guide/2023-04-12-picking-an-active-space/"><![CDATA[<p><em>This post is adapted straight from my</em> <a href="http://handle.unsw.edu.au/1959.4/65036">PhD Thesis</a>, <em>and deals with the struggle of creating a workable active space for multiconfigurational calculations.</em></p>

<hr />

<p>Multiconfigurational methods are where the training wheels come off, you can no longer use a â€œblack-boxâ€ combination of method and basis set â€“ you <strong>have</strong> to think about the chemical problem. There is therefore no right answer, but chemical intuition comes into play (what bonds break/form, which orbitals are populated?). Start with simple orbitals and build up. So, small basis sets, make sure it converges, then enlarge the basis set if needs must. Try to treat the â€œwhich orbitals?â€ and â€œhow small a basis set can I get away with?â€ problems separately. My advisor also gave me guidance that calculating the cation (thus giving you â€œpulled inâ€ orbitals) is another trick to get started.</p>

<p>The field is developing fast, to the point where there are methods to <a href="https://doi.org/10.1002/jcc.25869">automatically</a> <a href="https://doi.org/10.1021/acs.jctc.9b01297">select</a> an <a href="https://doi.org/10.1021/acs.jctc.2c01128">active</a> <a href="https://doi.org/10.1021/acs.jctc.9b00535">space</a>, but I believe â€œbespokeâ€ <a href="https://sites.lsa.umich.edu/zimmerman-lab/tutorial/electronic-structure-calculation/casscf/">active space selection</a> will still have its uses, and is an <a href="https://doi.org/10.1002/qua.23068">art as much as a science</a>.</p>

<hr />

<h2 id="complete-active-space-casscf-calculations-and-minimum-energy-conical-intersection-meci-searches">Complete Active Space (CASSCF) calculations and Minimum Energy Conical Intersection (MECI) searches</h2>

<p>In order to search for an optimised minimum energy conical intersection (MECI), a configuration where two electronic states are degenerate in energy, a multiconfigurational quantum chemistry method must be used. This involves optimising both the orbital coefficients but, unlike single-reference methods, also optimising the combinations of multiple Slater determinants. In multiconfigurational methods choice of an appropriate set of electron configurations in <a href="https://en.wikipedia.org/wiki/Configuration_state_function">configuration state functions</a> (CSFs) are crucial for a qualitatively correct description of the wavefunction.</p>

<p>While individual CSFs could be manually selected, one of the most common approaches is the complete active space (CAS) method where all possible configurations inside a selected orbital active space are treated. The self-consistent field (SCF) is used, and so the method at at this level of theory is known as CASSCF. The use of an active space removes the burden of choosing particular CSFs to include in the SCF optimisation, but requires the selection of appropriate active space orbitals which capture the chemical process of interest. Usually this includes any orbitals near the frontier orbitals, those involved in making and breaking bonds, the inclusion of correlated bonding and anti-bonding pairs, and any orbitals which are calculated to have incomplete occupation according to orbital population schemes.</p>

<h3 id="generation-of-natural-bond-orbitals">Generation of Natural Bond Orbitals</h3>
<p>Selection of orbitals to include in the active space is more easily done if natural bond orbitals (NBOs) are used since they correspond to chemical intuition and are localised to the reactive space, while canonical orbitals are often too delocalised to be interpretable.</p>

<p>Minimal basis sets are easier to converge in a CASSCF calculation than large basis sets, and also aid in interpretability. The starting point for all calculations was generation of an initial orbital population at the \(S_1\) TS configuration, using NBOs at the HF/STO-3G level of theory. An example Gaussian input file to generate these NBOs is given below. This process was also repeated if a large basis set, such as 6-31+G(d), was used.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%chk=[file_path]/save_NBOs.chk
# HF/STO-3G Pop=(Full,SaveNBOs)

Title Card Required

0 1
[Molecule input]
</code></pre></div></div>

<p>The generated NBOs can also be examined in an external program (Chemcraft in this example). The Gaussian input file below shows the extra input at the bottom required to call on the NBO program to print the calculated natural bond orbitals to file.  These will be labelled FILE.\(X\) where \(X\) is 31â€“37. Chemcraft can open up FILE.31 directly, and should recognise the FILE.\(X\) files for import. Chemcraft can then render NBOs from these files using the drop-down options: <code class="language-plaintext highlighter-rouge">Tools â†’ Orbitals â†’ Render molecular orbitals â†’ NBOs</code>. Be aware: there is a reordering from the .log file and the .chk file, so only rely on the numbering in GaussView when identifying orbital indexes.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%chk=[file_path]/print_NBOs.chk
#P HF/STO-3G Pop=(Full,NBORead,SaveNBO) gfoldprint

Title Card Required

0 1
[Molecule input]

$NBO BNDIDX PLOT $END
</code></pre></div></div>

<h3 id="selection-of-the-active-space">Selection of the active space</h3>
<p>It is useful to check both the character of these NBOs from their density distribution, as well as their occupation value according to the NBO scheme. Any molecular orbitals which have occupations that differ significantly from the 0/2 value for virtual/occupied orbitals are likely candidates for inclusion in the active space.</p>

<p>The conical intersection of interest is between the \(S_1\)/\(S_0\) states of the carbonyl. This conical intersection will be present near the vicinity of the transition state which involves a 1,5â€“H-shift from the carbonyl oxygen to the \(\gamma\)-hydrogen. Correlated pairs of bonding and anti-bonding orbitals should be included, for example if a C-H Ïƒ bonding orbital is included the corresponding C-H Ïƒâˆ— antibonding orbital should also be included. The oxygen \(n\) orbital which interacts with the \(\gamma\)-hydrogen and also changes occupation in the excited state is crucial to include in active space, as well as the C=O Ï€ bonding and antibonding orbitals.</p>

<p>Additionally, since the photoexcited C=O moiety abstracts a hydrogen atom to form a C-O-H bond, the C-O orbitals were found to be important for inclusion in the active space. This is particularly true when a STO-3G minimal basis set was used, which would deliver optimised C-O bond lengths approximately 0.3 Ã… larger than in the transition state structure. With large basis sets the C-O bond length varied little from the transition state structure and hence the inclusion of corresponding orbitals was of less importance.</p>

<p>A reasonable (8,7) active space for typical saturated carbonyls includes:</p>
<ul>
  <li>C-O Ïƒ and Ïƒâˆ— orbitals.</li>
  <li>C=O Ï€ and Ï€âˆ— orbitals.</li>
  <li>O \(n\) orbital of the lone pair.</li>
  <li>\(\gamma\)C-H Ïƒ and Ïƒâˆ— orbitals.</li>
</ul>

<p>The NBOs which correspond to this active space are shown in the example of butanal below at an isosuraface value of 0.1. While literature calculations use a (8,7) active space, a (10,8) active space that includes the alternate O \(n\) oxygen-centred NBO was used as the largest active space. The literature active space is provided in Kletskii <em>et al.</em> <a href="http://dx.doi.org/10.1016/j.comptc.2014.08.025">Competing Mechanisms of Norrish and Norrish-Like Reactions in a Wide Range of Systems â€” from Carbonyl Compounds to Nitrogen Oxide Donators</a></p>

<p><img src="/images/butanal_NBOs.png" alt="Butanal Natural Bond Orbitals" /></p>

<p class="figcaption">Natural bond orbitals for butanal, showing those typical for the active space of a CAS(8,7) calculation on a saturated carbonyl. CAS(10,8) active spaces include the other oxygen-centred NBO.</p>

<p>For unsaturated species, it was found to be beneficial to also include the Ï€ and Ï€âˆ— orbitals of the point of unsaturation. A (12,10) active space is very computationally demanding, so for unsaturated species the (10,8) active space sized is preserved by removing the C-O Ïƒ and Ïƒâˆ— NBOs, and replacing them with the Ï€ and Ï€âˆ— orbitals from the point of unsaturation, as illustrated below.</p>

<p><img src="/images/2-oxobutanal_NBOs.png" alt="2-Oxobutanal Natural Bond Orbitals" /></p>

<p class="figcaption">Natural bond orbitals for 2-oxobutanal, showing those typical for the active space of a CAS(10,8) calculation on an unsaturated carbonyl. In these carbonyls with a point of unsaturation the other Ï€ and Ï€âˆ— NBOs are included instead of the C-O Ïƒ and Ïƒâˆ— NBOs to keep the active space manageable.</p>

<p>Once identified, these orbitals of interest need to be rotated into the active space. The orbitals which are considered in the active space are those nearest the HOMO/LUMO frontier according to the (\(n\),\(m\)) active space chosen. The (\(n\),\(m\)) nomenclature means enough occupied molecular orbitals to host \(n\) electrons are treated as active. These are taken from the HOMO index and those sequentially below. The number of virtual orbitals in the active space is \(m\) less the number of active occupied orbitals, and they are indexed from the LUMO and those sequentially above it.</p>

<h3 id="performing-casscf-and-meci-calculations">Performing CASSCF and MECI calculations</h3>
<p>The easiest way to perform this active space selection with the orbitals in the correct index is to interchange orbitals read in from the NBO checkpoint file. This process is illustrated in the example Gaussian input file below â€” interchanging as an example orbitals 9 and 25, as well as 40 and 31.</p>

<p>Note: before running the input file below, copy the checkpoint file containing the saved NBOs to have same name as the checkpoint filename used here, so the CASSCF calculation can read in the correct NBOs. The molecular geometry does not need to be supplied since it is read from the checkpoint file.</p>

<p>The <code class="language-plaintext highlighter-rouge">iop(5/7=N)</code> keyword sets the amount of CASSCF convergence cycles used. While this can be increased, a slow or difficult to converge CASSCF calculation is often indicative of a poor active space. In some large molecules convergence can be slow, but if the energy is seen to be monotonically decreasing with each cycle then simply increasing the amount of available cycles may be all that is needed.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%chk=[file_path]/[molecule]_S0_8-7.chk
# CASSCF(8,7)/STO-3G iop(5/7=200) Guess=(Read,Alter) Geom=Checkpoint 


Title Card Required

0 1

9,25
40,31
</code></pre></div></div>

<p>If this CAS(\(n\),\(m\)) calculation converges on the \(S_0\) state at configuration of the \(S_1\) NTII TS geometry calculated by TD-DFT, then this  wavefunction is taken as a good initial guess for a beginning a conical intersection optimisation.</p>

<p>An example input file of running a minimum energy conical intersection (MECI) search with Gaussian is given below. Again, the checkpoint file from a previous job must be copied to this checkpoint filename specified in the current job to read the orbitals, in this case from the converged CAS \(S_0\) calculations. Note: in Gaussian 16 the state average weights must be included at the bottom of the input file, whereas Gaussian 09 does not need this extra input and defaults to the 0.5, 0.5 weighting between the upper and lower state of the same spin.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%chk=[file_path]/[molecule]_CI_search.chk
# CASSCF(8,7)/STO-3G iop(1/8=5) Guess=Read Geom=Checkpoint Opt=Conical  

Title Card Required

0 1

0.5 0.5
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">iop(1/8=N)</code> keyword sets the maximum step size during the optimisation, and  generally needs to be decreased from its default value of \(N = 30\) which corresponds to 0.3 Bohr. Since the \(S_1\) Norrish Type II TS structure is taken as being close MECI a small step size is appropriate and avoids issues where the optimiser can overshoot the MECI several times if large step sizes are used. The maximum number of convergence cycles may again need to be increased through the use of the <code class="language-plaintext highlighter-rouge">iop(5/7=N)</code> keyword, however since an already converged \(S_0\) CAS wavefunction is used as the initial guess the convergence during MECI searches tended to be well behaved, and convergence issues were often an indication that the geometry optimiser has strayed into a bad part of configuration space and a new guess geometry must be used.</p>

<p>The \(S_1\)/\(S_0\) state energy difference is reported in the log file as <code class="language-plaintext highlighter-rouge">Energy difference=     X</code> and this difference should be monitored, as well as the usual geometry convergence criteria of force and displacement values. If the energy difference, forces, or geometry begin to oscillate around a central zero value then decreasing the step size at this stage may improve the MECI search.</p>]]></content><author><name>Keiran Rowell</name><email>keiran.rowell@gmail.com</email></author><category term="guide" /><category term="active-space" /><category term="CASSCF" /><category term="multiconfigurational" /><category term="electronic-structure" /><category term="conical" /><category term="intersection" /><summary type="html"><![CDATA[ğŸ“– 10 min read â€¢ Input examples for Gaussian multiconfigurational conical intersection searches]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/images/butanal_NBOs.png" /><media:content medium="image" url="http://localhost:4000/images/butanal_NBOs.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>